!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="91ffa1ed-38d8-4295-90d7-7e99ae3ae121",e._sentryDebugIdIdentifier="sentry-dbid-91ffa1ed-38d8-4295-90d7-7e99ae3ae121")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"4f7a062e"};"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5168],{843:(e,t,n)=>{n.d(t,{JZ:()=>B,Jp:()=>m,L2:()=>V,L4:()=>F,LY:()=>P,Mg:()=>$,RG:()=>g,Ru:()=>Z,Sx:()=>G,T_:()=>Y,WM:()=>ee,_Q:()=>j,a$:()=>D,c_:()=>J,dm:()=>W,mU:()=>z,nF:()=>H,p4:()=>x,rE:()=>K,t3:()=>L,tL:()=>q,tQ:()=>v,tn:()=>er,tx:()=>y,w1:()=>X});var r=n(12694),i=n(86105),o=n(21462),s=n(23099),a=n.n(s),u=n(35992),l=n(76957),c=n(69737),d=n(60235),f=n(860),h=n(62246),p=n(49313),v=(0,l.eU)(null);function g(){return(0,p.Ou)(v)}var m=(0,l.eU)(new Map),y=(0,l.eU)([]),b=(0,l.eU)(null,function(e,t,n){t(m,function(e){return(0,u.jM)(e,function(e){var t=e.get(n.paneId),r=Date.now();if(!t)return void e.set(n.paneId,[{pane:n.pane,lastActiveAt:r}]);var i=t[t.length-1];a()(n.pane,i)?i.lastActiveAt=r:t.push({pane:n.pane,lastActiveAt:r})})}),t(v,n.paneId)}),E=(0,l.eU)(null,function(e,t,n){var r=e(v),i=e(m).get(n);i&&t(y,function(e){return(0,u.jM)(e,function(e){var t=!0,n=!1,r=void 0;try{for(var o,s=i[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var a=o.value;e.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}e.sort(function(e,t){return t.lastActiveAt-e.lastActiveAt})})}),t(m,function(e){return(0,u.jM)(e,function(e){e.delete(n)})}),r===n&&t(v,null)}),w=(0,l.eU)(null,function(e,t,n){t(m,function(e){return(0,u.jM)(e,function(e){var t=e.get(n);if(t){var r=t[t.length-1];r&&(r.lastActiveAt=Date.now())}})}),t(v,n)}),I=(0,l.eU)(null,function(e,t){t(v,null)}),x=(0,l.eU)(function(e){var t=e(m),n=[];return t.forEach(function(e,t){var r=e[e.length-1];r&&n.push([t,r.pane,r.lastActiveAt])}),n.sort(function(e,t){return e[2]-t[2]})}),_=(0,l.eU)(function(e){var t=[],n=!0,i=!1,o=void 0;try{for(var s,a=e(x)[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var u=(0,r._)(s.value,2),l=(u[0],u[1]),c=(0,h.xS)(l)?l.data.path:null;c&&t.push(c)}}catch(e){i=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return t}),S=(0,c.mg)(_,function(e){return e},a()),C=(0,l.eU)(function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var s,a=(0,i._)(e(m).values())[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var u=s.value;u.length<=1||t.push.apply(t,(0,i._)(u.slice(0,-1)))}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}var l=!0,c=!1,d=void 0;try{for(var f,h=e(y)[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){var p=f.value;t.push(p)}}catch(e){c=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(c)throw d}}return t.sort(function(e,t){return t.lastActiveAt-e.lastActiveAt}).map(function(e){return e.pane})}),k=(0,l.eU)(null,function(e,t){var n=e(y).pop();return t(y,function(e){return(0,u.jM)(e,function(e){e.pop()})}),n}),A=(0,l.eU)(function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var o,s=e(C)[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value,u=(0,h.xS)(a)?a.data.path:null;u&&t.push(u)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}),T=(0,c.mg)(A,function(e){return e},a()),U=(0,l.eU)(function(e){return(0,i._)(new Set((0,i._)(e(S)).concat((0,i._)(e(T)))))}),M=(0,c.mg)(U,function(e){return e},a()),N=(0,l.eU)(function(e){var t,n,r=e(v);if(!r)return null;var i=e(m).get(r);return i&&null!=(n=null==(t=i[i.length-1])?void 0:t.pane)?n:null}),P=(0,l.eU)(null),O=(0,l.eU)(null),R=(0,l.eU)(function(e){var t=e(N);return t&&(0,h.xS)(t)&&t.data.path||null});function D(e,t){var n=(0,p.ob)(b),r=(0,p.ob)(E);(0,o.useEffect)(function(){n({paneId:e,pane:t})},[n,e,t]),(0,o.useEffect)(function(){return function(){r(e)}},[r,e])}function q(){return(0,p.h)(x)}function L(){return(0,p.Ou)(x)}function V(){return(0,p.h)(S)}function F(){return(0,p.Ou)(S)}function Z(){return(0,p.ob)(k)}function Y(){return(0,p.ob)(w)}function H(){return(0,p.ob)(I)}function j(){return(0,p.h)(N)}function z(){return(0,p.h)(R)}function X(){return(0,p.Ou)(R)}function W(){return(0,p.AI)(R)}function B(){return(0,p.ob)(O)}function $(){return(0,p.AI)(O)}function G(){return(0,p.Ou)(M)}function K(){return(0,p.AI)(M)}function J(){var e=(0,p.AI)(S);return(0,f.A)(function(){return function(t){return new Promise(function(n,r){var i=e.subscribe(function(e){e.includes(t)||(i(),n())})})}},[e])}var Q=(0,l.eU)(function(e){return(0,d.b)(e(S))});function ee(e){var t=(0,o.useMemo)(function(){return(0,l.eU)(function(t){return e&&t(Q).get(e)||void 0})},[e]);return(0,p.h)(t)}function et(e,t){var n=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value;(0,h.xS)(a.pane)&&a.pane.data.path===t.path&&("move"===t.type?a.pane.data.path=t.to:a.pane={type:"commands",data:{autoFocus:!1}})}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}var en=(0,l.eU)(null,function(e,t,n){t(m,function(e){return(0,u.jM)(e,function(e){var t=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(t=(s=a.next()).done);t=!0){var u=(0,r._)(s.value,2)[1];et(u,n)}}catch(e){i=!0,o=e}finally{try{t||null==a.return||a.return()}finally{if(i)throw o}}})}),t(y,function(e){return(0,u.jM)(e,function(e){et(e,n)})})});function er(){return(0,p.ob)(en)}},1069:(e,t,n)=>{n.d(t,{W:()=>r,z:()=>i});var r=[{key:"read",friendlyName:"Read files",description:"Read any file in your App"},{key:"write-exec",friendlyName:"Write & Execute",description:"Write to any file in your App and execute any code"},{key:"repldb:read",friendlyName:"ReplDB Read",description:"Read any key, or list all keys under any prefix in the repldb belonging to your App"},{key:"repldb:write",friendlyName:"ReplDB Write",description:"Write or delete any key in the repldb belonging to your App"},{key:"experimental-api",friendlyName:"Experimental APIs",description:"Use experimental APIs that may be unstable, change in behavior, or be removed entirely"}],i=r.map(function(e){return e.key})},6132:(e,t,n)=>{n.d(t,{QN:()=>s,VF:()=>l,hT:()=>u,q4:()=>a});var r=n(83846),i=n(17844),o=n(22531);function s(e){if(!e.$kind)throw Error("Object has an empty or undefined $kind property");if(!Object.prototype.hasOwnProperty.call(e,e.$kind))throw Error("Object has a $kind property that does not match the object");return e[e.$kind]}function a(e){var t=s(e);if((void 0===t?"undefined":(0,o._)(t))!=="object"||null===t)throw Error("Contents is not an object");if("$kind"in t)throw Error("Contents has an unexpected $kind property");return(0,i._)({$kind:e.$kind},t)}function u(e,t){return(0,r._)({$kind:e},e,t)}function l(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!!e&&n.includes(e.$kind)}},6723:(e,t,n)=>{n.d(t,{Fz:()=>g,H4:()=>I,Mf:()=>w,Tu:()=>m,b:()=>b,gP:()=>E,gQ:()=>y});var r=n(12584),i=n(41114);function o(){var e=(0,r._)(["\n  fragment TopLevelExtensionUser on User {\n    __typename\n    id\n    username\n    displayName\n    image\n    url\n  }\n"]);return o=function(){return e},e}function s(){var e=(0,r._)(["\n  fragment TopLevelExtensionManifest on ExtensionManifest {\n    __typename\n    name\n    description\n    scopes {\n      name\n      reason\n    }\n    icon\n    tags\n    fileHandlers {\n      glob\n      handler\n      name\n      icon\n    }\n    tools {\n      handler\n      name\n      icon\n    }\n    background {\n      page\n    }\n  }\n"]);return s=function(){return e},e}function a(){var e=(0,r._)(["\n  fragment TopLevelExtension on Extension {\n    __typename\n    id\n    url\n    name\n    description\n    user {\n      id\n      ...TopLevelExtensionUser\n    }\n    manifest {\n      ... on ExtensionManifest {\n        ...TopLevelExtensionManifest\n      }\n      ... on ExtensionManifestError {\n        message\n      }\n    }\n    installCount\n    isBlessed\n    isListed\n    isFeatured\n    isDisabled\n    enableInternalApi\n  }\n  ","\n  ","\n"]);return a=function(){return e},e}function u(){var e=(0,r._)(["\n  fragment TopLevelExtensionInstallation on ExtensionInstallation {\n    __typename\n    id\n    repl {\n      id\n    }\n    user {\n      id\n    }\n    extension {\n      id\n      ...TopLevelExtension\n    }\n    installer {\n      id\n    }\n  }\n  ","\n"]);return u=function(){return e},e}function l(){var e=(0,r._)(["\n  query ExtensionSystemUserContext {\n    currentUser {\n      id\n      isAdmin: hasRole(role: ADMIN)\n      isStaff: hasRole(role: REPLIT_STAFF)\n    }\n  }\n"]);return l=function(){return e},e}function c(){var e=(0,r._)(["\n  query ExtensionInstallationById($installationId: String!) {\n    extensionInstallationById(id: $installationId) {\n      __typename\n      ... on ExtensionInstallation {\n        ...TopLevelExtensionInstallation\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n  ","\n"]);return c=function(){return e},e}function d(){var e=(0,r._)(["\n  query ExtensionInstallationsInRepl($replId: String!) {\n    extensionInstallations(replId: $replId) {\n      __typename\n      ... on ExtensionInstallationList {\n        installations {\n          ...TopLevelExtensionInstallation\n        }\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,r._)(["\n  mutation InstallExtension($extensionId: String!, $replId: String) {\n    installExtension(extensionId: $extensionId, replId: $replId) {\n      __typename\n      ... on ExtensionInstallation {\n        ...TopLevelExtensionInstallation\n        extension {\n          id\n          installation(replId: $replId) {\n            ...TopLevelExtensionInstallation\n          }\n        }\n      }\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}function h(){var e=(0,r._)(["\n  mutation UninstallExtension($installationId: String!, $replId: String) {\n    uninstallExtension(installationId: $installationId) {\n      __typename\n      ... on ExtensionInstallation {\n        ...TopLevelExtensionInstallation\n        extension {\n          id\n          installation(replId: $replId) {\n            ...TopLevelExtensionInstallation\n          }\n        }\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return h=function(){return e},e}var p=(0,i.J1)(o()),v=(0,i.J1)(s()),g=(0,i.J1)(a(),p,v),m=(0,i.J1)(u(),g),y=(0,i.J1)(l()),b=(0,i.J1)(c(),m),E=(0,i.J1)(d(),m),w=(0,i.J1)(f(),m),I=(0,i.J1)(h(),m)},7232:(e,t,n)=>{n.d(t,{B:()=>r});var r={production:"wss://production-ai-chat.replit.com/river",staging:"wss://staging-ai-chat.replit.com/river",development:"ws://127.0.0.1:8000/river"}},13927:(e,t,n)=>{n.d(t,{pI:()=>y,Yp:()=>b,WC:()=>w});var r,i=n(83846),o=n(40185),s=n.n(o),a=n(10795),u=n(25858),l=n(12584);function c(){var e=(0,l._)(["\n  query TrackAgentAnalyticsEvent($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        origin {\n          ... on Repl {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return c=function(){return e},e}var d=(0,n(41114).J1)(c()),f=n(86035),h=n(33747),p=n(62449),v=n(47737),g=n(34778);function m(){var e,t,n,r,i=(0,v.P1)(s()),o=(0,v.Po)(s());switch(s().pathname){case"/replEnvironmentDesktop":case"/replEnvironmentMobile":(e=s().query.replId?s().query.replId.toString():void 0)&&(t=(r=function(e){var t,n,r=null,i=null;try{r=null===p.V||void 0===p.V?void 0:p.V.readQuery({query:d,variables:{replId:e}}),i=null===p.V||void 0===p.V?void 0:p.V.readQuery({query:u.vU,variables:{replId:e}})}catch(e){}var o=(null==r?void 0:r.getRepl.__typename)==="Repl"?r.getRepl:void 0,s=(null==i?void 0:i.getRepl.__typename)==="Repl"&&null!=(n=i.getRepl.config.agentStackPlatformType)?n:void 0;return{replId:null==o?void 0:o.id,originReplId:null==o||null==(t=o.origin)?void 0:t.id,agentStackPlatformType:s}}(e)).originReplId,n=r.agentStackPlatformType)}return{isMobile:i,isBonsai:o,replId:e,originReplId:t,agentStackPlatformType:n}}function y(e){var t=e.action,n=e.fileType,r=e.fileSize,i=e.messageText,o=e.feedbackText,s=e.sessionId,a=e.eventId,u=e.secretsRequested,l=e.freeCheckpoint,c=e.replOwnerPlanName,d=e.planApprovalState,f=e.blueprints,h=e.toolDataKind,p=e.hasUbbV2,v=e.checkpointPrice,y=e.isEnterprise,b=e.ctaLabel,E=e.agentChatMode,w=e.initialBuildMode,I=m(),x=I.isMobile,_=I.isBonsai,S=I.replId,C=I.originReplId,k=I.agentStackPlatformType;return(0,g.u4)(g.AZ.AGENT_USED,{action:t,file_type:n,is_mobile:x,is_bonsai:_,repl_id:S,file_size:r,message_text:i,feedback_text:o,session_id:s,event_id:a,secrets_requested:u,free_checkpoint:l,origin_repl_id:C,repl_owner_plan_name:c,plan_approval_state:d,blueprints:f,tool_data_kind:h,hasUbbV2:p,checkpointPrice:v,is_enterprise:y,cta_label:b,agent_chat_mode:E,agent_stack_platform_type:k,initial_build_mode:w})}function b(e){var t,n,r=e.action,i=e.sessionId,o=e.messageText,s=e.planText,a=e.planId,u=e.isLatestPlanProposal,l=e.skipRapidBuild,c=e.planSupportsVisualPreview,d=e.didVisualPreviewComplete,p=e.numPlansProposed,v=e.stepsApproved,y=e.planBlueprints,b=e.stepBlueprints,w=e.stepId,I=e.stepName,x=e.initialBuildMode,_=e.isEnterprise,S=e.agentStackTriggerType,C=e.stackBlueprint,k=m(),A=k.isMobile,T=k.isBonsai,U=k.replId,M=k.originReplId,N=k.agentStackPlatformType;return(0,g.u4)(g.AZ.AGENT_USED,{action:r,session_id:i,is_mobile:A,is_bonsai:T,repl_id:U,message_text:o,plan_text:s,plan_id:a,is_latest_plan_proposal:u,skip_rapid_build:l,plan_supports_visual_preview:c,did_visual_preview_complete:d,num_plans_proposed:p,origin_repl_id:M,steps_approved:v,plan_blueprints:y,step_blueprints:b,step_id:w,step_name:I,initial_build_mode:function(e){switch(e){case f.jV8.AGENT_INITIAL_BUILD_MODE_SYNC:return"design";case f.jV8.AGENT_INITIAL_BUILD_MODE_ASYNC:return"full_build";default:return"unknown"}}(x),is_enterprise:_,agent_stack_platform_type:null!=N?N:S?E[S]:void 0,stack_name:null==(t=C)||t===f.qf8.STACK_BLUEPRINT_NONE?"Unknown":null!=(n=h.Wu[t].name)?n:"Unknown"})}var E=(r={},(0,i._)(r,f.ezV.UNKNOWN_TRIGGER_TYPE,a.J_c.Other),(0,i._)(r,f.ezV.SLACK_MESSAGE,a.J_c.Slack),(0,i._)(r,f.ezV.TELEGRAM_MESSAGE,a.J_c.Telegram),(0,i._)(r,f.ezV.TIME_BASED,a.J_c.TimeBased),r);function w(e){var t=e.action,n=e.sessionId,r=e.messageText,i=e.isEnterprise,o=m(),s=o.isMobile,a=o.isBonsai,u=o.replId,l=o.originReplId,c=o.agentStackPlatformType;return(0,g.u4)(g.AZ.AGENT_USED,{action:t,session_id:n,is_mobile:s,is_bonsai:a,repl_id:u,message_text:r,origin_repl_id:l,is_enterprise:i,agent_stack_platform_type:c})}},22585:(e,t,n)=>{n.d(t,{PM:()=>i,eb:()=>s,qq:()=>o});var r=n(74651);function i(e){return e}function o(e){return e}function s(e){return e}Symbol("extensionId"),Symbol("installationId"),Symbol("extensionCommandId"),r.ZU.Record(r.ZU.String(),r.ZU.Object({extensionId:r.ZU.String(),fileHandlerId:r.ZU.String()}))},24160:(e,t,n)=>{n.d(t,{Wq:()=>l,Zl:()=>s,jt:()=>a,mi:()=>u});var r=n(21462),i=n(76957),o=n(83028),s=(0,i.eU)(!1);function a(){return(0,o.h)(s)}function u(){return(0,o.AI)(s)}function l(){var e=(0,o.ob)(s);return(0,r.useCallback)(function(){return e(!0)},[e])}},25858:(e,t,n)=>{n.d(t,{hk:()=>c,vU:()=>l});var r=n(17844),i=n(12584),o=n(41114),s=n(54744);function a(){var e=(0,i._)(["\n  query ReplConfigAgentStackPlatformType($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        config {\n          agentStackPlatformType\n        }\n      }\n    }\n  }\n"]);return a=function(){return e},e}var u={},l=(0,o.J1)(a());function c(e){var t=(0,r._)({},u,e);return s.I(l,t)}},26339:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(17844),i=n(93629),o=n(34837),s=n(72272);function a(e){return(0,o.Y)(s.A,(0,i._)((0,r._)({},e),{children:(0,o.Y)("path",{fill:"#0093B0",d:"M9.804 12.041h4.962c1.382 0 2.485-1.137 2.485-2.525v-4.73c0-1.347-1.136-2.359-2.485-2.583A15.437 15.437 0 0 0 12.178 2c-.849.005-1.66.076-2.374.203-2.103.37-2.485 1.149-2.485 2.582V6.68h4.968v.631H5.454c-1.444 0-2.708.868-3.104 2.52-.456 1.892-.477 3.073 0 5.05.353 1.47 1.196 2.519 2.64 2.519H6.7v-2.27c0-1.64 1.419-3.087 3.104-3.087ZM9.49 5.417a.938.938 0 0 1-.932-.944c0-.524.416-.95.932-.95.513 0 .933.426.933.95a.938.938 0 0 1-.933.944Zm12.728 4.412c-.356-1.438-1.038-2.52-2.484-2.52h-1.865v2.206c0 1.71-1.45 3.151-3.104 3.151H9.804c-1.36 0-2.485 1.164-2.485 2.525v4.731c0 1.347 1.17 2.138 2.485 2.525 1.573.463 3.08.546 4.962 0 1.251-.362 2.485-1.091 2.485-2.525v-1.894h-4.963v-.63h7.448c1.444 0 1.981-1.008 2.484-2.52.519-1.557.497-3.053 0-5.05Zm-7.14 9.463c.516 0 .933.422.933.943 0 .524-.417.95-.932.95a.943.943 0 0 1-.933-.95c0-.522.419-.943.933-.943Z"})}))}},26537:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(17844),i=n(93629),o=n(34837),s=n(72272);function a(e){return(0,o.FD)(s.A,(0,i._)((0,r._)({},e),{children:[(0,o.Y)("path",{fill:"#0079F2",d:"M9.153 18.014s-.829.489.59.654c1.72.199 2.598.17 4.492-.193 0 0 .498.317 1.194.59-4.247 1.847-9.612-.106-6.276-1.051Zm-.519-2.409s-.93.698.49.847c1.837.192 3.287.208 5.796-.282 0 0 .348.357.893.552-5.134 1.522-10.854.12-7.179-1.117ZM13.009 11.52c1.046 1.221-.275 2.32-.275 2.32s2.657-1.39 1.437-3.132c-1.14-1.625-2.014-2.432 2.718-5.215 0 0-7.427 1.881-3.88 6.026Z"}),(0,o.Y)("path",{fill:"#0079F2",d:"M18.626 19.795s.613.513-.676.91c-2.451.753-10.203.98-12.356.03-.774-.342.677-.816 1.134-.915.476-.105.748-.085.748-.085-.86-.615-5.564 1.207-2.389 1.729 8.66 1.424 15.785-.641 13.539-1.669ZM9.552 13.11s-3.943.95-1.397 1.295c1.076.146 3.22.113 5.216-.057 1.631-.14 3.27-.436 3.27-.436s-.575.25-.992.538c-4.004 1.068-11.738.571-9.512-.521 1.883-.923 3.415-.819 3.415-.819Zm7.073 4.01c4.07-2.145 2.188-4.206.875-3.928a3.016 3.016 0 0 0-.466.126s.12-.19.348-.272c2.598-.926 4.597 2.733-.84 4.182 0 0 .064-.057.083-.108ZM14.17 1s2.255 2.287-2.137 5.803c-3.522 2.82-.803 4.429-.002 6.266-2.055-1.88-3.564-3.537-2.552-5.078C10.965 5.73 15.08 4.632 14.171 1Z"}),(0,o.Y)("path",{fill:"#0079F2",d:"M9.952 22.93c3.906.255 9.906-.14 10.048-2.014 0 0-.273.71-3.229 1.275-3.334.636-7.447.562-9.887.154 0 0 .5.419 3.068.586Z"})]}))}},29705:(e,t,n)=>{n.d(t,{$e:()=>M,Gn:()=>I,HW:()=>_,HY:()=>N,KO:()=>S,MG:()=>U,MN:()=>k,Ot:()=>q,Pw:()=>P,X_:()=>V,Yv:()=>H,Z_:()=>L,Zp:()=>Y,aF:()=>y,fm:()=>E,gT:()=>C,iP:()=>b,of:()=>A,pP:()=>w,pw:()=>T,uE:()=>Z,xx:()=>F});var r=n(29935),i=n(17844),o=n(93629),s=n(12694),a=n(86105),u=n(82643),l=n(35992),c=n(76957),d=n(55301),f=n.n(d),h=n(67201),p=n(22585),v=n(860),g=n(67333),m=n(95513),y=(0,c.eU)(!1),b=(0,c.eU)([]),E=(0,c.eU)([]),w=(0,c.eU)(null),I=(0,c.eU)((0,m.s)({extension:!0,isInitialized:!1},{onLog:function(){throw Error("Logged before extension system was initialized.")}})),x=(0,c.eU)([]),_=(0,c.eU)(null,function(e,t,n){var r=e(x);t(x,(0,l.jM)(r,function(e){e.push((0,l.jM)(n,function(t){t.index=e.length})),e.length>1e3&&e.splice(0,e.length-1e3)}))}),S=(0,c.eU)(null,function(e,t){t(x,[])}),C=(0,c.eU)("local:true"),k=(0,c.eU)(function(e){var t=e(x),n=e(C);if(!n)return t;var r=n.split(" ").map(function(e){var t=(0,s._)(e.split(":"),2),n=t[0],r=t[1];return n&&void 0===r?function(e){return e.message.toLowerCase().includes(n.toLowerCase())}:n&&""===r?function(e){return void 0!==f()(e,n)}:n&&r?function(e){try{return String(f()(e,n))===r}catch(e){return!1}}:null}).filter(function(e){return null!==e});return t.filter(function(e){return r.every(function(t){return t(e)})})}),A=(0,c.eU)(null,function(e,t,n){return(0,r._)(function(){return(0,u.YH)(this,function(r){if(e(b).find(function(e){return e.extensionId===n.extensionId}))throw Error("Extension already loaded");return t(b,function(e){return(0,l.jM)(e,function(e){var t,r,i,o,s,a,u,l,d=(r=n.baseUrl,i=n.extensionId,o=n.installationId,s=n.manifest,a=n.enableExperimentalApi,u=n.enableInternalApi,l=n.logger,{baseUrl:r,extensionId:i,installationId:o,manifest:s,isLocal:n.isLocal,stateAtom:(0,c.eU)({error:null,panes:[],scopes:new Set(null==(t=s.scopes)?void 0:t.map(function(e){return e.name})),enableExperimentalApi:a,enableInternalApi:u,commands:new Map}),logger:l});e.push(d)})}),[2]})})()}),T=(0,c.eU)(null,function(e,t,n){return(0,r._)(function(){return(0,u.YH)(this,function(r){if(e(E).find(function(e){return e.extensionId===n.extensionId||e.installationId===n.installationId||e.baseUrl===n.baseUrl}))throw Error("Extension already loaded");return t(E,function(e){return(0,l.jM)(e,function(e){e.push(n)})}),[2]})})()}),U=(0,c.eU)(null,function(e,t,n){var r=e(E).find(function(e){return e.baseUrl===n});if(r)return r;var i={baseUrl:n,extensionId:(0,p.PM)((0,h.A)()),installationId:(0,p.qq)((0,h.A)())};return t(E,function(e){return(0,l.jM)(e,function(e){e.push(i)})}),i}),M=(0,c.eU)(null,function(e,t,n){return(0,r._)(function(){return(0,u.YH)(this,function(e){return t(b,function(e){return(0,l.jM)(e,function(e){var t=e.findIndex(function(e){return"extensionId"in n?e.extensionId===n.extensionId:e.installationId===n.installationId});-1!==t&&e.splice(t,1)})}),[2]})})()}),N=(0,c.eU)(null,function(e,t,n){var r=e(b).find(function(e){return e.extensionId===n.extensionId});if(!r)throw Error("Extension not found");t(r.stateAtom,function(e){return(0,l.jM)(e,function(e){e.error=n.extensionError})})}),P=(0,c.eU)(null,function(e,t,n){var r=n.createCommand.id;if(!n.createCommand.id)throw Error("Expected createCommand to have id");if(!n.createCommand.contributions)throw Error("Expected createCommand to have contributions");t(n.extensionStateAtom,function(e){return(0,l.jM)(e,function(e){e.commands.set(r,n.createCommand)})})}),O=(0,c.eU)(function(e){return e(b).flatMap(function(t){return(0,a._)(e(t.stateAtom).commands.values())})}),R=(0,c.eU)(function(e){return e(b).map(function(e){var t;return null==(t=e.manifest.fileHandlers)?void 0:t.map(function(t){return(0,o._)((0,i._)({},t),{extension:e})})}).flat().filter(function(e){return!!e})}),D=(0,c.eU)(function(e){return e(b).map(function(e){var t;return null==(t=e.manifest.tools)?void 0:t.map(function(t){return(0,o._)((0,i._)({},t),{extension:e})})}).flat().filter(function(e){return!!e})});function q(){return(0,g.Du)(b)}function L(e){return q().find(function(t){return t.installationId===e})}function V(e){var t=L(e);return t&&e?t.stateAtom:null}function F(){return(0,g.Du)(R)}function Z(){return(0,g.Du)(D)}function Y(e){var t=(0,g.Du)(O);return(0,v.A)(function(){return t.filter(function(t){return t.contributions.includes(e)})},[t,e])}function H(){return(0,g.Du)(E)}},31736:(e,t,n)=>{n.d(t,{Kf:()=>r.Kf,ZV:()=>r.ZV,ev:()=>i,hp:()=>o,i6:()=>r.i6,sU:()=>s});var r=n(44709);function i(e){var t;if(!e)throw Error("Expected baseUrl");try{t=new URL(e)}catch(e){throw Error("baseUrl failed to parse as URL")}if("https:"!==t.protocol)throw Error("baseUrl must use https");return t.href.replace(/\/$/,"")}function o(e){return s(e,"extension.json")}function s(e,t){return new URL(t,i(e)).href}},32320:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(17844),i=n(93629),o=n(34837),s=n(72272);function a(e){return(0,o.FD)(s.A,(0,i._)((0,r._)({},e),{children:[(0,o.Y)("path",{fill:"#0079F2",d:"M8.157 19.313C4.211 19.313 1 16.067 1 12.08c0-3.988 3.21-7.232 7.157-7.232 2.547 0 4.922 1.384 6.198 3.614l-3.097 1.81a3.587 3.587 0 0 0-3.1-1.808c-1.974 0-3.58 1.622-3.58 3.616s1.606 3.616 3.58 3.616a3.587 3.587 0 0 0 3.1-1.809l3.097 1.811c-1.276 2.23-3.651 3.614-6.198 3.614Z"}),(0,o.Y)("path",{fill:"#0079F2",d:"M17.904 11.19H16.49V9.76h-1.414v1.429h-1.414v1.428h1.414v1.43h1.414v-1.43h1.414V11.19ZM21.792 11.19h1.413v1.428h-1.413v1.43h-1.414v-1.43h-1.414V11.19h1.414V9.76h1.413v1.429Z"})]}))}},33868:(e,t,n)=>{n.d(t,{Qq:()=>c,Zn:()=>d,lj:()=>u,wr:()=>l});var r=n(29935),i=n(86105),o=n(82643),s=n(41409),a=n(49555),u=function(e){return e.AlreadyExists="ALREADY_EXIST",e.FileRead="FILE_READ",e.Network="NETWORK",e}({}),l=0x6400000,c=1e6;function d(e){return(0,r._)(function(e){var t,n,u,d,f,h,p,v,g,m,y,b;return(0,o.YH)(this,function(E){switch(E.label){case 0:if(t=e.parentPath,n=e.overwrite,u=e.fs,d=e.files,f=e.onStart,h=e.onUpload,p=e.onError,v=e.onDone,g=e.envMigrationFlag,d.length>c)throw Error("Trying to upload too many files at once.");if(d.reduce(function(e,t){return t.size+e},0)>l)throw Error("Total file upload size exceeds maximum limit.");return m=function(e){var t=e.targetPath,i=e.file,s=e.progress;return(0,r._)(function(){var e,r;return(0,o.YH)(this,function(o){switch(o.label){case 0:if(n)return[3,2];return[4,u.stat(t)];case 1:if(o.sent().exists)return p(e={file:i,path:t,error:"ALREADY_EXIST"}),[2,e];o.label=2;case 2:return[4,u.transferFile(t,i,function(e,t){s.current=t/e},g)];case 3:if(o.sent().error===a.Tr.NotReadable)return p(r={file:i,path:t,error:"FILE_READ"}),[2,r];return null==h||h({file:i,path:t}),[2,{path:t,file:i}]}})})()},y=d.map(function(e){var n=e.dirPath||e.webkitRelativePath||e.name;return{targetPath:t?t+"/"+n:n,progress:(0,s.F)(0),file:e}}),null==f||f(y),[4,Promise.all(y.map(m))];case 1:return b=E.sent(),null==v||v({parentPath:t,uploads:b.filter(function(e){return!("error"in e)}),errors:b.reduce(function(e,t){return"error"in t?(0,i._)(e).concat([t]):e},[])}),[2]}})}).apply(this,arguments)}},40115:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(21462),i=n(63083);function o(){var e=(0,r.useContext)(i.A);if(!e)throw Error("Expected services in context");return e}},41426:(e,t,n)=>{n.d(t,{Ls:()=>p,Vg:()=>v,_u:()=>g});var r=n(29935),i=n(17844),o=n(93629),s=n(12694),a=n(82643),u=n(21462),l=n(35992),c=n(32978),d=n(69832),f=n(33868),h=n(13927),p="attached_assets",v=function(e){return"".concat(p,"/").concat(e)};function g(e){var t=e.sessionId,n=e.uploadFiles,p=e.onError,g=(0,d.HJ)([]),m=(0,d.HJ)([]),y=(0,u.useMemo)(function(){return c.cP.combine(c.cP.from(g),c.cP.from(m)).select(function(e){var t=(0,s._)(e,2),n=t[0],r=t[1];return n.some(function(e){return e.isLoading})||r.some(function(e){return e.file.isLoading})})},[g,m]),b=(0,u.useCallback)(function(e){g.update(function(t){return(0,l.jM)(t,function(t){var n=t.findIndex(function(t){return t.path===e});-1!==n&&t.splice(n,1)})})},[g]),E=(0,u.useCallback)(function(e){m.update(function(t){return(0,l.jM)(t,function(t){var n=t.findIndex(function(t){return t.file.path===e});-1!==n&&t.splice(n,1)})})},[m]),w=(0,u.useCallback)(function(e){return(0,r._)(function(){var r,s,u,c,d,m,y,E,w;return(0,a.YH)(this,function(a){switch(a.label){case 0:r=e.map(function(e){var t=function(e){if(e){var t=e.lastIndexOf("."),n=-1!==t?e.slice(0,t):e,r=-1!==t?e.slice(t):"";return"".concat(n,"_").concat(Date.now()).concat(r)}return"pasted_".concat(Date.now())}(e.fileName);return{path:v(t),mimeType:e.file.type,file:new File([e.file],t,{type:e.file.type,lastModified:e.file.lastModified}),isLoading:!0}}),s=!0,u=!1,c=void 0;try{for(d=r[Symbol.iterator]();!(s=(m=d.next()).done);s=!0){if((y=m.value).file.size>f.wr)return null==p||p("Attachment size exceeds ".concat(f.wr/1024/1024," MB limit.")),(0,h.pI)({action:"attempted_to_attach_file_exceeding_size_limit",fileType:y.file.type,fileSize:y.file.size,sessionId:t}),[2,[]];if("image/svg+xml"===y.file.type)return null==p||p("SVG images are not allowed"),(0,h.pI)({action:"attempted_to_attach_svg_image",sessionId:t}),[2,[]]}}catch(e){u=!0,c=e}finally{try{s||null==d.return||d.return()}finally{if(u)throw c}}return E=!1,[4,new Promise(function(e){g.update(function(e){return(0,l.jM)(e,function(e){var t=r.filter(function(t){return!e.some(function(e){return e.path===t.path})});if(e.length+t.length>20)return null==p||p("You can only attach up to ".concat(20," files.")),e;E=!0,r.forEach(function(t){var n=e.findIndex(function(e){return e.path===t.path});-1!==n?e[n]=t:e.push(t)})})}),e()})];case 1:if(a.sent(),!E)return[2,[]];if(r.forEach(function(e){(0,h.pI)({action:"attached_file",fileType:e.file.type,fileSize:e.file.size,sessionId:t})}),w=r.map(function(e){return e.file}),!n)return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,n({files:w,onError:function(e){r.forEach(function(e){return b(e.path)}),null==p||p("Error writing files: "+e)}})];case 3:return a.sent(),[3,5];case 4:return a.sent(),[2,[]];case 5:return g.update(function(e){return(0,l.jM)(e,function(e){r.forEach(function(t){var n=e.findIndex(function(e){return e.path===t.path});-1!==n&&(e[n]=(0,o._)((0,i._)({},e[n]),{isLoading:!1}))})})}),[2,r]}})})()},[n,b,p,t,g]),I=(0,u.useCallback)(function(e){var s=e.url,u=e.file;return(0,r._)(function(){var e;return(0,a.YH)(this,function(r){switch(r.label){case 0:return e=!1,[4,new Promise(function(t){m.update(function(t){return(0,l.jM)(t,function(t){var n=t.findIndex(function(e){return e.url===s&&e.file.path===u.path});if(-1===n&&t.length+g.current.length>=20)return null==p||p("You can only attach up to ".concat(20," files.")),t;e=!0,-1!==n?t[n]={url:s,file:u}:t.push({url:s,file:u})})}),t()})];case 1:if(r.sent(),!e)return[2,null];if((0,h.pI)({action:"attached_url_file",fileType:u.file.type,fileSize:u.file.size,sessionId:t}),!n)return[3,5];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,n({files:[u.file],onError:function(e){E(u.path),null==p||p("Error writing URL file: "+e)}})];case 3:return r.sent(),m.update(function(e){return(0,l.jM)(e,function(e){var t=e.findIndex(function(e){return e.url===s});-1!==t&&(e[t].file=(0,o._)((0,i._)({},e[t].file),{isLoading:!1}))})}),[3,5];case 4:return r.sent(),[2,null];case 5:return[2,{url:s,file:u}]}})})()},[n,E,p,t,m,g]),x=(0,u.useCallback)(function(){g.set([]),m.set([])},[g,m]);return(0,u.useMemo)(function(){return{attachments:g,removeAttachment:b,removeUrlAttachment:E,clearAttachments:x,urlAttachments:m,addAttachments:w,addUrlAttachment:I,isLoading:y}},[g,b,E,x,m,w,I,y])}},41918:(e,t,n)=>{n.d(t,{b:()=>r});var r=function(e){return e.CloudServices="Cloud Services",e.Collaboration="Collaboration",e.WorkspaceFeatures="Workspace Features",e.WorkspaceExtensions="Workspace Extensions",e.Other="Other",e}({})},42008:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(12694),i=n(21462);function o(e){var t=(0,r._)((0,i.useState)(e.getConnectionState()),2),n=t[0],o=t[1];return(0,i.useEffect)(function(){return e.onConnectionStateChanged(o)},[e]),n}},43743:(e,t,n)=>{n.d(t,{AK:()=>O,C:()=>M,CG:()=>q,EZ:()=>V,Ik:()=>c,JP:()=>x,Ky:()=>A,Li:()=>I,MG:()=>f,Qn:()=>Z,RB:()=>T,X1:()=>k,ZY:()=>L,_r:()=>D,dA:()=>w,hL:()=>_,iz:()=>R,n6:()=>Y,oo:()=>d,qE:()=>S,rD:()=>C,rj:()=>v,xe:()=>p,xq:()=>U});var r=n(17844),i=n(93629),o=n(86105),s=n(21462),a=n(76957),u=n(83028),l=(0,a.eU)(null);function c(){return(0,u.h)(l)}function d(){return(0,u.Ou)(l)}function f(){var e=(0,u.ob)(l);return(0,s.useCallback)(function(t){return e(t)},[e])}var h=(0,a.eU)(null);function p(){return(0,u.h)(h)}function v(){var e=(0,u.ob)(h),t=(0,u.ob)(b);return(0,s.useCallback)(function(n){e(function(e){return n!==e&&t({removedInitialVersionStepIds:[],removedLaterStepIds:[]}),n})},[e,t])}var g=(0,a.eU)(void 0),m=(0,a.eU)(void 0),y=(0,a.eU)(function(e){var t,n=e(g);return null!=(t=null==n?void 0:n.supportsVisualPreview)&&t}),b=(0,a.eU)({removedInitialVersionStepIds:[],removedLaterStepIds:[]}),E=(0,a.eU)(function(e){var t=e(b),n=e(g);if(t.removedInitialVersionStepIds.length>0){var r,i,o=null==n||null==(i=n.step)||null==(r=i.subSteps[0])?void 0:r.subSteps,s=t.removedInitialVersionStepIds.map(function(e){var t=null==o?void 0:o.find(function(t){return t.id===e});return null==t?void 0:t.name});return"Let's revise the plan with objective '".concat(null==n?void 0:n.objective,"' by ")+"removing the following steps: \n"+"- ".concat(s.join("\n- "))}});function w(){return(0,u.h)(E)}function I(){return(0,u.h)(b)}function x(){return(0,u.Ou)(b)}function _(){var e=(0,u.ob)(b),t=(0,u.ob)(l);return(0,s.useCallback)(function(n){e(function(e){return(0,i._)((0,r._)({},e),{removedInitialVersionStepIds:(0,o._)(e.removedInitialVersionStepIds).concat([n])})}),t("revising")},[e,t])}function S(){var e=(0,u.ob)(b);return(0,s.useCallback)(function(){e(function(e){return(0,i._)((0,r._)({},e),{removedInitialVersionStepIds:[]})})},[e])}function C(){var e=(0,u.ob)(b);return(0,s.useCallback)(function(t){e(function(e){return(0,i._)((0,r._)({},e),{removedLaterStepIds:(0,o._)(e.removedLaterStepIds).concat([t])})})},[e])}function k(){return(0,u.h)(g)}function A(){return(0,u.h)(m)}function T(){return(0,u.h)(y)}function U(){var e=(0,u.ob)(g),t=(0,u.ob)(b);return(0,s.useCallback)(function(n){e(function(e){return(null==n?void 0:n.planId)!==(null==e?void 0:e.planId)&&t({removedInitialVersionStepIds:[],removedLaterStepIds:[]}),n})},[e,t])}function M(){var e=(0,u.ob)(m);return(0,s.useCallback)(function(t){return e(t)},[e])}var N=(0,a.eU)(new Map),P=(0,a.eU)(new Set);function O(e){return(0,u.h)(N).get(e)}function R(){var e=(0,u.Ou)(N);return(0,s.useCallback)(function(t){return e().get(t)},[e])}function D(){var e=(0,u.ob)(N);return(0,s.useCallback)(function(t,n){e(function(e){var r=new Map(e);return r.set(t,n),r})},[e])}function q(){var e=(0,u.ob)(N);return(0,s.useCallback)(function(){return e(new Map)},[e])}function L(e){return(0,u.h)(P).has(e)}function V(){var e=(0,u.ob)(P);return(0,s.useCallback)(function(t){e(function(e){if(e.has(t))return e;var n=new Set(e);return n.add(t),n})},[e])}var F=(0,a.eU)(void 0);function Z(){var e=(0,u.Ou)(F);return(0,s.useCallback)(function(){return e()},[e])}function Y(){var e=(0,u.ob)(F);return(0,s.useCallback)(function(){return e(void 0)},[e])}},44709:(e,t,n)=>{n.d(t,{BO:()=>k,Kf:()=>_,ZV:()=>C,i6:()=>S});var r=n(12694),i=n(74651),o=n(97858),s=n(16128),a=n(59970),u=n.n(a),l=n(20369),c=n.n(l),d=n(37328),f=n.n(d),h=n(1069),p=n(87102),v=i.ZU.String({minLength:1,maxLength:64}),g=i.ZU.Object({path:i.ZU.String({minLength:1}),label:i.ZU.String({minLength:1})}),m=i.ZU.Object({image:(0,p.uq)(i.ZU.String({minLength:1})),title:i.ZU.String({minLength:1,maxLength:60}),body:i.ZU.String({minLength:1,maxLength:512})}),y=i.ZU.Object({glob:i.ZU.String({minLength:1}),handler:i.ZU.String({minLength:1}),name:(0,p.uq)(i.ZU.String({minLength:1})),icon:(0,p.uq)(i.ZU.String({minLength:1}))}),b=i.ZU.Object({handler:i.ZU.String({minLength:1}),name:(0,p.uq)(i.ZU.String({minLength:1})),icon:(0,p.uq)(i.ZU.String({minLength:1}))}),E=i.ZU.Union(h.z.map(function(e){return i.ZU.Literal(e)})),w=i.ZU.Object({name:E,reason:i.ZU.String()}),I=i.ZU.Object({page:i.ZU.String()}),x=i.ZU.Object({name:i.ZU.String({minLength:1,maxLength:60}),description:i.ZU.String({minLength:1,maxLength:255}),scopes:(0,p.uq)(i.ZU.Array(w)),longDescription:(0,p.uq)(i.ZU.String({minLength:1})),icon:(0,p.uq)(i.ZU.String({minLength:1})),tags:(0,p.uq)(i.ZU.Array(v,{maxItems:16})),coverImages:(0,p.uq)(i.ZU.Array(g,{maxItems:16})),fileHandlers:(0,p.uq)(i.ZU.Array(y,{maxItems:4})),tools:(0,p.uq)(i.ZU.Array(b,{maxItems:4})),website:(0,p.uq)(i.ZU.String()),authorEmail:(0,p.uq)(i.ZU.String()),background:(0,p.uq)(I),features:(0,p.uq)(i.ZU.Array(m,{minItems:1,maxItems:10}))});function _(e){var t=function(t,n,r){return{manifest:null,error:new p.yk([{type:n,schema:x,path:t,value:e,message:r,errors:[]}])}};if(o.J(x,e)){if(e.website&&!f()(e.website))return t("website",s.Yp.StringFormat,"website must be a valid url");if(e.authorEmail&&!c()(e.authorEmail))return t("authorEmail",s.Yp.StringFormat,"authorEmail must be a valid email");var n=null!=(d=e.fileHandlers)?d:[],i=!0,a=!1,l=void 0;try{for(var d,h,v=n.entries()[Symbol.iterator]();!(i=(h=v.next()).done);i=!0){var g=(0,r._)(h.value,2),m=g[0],y=g[1];if(!u()(y.glob))return t("fileHandlers[".concat(m,"].glob"),s.Yp.StringFormat,"glob must be a valid glob pattern")}}catch(e){a=!0,l=e}finally{try{i||null==v.return||v.return()}finally{if(a)throw l}}if(n&&n.length>1){var b=!0,E=!1,w=void 0;try{for(var I,_=n.entries()[Symbol.iterator]();!(b=(I=_.next()).done);b=!0){var S=(0,r._)(I.value,2),C=S[0],k=S[1];if(!(k.icon&&k.name))return t("fileHandlers[".concat(C,"]"),s.Yp.ObjectRequiredProperty,"When at least two fileHandlers are provided, they must all specify a name and icon")}}catch(e){E=!0,w=e}finally{try{b||null==_.return||_.return()}finally{if(E)throw w}}}var A=null!=(N=e.tools)?N:[];if(A&&A.length>1){var T=!0,U=!1,M=void 0;try{for(var N,P,O=A.entries()[Symbol.iterator]();!(T=(P=O.next()).done);T=!0){var R=(0,r._)(P.value,2),D=R[0],q=R[1];if(!(q.icon&&q.name))return t("tool[".concat(D,"]"),s.Yp.ObjectRequiredProperty,"When at least two tools are provided, they must all specify a name and icon")}}catch(e){U=!0,M=e}finally{try{T||null==O.return||O.return()}finally{if(U)throw M}}}return{manifest:e,error:null}}return{manifest:null,error:(0,p.$J)(x,e)}}function S(e){var t=_(e);if(t.manifest)return t.manifest;throw t.error}function C(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:null!=(e=n.name)?e:"Unnamed Extension",description:null!=(t=n.description)?t:"(no description)"}}function k(e,t){return!!e.scopes&&void 0!==e.scopes.find(function(e){return e.name===t})}},45380:(e,t,n)=>{n.d(t,{Ot:()=>i.Ot,Sc:()=>r.Sc,X_:()=>i.X_,Z_:()=>i.Z_,hS:()=>r.hS,l$:()=>r.l$,uE:()=>i.uE});var r=n(75538),i=n(29705)},48049:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(17844),i=n(93629),o=n(34837),s=n(72272);function a(e){return(0,o.Y)(s.A,(0,i._)((0,r._)({},e),{children:(0,o.Y)("path",{fill:"#E52222",fillRule:"evenodd",d:"m7.314 19.688 12.806 1.748-4.33-7.21-8.476 5.462ZM21.33 6.19l-1.135 1.705c-1.298 1.952-2.595 3.904-3.891 5.857-.072.108-.166.195-.064.362 1.252 2.069 2.495 4.143 3.74 6.215.197.328.396.654.65.968l.755-15.09-.055-.017ZM4.233 12.64c.058.055.205.087.273.054 1.201-.59 2.41-1.168 3.585-1.807.384-.209.678-.582 1.008-.885C10.193 9 11.284 7.995 12.375 6.99c.067-.062.146-.121.186-.2.392-.765.777-1.535 1.176-2.327-.476-.179-.927-.354-1.383-.513-.062-.021-.16.022-.226.059-1.057.59-2.133 1.149-3.156 1.792-.512.322-.928.797-1.382 1.21-.73.667-1.46 1.335-2.179 2.013-.19.18-.365.386-.514.602-.492.717-.97 1.444-1.469 2.192.28.288.533.564.805.821Zm4.39-.98-1.805 7.628 8.484-5.467-6.678-2.161Zm11.974-5.445-7.21 1.205 2.446 5.952 4.764-7.157ZM8.724 11.143l6.546 2.125-2.422-5.896-4.124 3.771Zm-4.4 2.969c-.778 1.856-1.528 3.65-2.292 5.476l4.363-.129-2.072-5.347Zm2.123 4.077.054-.012c.524-2.178 1.055-4.341 1.59-6.605l-3.5 1.82c.596 1.55 1.233 3.187 1.856 4.797Zm13.27-12.327c-.697-.185-1.394-.37-2.09-.553-1.002-.264-2.005-.524-3.006-.79-.126-.033-.216-.055-.29.096-.354.725-.718 1.445-1.078 2.167-.011.022-.009.051-.017.107l6.48-.982v-.045Zm-4.042-1.65 5.678 1.571-.938-2.673-4.732 1.05-.008.053ZM6.928 20.107c-.703-.081-1.425-.007-2.138.006-.586.01-1.172.032-1.758.05a.233.233 0 0 0-.18.08l14.532 1.343.01-.065-4.659-.636c-1.935-.264-3.867-.554-5.807-.778Zm-4.8-2.19C2.752 16.469 3.374 15.02 4 13.572c.063-.145.058-.243-.064-.36-.263-.25-.506-.519-.793-.817L2 18.037l.042.02c.03-.047.065-.09.086-.14ZM14.431 3.83c1.053-.271 2.12-.484 3.182-.72.07-.016.136-.039.204-.058L17.807 3l-4.562.614c.428.187.758.326 1.186.216Z",clipRule:"evenodd"})}))}},48373:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(12694),i=n(21462);let o=function(e){var t=(0,r._)((0,i.useState)(function(){return e?e.current:null}),2),n=t[0],o=t[1];return(0,i.useEffect)(function(){if(o(function(){return e?e.current:null}),e)return e.subscribe(function(e){return o(function(){return e})})},[e]),n}},49313:(e,t,n)=>{n.d(t,{AI:()=>c,IC:()=>a,Ou:()=>f,h:()=>l,ob:()=>d});var r=n(21462),i=n(79203),o=n(26325),s=n(56813),a=(0,r.createContext)(null);function u(){var e=(0,r.useContext)(a);if(!e)throw Error("Expected store in context");return e}function l(e){return(0,i.md)(e,{store:u()})}function c(e){return(0,s.k)(e,u())}var d=function(e){return(0,i.Xr)(e,{store:u()})};function f(e){return(0,o.yF)((0,r.useCallback)(function(t){return t(e)},[e]),{store:u()})}},52818:(e,t,n)=>{n.d(t,{Vq:()=>h,Y6:()=>l,Yk:()=>p,r1:()=>c,yG:()=>d,zy:()=>f});var r=n(29935),i=n(82643),o=n(45731),s=n(6723),a=n(31736),u=n(62449);function l(e){return(0,r._)(function(e){var t,n,r,o,a;return(0,i.YH)(this,function(i){switch(i.label){case 0:if(t=e.extensionId,n=e.replId,!u.V)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,u.V.mutate({mutation:s.Mf,variables:{extensionId:t,replId:n}})];case 1:if((o=i.sent()).errors&&o.errors.length>0)return[2,{error:Error("Error when installing extension: "+o.errors.map(function(e){return e.message}).join(", ")),result:null}];if(!(a=null==(r=o.data)?void 0:r.installExtension))return[2,{error:Error("Error when installing extension: expected result"),result:null}];if((null==a?void 0:a.__typename)==="UnauthorizedError"||(null==a?void 0:a.__typename)==="UserError")return[2,{error:Error("Error when installing extension: "+a.message),result:null}];if(!a.extension)return[2,{error:Error("Error when installing extension: expected extension to be set"),result:null}];if(!a.extension.url)return[2,{error:Error("Error when installing extension: Extension does not have a URL and cannot be installed"),result:null}];return[2,{result:a,error:null}]}})}).apply(this,arguments)}function c(e){return(0,r._)(function(e){var t,n,r,o,a;return(0,i.YH)(this,function(i){switch(i.label){case 0:if(t=e.installationId,n=e.replId,!u.V)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,u.V.mutate({mutation:s.H4,variables:{installationId:t,replId:n}})];case 1:if((o=i.sent()).errors&&o.errors.length>0)return[2,{error:Error("Error when uninstalling extension: "+o.errors.map(function(e){return e.message}).join(", ")),result:null}];if(!(a=null==(r=o.data)?void 0:r.uninstallExtension))return[2,{error:Error("Error when uninstalling extension: expected result"),result:null}];if((null==a?void 0:a.__typename)==="NotFoundError"||(null==a?void 0:a.__typename)==="UserError")return[2,{error:Error("Error when uninstalling extension: "+a.message),result:null}];return[2,{result:a,error:null}]}})}).apply(this,arguments)}function d(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,r._)(function(){var n;return(0,i.YH)(this,function(r){switch(r.label){case 0:if(!u.V)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,u.V.query({query:s.b,variables:{installationId:e},fetchPolicy:t?"network-only":"cache-first"})];case 1:if("ExtensionInstallation"!==(n=r.sent().data.extensionInstallationById).__typename)return[2,{error:Error("Expected to find extension installation"),result:null}];if(!n.extension)return[2,{error:Error("Expected installation.extension"),result:null}];return[2,{result:n,error:null}]}})})()}function f(e){return(0,r._)(function(){var t;return(0,i.YH)(this,function(n){switch(n.label){case 0:if(!u.V)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,u.V.query({query:s.gP,variables:{replId:e}})];case 1:if("ExtensionInstallationList"!==(t=n.sent().data.extensionInstallations).__typename)return[2,{error:Error("Expected to find ExtensionInstallationList"),result:null}];return[2,{result:t.installations,error:null}]}})})()}function h(e){return(0,r._)(function(){var t,n,r,s,u;return(0,i.YH)(this,function(i){switch(i.label){case 0:t=(0,a.hp)(e),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(t)];case 2:return[4,i.sent().text()];case 3:if(n=i.sent(),r=o._3(n),(s=(0,a.Kf)(r)).error)return[2,{error:s.error,result:null}];return[2,{result:s.manifest,error:null}];case 4:if("SyntaxError"===(u=i.sent()).name)return[2,{error:Error("Error when fetching manifest: invalid JSON"),result:null}];return[2,{error:Error("Error when fetching manifest: "+u.message),result:null}];case 5:return[2]}})})()}function p(){return(0,r._)(function(){var e;return(0,i.YH)(this,function(t){switch(t.label){case 0:if(!u.V)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,u.V.query({query:s.gQ,fetchPolicy:"cache-first"})];case 1:if(!(e=t.sent().data.currentUser)||"CurrentUser"!==e.__typename)return[2,{error:Error("Expected to find CurrentUser"),result:null}];return[2,{result:{userHasInternalApiEnabled:e.isAdmin||e.isStaff},error:null}]}})})()}},55247:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(17844),i=n(93629),o=n(34837),s=n(25590);function a(e){return(0,o.Y)(s.Ay,(0,i._)((0,r._)({},e),{children:(0,o.Y)("path",{fillRule:"evenodd",d:"M4.055 2.055A2.75 2.75 0 0 1 6 1.25h7a.75.75 0 0 1 .53.22l7 7c.141.14.22.331.22.53v11A2.75 2.75 0 0 1 18 22.75H6A2.75 2.75 0 0 1 3.25 20V4c0-.73.29-1.429.805-1.945ZM6 2.75A1.25 1.25 0 0 0 4.75 4v16A1.25 1.25 0 0 0 6 21.25h12A1.25 1.25 0 0 0 19.25 20V9.75H13a.75.75 0 0 1-.75-.75V2.75H6Zm7.75 1.06 4.44 4.44h-4.44V3.81Z",clipRule:"evenodd"})}))}},60235:(e,t,n)=>{n.d(t,{b:()=>o});var r=n(12694),i=n(59270);function o(e){if(0===e.length)return new Map;if(1===e.length)return new Map([[e[0],null]]);var t=new Map,n=!0,o=!1,s=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done);n=!0){var l=a.value,c=(0,i.WP)(l),d=t.get(c);d||(d=[],t.set(c,d)),d.push(l)}}catch(e){o=!0,s=e}finally{try{n||null==u.return||u.return()}finally{if(o)throw s}}var f=new Map,h=!0,p=!1,v=void 0;try{for(var g,m=t[Symbol.iterator]();!(h=(g=m.next()).done);h=!0){var y=(0,r._)(g.value,2)[1];if(1===y.length){f.set(y[0],null);continue}var b=new Map,E=new Set,w=0,I=!0,x=!1,_=void 0;try{for(var S,C=y[Symbol.iterator]();!(I=(S=C.next()).done);I=!0){var k=S.value;if(-1===k.indexOf("/")){f.set(k,null),E.add(k);continue}var A=function(e){for(var t=e.split("/").slice(0,-1),n=[],r=0;r<t.length;r++){var i=t.slice(r).join("/")+"/";0!==r&&(i="…/"+i),n.push(i)}return n.reverse()}(k);b.set(k,A),A.length>w&&(w=A.length)}}catch(e){x=!0,_=e}finally{try{I||null==C.return||C.return()}finally{if(x)throw _}}for(var T=0;T<=w;T++){var U=[],M=new Map,N=!0,P=!1,O=void 0;try{for(var R,D=b[Symbol.iterator]();!(N=(R=D.next()).done);N=!0){var q=(0,r._)(R.value,2),L=q[0],V=q[1];if(!E.has(L)){var F=V[T];F||(F=V[V.length-1]),U.push(F),M.set(F,L)}}}catch(e){P=!0,O=e}finally{try{N||null==D.return||D.return()}finally{if(P)throw O}}if(0===U.length)break;var Z=!0,Y=!1,H=void 0;try{for(var j,z=U[Symbol.iterator]();!(Z=(j=z.next()).done);Z=!0)!function(){var e=j.value,t=M.get(e);if(void 0===t)throw Error("Unpopulated segment map");1===U.filter(function(t){return t===e}).length&&(E.add(t),f.set(t,e))}()}catch(e){Y=!0,H=e}finally{try{Z||null==z.return||z.return()}finally{if(Y)throw H}}}if(E.size!==y.length){var X=!0,W=!1,B=void 0;try{for(var $,G=y[Symbol.iterator]();!(X=($=G.next()).done);X=!0){var K=$.value;if(!E.has(K)){var J=K.split("/").slice(0,-1).join("/");f.set(K,J)}}}catch(e){W=!0,B=e}finally{try{X||null==G.return||G.return()}finally{if(W)throw B}}}}}catch(e){p=!0,v=e}finally{try{h||null==m.return||m.return()}finally{if(p)throw v}}return f}},62246:(e,t,n)=>{n.d(t,{bY:()=>r.b,lQ:()=>f,Xc:()=>i.Xc,HJ:()=>l,u9:()=>i.u9,Vj:()=>i.Vj,QY:()=>i.QY,En:()=>i.En,xS:()=>i.xS,Dx:()=>i.Dx,gG:()=>i.gG,NM:()=>i.NM,qo:()=>p,Vv:()=>d});var r=n(41918),i=n(77541),o=n(17844),s=n(34837),a=n(21462),u={type:"commands",data:{autoFocus:!1}};function l(e){var t=e.config,n=e.filePaneFlag,r=void 0!==n&&n;function a(e){return r&&(0,i.xS)(e)?"codeEditor"===e.type||"history"===e.type?{type:"file",data:(0,o._)({type:"codeEditor"},e.data)}:{type:"file",data:(0,o._)({type:e.type},e.data)}:e}return{Icon:function(e){var n=e.pane,r=e.size,i=e.color,o=a(n),l=t[o.type]?o:u,c=t[l.type].Icon;return(0,s.Y)(c,{pane:l,size:void 0===r?16:r,color:i})},Content:function(e){var n=e.pane,r=e.options,i=a(n),o=t[i.type]?i:u,l=t[o.type].Content;return(0,s.Y)(l,{pane:o,options:r})},getTitle:function(e){var n=a(e),r=t[n.type]?n:u;return t[r.type].getTitle(r)},getTitlePill:function(e){var n,r=a(e),i=t[r.type]?r:u,o=t[i.type];return null==(n=o.getTitlePill)?void 0:n.call(o,i)},getDescription:function(e,n){var r=a(e),i=t[r.type]?r:u,o=t[i.type].description;return(null==n?void 0:n.short)&&o?o.split(/[a-zA-Z0-9]\. /)[0].trim():o},getCategory:function(e){var n=a(e),r=t[n.type]?n:u;return t[r.type].category},decode:function(e,n){var r,i=null;try{i=null==(r=t[e])?void 0:r.decode(n)}catch(e){}return i}}}var c=(0,a.createContext)(null);function d(){var e=(0,a.useContext)(c);if(!e)throw Error("Expected PaneUI in context");return e}var f=c.Provider,h=n(45380);function p(e,t){var n=d().getDescription(e,t),r=(0,h.Z_)((0,i.En)(e)?e.data.installationId:void 0);return null!=n?n:null==r?void 0:r.manifest.description}},63083:(e,t,n)=>{n.d(t,{A:()=>r});let r=(0,n(21462).createContext)(null)},67333:(e,t,n)=>{n.d(t,{Cj:()=>c,Du:()=>d,Ey:()=>h,Ol:()=>f,p9:()=>l});var r=n(12694),i=n(34837),o=n(21462),s=n(79203),a=n(76957),u=(0,o.createContext)(null);function l(){return function(){var e=(0,o.useContext)(u);if(!e)throw Error("Expected extensions context");return e}().store}var c=function(e){var t=l();return(0,s.fp)(e,{store:t})};function d(e){var t=l();return(0,s.md)(e,{store:t})}var f=function(e){var t=l();return(0,s.Xr)(e,{store:t})};function h(e){var t=e.children,n=(0,r._)((0,o.useState)(function(){return(0,a.y$)()}),1)[0];return(0,i.Y)(u.Provider,{value:{store:n},children:t})}},69832:(e,t,n)=>{n.d(t,{HJ:()=>p,_:()=>u,J2:()=>c,Rj:()=>d,G9:()=>h,q3:()=>g});var r=n(37743),i=n(48122),o=n(21462),s=n(32978),a=function(){"use strict";function e(t,n){var i=this;(0,r._)(this,e),this.value=s.NV;var o=0;this.observable=new s.cP(function(e){o++;var t=(0,s.D1)(function(e){return i.value=i.store.get(i.atom),e.next(i.value),i.store.sub(i.atom,function(){i.value=i.store.get(i.atom),e.next(i.value)})},e);return function(){0==--o&&(i.value=s.NV),t()}}),this.atom=t,this.store=n,this.subscribe=this.observable.subscribe.bind(this.observable)}return e.prototype[Symbol.observable]=function(){return this.observable},(0,i._)(e,[{key:"current",get:function(){return this.value!==s.NV?this.value:this.store.get(this.atom)}}]),e}();function u(e,t){return(0,o.useMemo)(function(){return new a(e,t)},[e,t])}var l=n(53847);function c(e,t){var n=(0,o.useMemo)(function(){if(!e)return{subscribe:function(){return function(){}},getSnapshot:function(){return s.NV}};var t=(0,l._)(e,s.l$)?e:s.cP.from(e),n=s.NV,r=s.NV;return"current"in e&&(n=e.current),(0,l._)(e,s.V_)&&(n=s.V_.getLastValueEscapeHatch(e)),{subscribe:function(e){var i=t.subscribe({next:function(t){var r=n;n=t,Object.is(r,t)||e()},error:function(t){r=t,e()}});return function(){i.unsubscribe()}},getSnapshot:function(){if(r!==s.NV)throw r;return n}}},[e]),r=(0,o.useSyncExternalStore)(n.subscribe,n.getSnapshot,n.getSnapshot);return r===s.NV?t:r}function d(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(0,o.useMemo)(e,t),i=c(r,s.NV),a=(0,o.useRef)(n.default);return r&&(i!==s.NV||!1!==n.preserve)?i!==s.NV&&(a.current=i):a.current=n.default,a.current}var f=o.useLayoutEffect;function h(e,t){var n=(0,o.useState)()[1],r=(0,o.useRef)(!1),i=(0,o.useRef)(t),a=(0,o.useRef)(null);if(a.current!==e&&(r.current=!1,i.current=t,a.current=e,e&&(0,l._)(e,s.V_))){var u=s.V_.getLastValueEscapeHatch(e);u!==s.NV&&(r.current=!0,i.current=u)}return r.current||i.current===t||(i.current=t),f(function(){if(e)return s.cP.from(e).subscribe({next:function(e){r.current=!0,i.current=e},error:function(e){n(function(){throw e})}})},[e,n]),i}function p(e){var t=(0,o.useRef)(null);return t.current||(t.current=new s.N(e)),t.current}var v=o.useLayoutEffect;function g(e,t){var n=(0,o.useRef)(t),r=(0,o.useState)()[1];v(function(){n.current=t}),(0,o.useEffect)(function(){if(e&&n.current)return s.cP.from(e).subscribe({next:function(e){var t;"function"==typeof n.current?n.current(e):(null==(t=n.current)?void 0:t.next)&&n.current.next(e)},complete:function(){var e;"function"!=typeof n.current&&(null==(e=n.current)?void 0:e.complete)&&n.current.complete()},error:function(e){var t;"function"!=typeof n.current&&(null==(t=n.current)?void 0:t.error)?n.current.error(e):r(function(){throw e})}})},[e,!!t])}},72272:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(17844),i=n(93629),o=n(17459),s=n(34837),a=n(21462),u=n(25590);function l(e){var t,n=e.size,l=e.style,c=e.children,d=(0,o._)(e,["size","style","children"]),f=null!=(t=d.color)?t:d.fill,h=f?{fill:f}:{};return(0,s.Y)(u.Ay,(0,i._)((0,r._)({color:f||"unset",size:n,style:l},d),{children:a.Children.map(c,function(e){if((0,a.isValidElement)(e))return(0,a.cloneElement)(e,h)})}))}},74248:(e,t,n)=>{n.d(t,{Ap:()=>c,Jr:()=>d,l:()=>l,uc:()=>u});var r=n(47888),i=n(35992),o=n(6132),s=n(86035),a={session:(0,i.CN)(r.X(s.iyV),!0),create:(0,i.CN)(r.X(s.L6$),!0),update:(0,i.CN)(r.X(s.edm),!0)};function u(e){var t,n=Object.assign({},a.create);return n.title=null!=(t=e.title)?t:"",n.sessionType=e.sessionType,n.replId=e.replId,n.SeededAiFirstEventContents=e.seededEvent?(0,o.hT)("seededAiFirstEventContents",{benchmarkParameters:{datasetId:"",instanceId:"",runId:"",replDescription:"",disableSandbox:!1,commandPrefix:[],overrideShellExecuteTimeoutSeconds:0,overrideMaxSteps:0},contents:e.seededEvent}):void 0,e.taskId&&(n.taskId=e.taskId),n}function l(e,t){var n=(0,i.jM)(e,function(e){var n,r,i,o,s;e.title=null!=(n=t.title)?n:e.title,e.sessionType=null!=(r=t.sessionType)?r:e.sessionType,e.archived=null!=(i=t.archived)?i:e.archived,e.readOnly=null!=(o=t.readOnly)?o:e.readOnly,e.taskId=null!=(s=t.taskId)?s:e.taskId}),r=Object.assign({},a.update);return r.id=n.id,r.title=n.title,r.sessionType=n.sessionType,r.replId=n.replId,r.activeEventId=n.activeEventId,void 0!==t.archived&&n.archived!==e.archived&&(r.archived=n.archived),void 0!==t.readOnly&&n.readOnly!==e.readOnly&&(r.readOnly=n.readOnly),void 0!==t.taskId&&n.taskId!==e.taskId&&(r.taskId=n.taskId),void 0!==t.isActiveAgentSession&&(r.isActiveAgentSession=t.isActiveAgentSession,n===e&&(n=Object.assign({},n))),{session:n,request:r}}function c(e){var t=Object.assign({},a.session),n=new Date;return t.id=e.sessionId,t.title=e.title,t.sessionType=e.sessionType,t.replId=e.replId,t.sessionCreationEventId=e.sessionCreationEventId,t.archived=!!e.archived,t.taskId=e.taskId,t.lastEventTime=n,t.created=n,t.updated=n,t}function d(e,t){return(0,i.jM)(e,function(e){var n,r;e.title=t.title,e.sessionType=t.sessionType,e.archived=null!=(n=t.archived)?n:e.archived,e.activeEventId=t.activeEventId,e.readOnly=null!=(r=t.readOnly)?r:e.readOnly})}},75538:(e,t,n)=>{n.d(t,{EF:()=>S,FS:()=>P,Sc:()=>k,WB:()=>T,hS:()=>C,iD:()=>U,l$:()=>A,mN:()=>N,yb:()=>M});var r=n(29935),i=n(53847),o=n(17844),s=n(93629),a=n(12694),u=n(82643),l=n(21462),c=n(76957),d=n(5844),f=n.n(d),h=n(67201),p=n(31736),v=n(44709),g=n(22585),m=n(87102),y=n(34778),b=n(85689),E=n(40115),w=n(52818),I=n(29705),x=n(67333),_=n(95513);function S(){var e=(0,x.Ol)(I.$e);return(0,l.useCallback)(function(t){return(0,r._)(function(){return(0,u.YH)(this,function(n){return e({installationId:t}),[2]})})()},[e])}function C(){var e=D(),t=e.throwSystemError,n=e.throwExtensionError,a=(0,x.Ol)(I.of),c=(0,x.Du)(I.Gn),d=(0,x.p9)();return(0,l.useCallback)(function(e){var l=e.installationId,h=e.forceRefetch,y=void 0===h||h;return(0,r._)(function(){var e,r,h,b,E,x,_,S,C,k,A,T,U,M,N,P,O;return(0,u.YH)(this,function(u){switch(u.label){case 0:return[4,(0,w.Yk)()];case 1:if(!(e=u.sent())||e.error)return t({friendlyMessage:"Failed to load user context",error:e.error}),[2];if(r=e.result.userHasInternalApiEnabled,!(h=d.get(I.fm).find(function(e){return e.installationId===l})))return[3,3];return[4,(0,w.Vq)(h.baseUrl)];case 2:if(b=u.sent(),E=c.createLogger({extensionId:h.extensionId,installationId:h.installationId,local:!0}),b.error)return x=(0,s._)((0,o._)({},h),{manifest:(0,p.ZV)(),enableExperimentalApi:!1,enableInternalApi:!1,logger:E.createLogger({extensionName:"Unnamed Extension"}),isLocal:!0}),c.info("Adding extension: ".concat(x.manifest.name),{extensionArgs:f()(x,["extensionId","installationId","baseUrl","manifest","enableExperimentalApi","enableInternalApi","isLocal"]),local:x.isLocal,error:!0}),a(x),_="Failed to load extension manifest",(0,i._)(b.error,m.yk)&&(_=b.error.message),n({extensionId:h.extensionId,installationId:h.installationId,extensionError:{error:b.error,friendlyMessage:_}}),[2];return S=(0,v.BO)(b.result,"experimental-api"),C=(0,s._)((0,o._)({},h),{manifest:b.result,enableExperimentalApi:S,enableInternalApi:r,logger:E.createLogger({extensionName:b.result.name}),isLocal:!0}),c.info("Adding extension: ".concat(C.manifest.name),{extensionArgs:f()(C,["extensionId","installationId","baseUrl","manifest","enableExperimentalApi","enableInternalApi","isLocal"]),local:!0}),a(C),[3,5];case 3:return[4,(0,w.yG)(l,y)];case 4:if((k=u.sent()).error)return t({friendlyMessage:"Something went wrong while downloading an extension",error:k.error}),[2];if(!(A=k.result))return t({friendlyMessage:"Extension failed to install",error:Error("Expected installation to be defined")}),[2];if(!(T=A.extension))return t({friendlyMessage:"Extension failed to install",error:Error("Expected extension to be defined")}),[2];if(!T.manifest)return n({extensionId:(0,g.PM)(T.id),installationId:(0,g.qq)(A.id),extensionError:{friendlyMessage:"Extension failed to install",error:Error("Expected extension manifest to be defined")}}),[2];if("ExtensionManifestError"===T.manifest.__typename)return n({extensionId:(0,g.PM)(T.id),installationId:(0,g.qq)(A.id),extensionError:{friendlyMessage:"An error occurred while loading the extension manifest: ".concat(T.manifest.message),error:Error(T.manifest.message)}}),[2];if(!T.manifest||"ExtensionManifest"!==T.manifest.__typename)return n({extensionId:(0,g.PM)(T.id),installationId:(0,g.qq)(A.id),extensionError:{friendlyMessage:"An error occurred while loading the extension manifest",error:Error("Expected extension manifest to be defined")}}),[2];return U=(0,p.i6)(T.manifest),M=(0,v.BO)(U,"experimental-api"),N=(0,g.PM)(T.id),P=T.enableInternalApi,O={extensionId:N,installationId:l,manifest:U,baseUrl:(0,p.ev)(T.url),enableExperimentalApi:M,enableInternalApi:r||P,logger:c.createLogger({extensionId:N,installationId:l,extensionName:U.name,local:!1}),isLocal:!1},c.info("Adding extension: ".concat(O.manifest.name),{extensionArgs:f()(O,["extensionId","installationId","baseUrl","manifest","enableExperimentalApi","enableInternalApi","isLocal"]),local:!1}),a(O),[2,A];case 5:return[2]}})})()},[a,n,t,d,c])}function k(){var e=C(),t=D().throwSystemError;return(0,l.useCallback)(function(n){var i=n.extensionId,o=n.replId;return(0,r._)(function(){var n,r,s;return(0,u.YH)(this,function(a){switch(a.label){case 0:return[4,(0,w.Y6)({extensionId:i,replId:o})];case 1:if((s=a.sent()).error)return t({error:s.error,friendlyMessage:"Something went wrong while installing an extension"}),[2];return(0,y.u4)(y.AZ.EXTENSION_INSTALLED,{name:null==(r=s.result)||null==(n=r.extension)?void 0:n.name,extensionId:i}),[4,e({installationId:(0,g.qq)(s.result.id)})];case 2:return a.sent(),[2,s.result]}})})()},[e,t])}function A(){var e=S(),t=(0,x.p9)(),n=D().throwSystemError;return(0,l.useCallback)(function(i){var o=i.installationId,s=i.replId;return(0,r._)(function(){var r;return(0,u.YH)(this,function(i){switch(i.label){case 0:if(!(r=t.get(I.iP).find(function(e){return e.installationId===o})))return n({friendlyMessage:"Extension appears to be already uninstalled",error:Error("Expected extension to be defined")}),[2];if(!r.installationId||!r.extensionId)return n({friendlyMessage:"Failed to uninstall extension",error:Error("Expected installationId to be defined")}),[2];return(0,y.u4)(y.AZ.EXTENSION_UNINSTALLED,{name:r.manifest.name,extensionId:r.extensionId}),[4,(0,w.r1)({installationId:r.installationId,replId:s})];case 1:return i.sent(),[4,e(r.installationId)];case 2:return i.sent(),[2]}})})()},[e,t,n])}function T(){var e=S(),t=C();return(0,l.useCallback)(function(n){return(0,r._)(function(){return(0,u.YH)(this,function(r){switch(r.label){case 0:return[4,e(n)];case 1:return r.sent(),[4,t({installationId:n,forceRefetch:!0})];case 2:return r.sent(),[2]}})})()},[e,t])}function U(){var e,t,n,i=(e=C(),t=(0,x.Du)(I.Gn),n=D().throwSystemError,(0,l.useCallback)(function(i){return(0,r._)(function(){var r,o,s,a,l,c,d,f,h,p;return(0,u.YH)(this,function(u){switch(u.label){case 0:return[4,(0,w.zy)(i)];case 1:if((r=u.sent()).error)return n({friendlyMessage:"Failed to load installed extensions",error:r.error}),[2];o=!0,s=!1,a=void 0,u.label=2;case 2:u.trys.push([2,9,10,11]),l=r.result[Symbol.iterator](),u.label=3;case 3:if(o=(c=l.next()).done)return[3,8];if(null==(f=(d=c.value).extension)?void 0:f.isDisabled)return t.info("Skipping disabled extension: ".concat(d.extension.name),{extension:!0,extensionId:d.extension.id,installationId:d.id}),[3,7];u.label=4;case 4:return u.trys.push([4,6,,7]),[4,e({installationId:(0,g.qq)(d.id),forceRefetch:!0})];case 5:return u.sent(),[3,7];case 6:return h=u.sent(),t.error("Extension Loading error: ".concat(h.message),{extension:!0,errors:h.message}),[3,7];case 7:return o=!0,[3,3];case 8:return[3,11];case 9:return p=u.sent(),s=!0,a=p,[3,11];case 10:try{o||null==l.return||l.return()}finally{if(s)throw a}return[7];case 11:return[2]}})})()},[e,n,t])),o=(0,x.Ol)(I.Gn),s=(0,x.Ol)(I.HW),c=(0,a._)((0,x.Cj)(I.aF),2),d=c[0],f=c[1],h=(0,a._)((0,l.useState)(null),2),p=h[0],v=h[1],m=(0,a._)((0,l.useState)(null),2),y=m[0],b=m[1];return(0,l.useEffect)(function(){if(p&&y&&!d){var e=p.replId;f(!0),i(e)}},[p,y,i,d,f]),(0,l.useCallback)(function(e){var t=e.replId,n=e.userId;if(!d){v({replId:t,userId:n});var r=(0,_.s)({extension:!0,isInitialized:!0,replId:t,userId:n},{onLog:function(e){s(e)}});b(r),o(r)}},[o,s,d])}function M(){var e=C(),t=(0,I.Yv)(),n=(0,I.Ot)(),i=(0,x.Ol)(I.pw);return(0,l.useCallback)(function(o){return(0,r._)(function(){var r,s;return(0,u.YH)(this,function(a){return r=(0,p.ev)(o),(s=t.find(function(e){return e.baseUrl===r}))||i(s={extensionId:(0,g.PM)((0,h.A)()),installationId:(0,g.qq)((0,h.A)()),baseUrl:r}),n.find(function(e){return e.extensionId===(null==s?void 0:s.extensionId)})||e({installationId:s.installationId}),[2]})})()},[t,n,i,e])}function N(){var e=(0,E.A)().container,t=(0,b.A)(e).url,n=(0,x.Ol)(I.MG),i=(0,x.p9)(),o=C();return(0,l.useCallback)(function(){return(0,r._)(function(){var e;return(0,u.YH)(this,function(r){switch(r.label){case 0:if(!t)return[2];return[4,o({installationId:(e=n(t)).installationId,forceRefetch:!0})];case 1:return r.sent(),[2,i.get(I.iP).find(function(t){return t.installationId===e.installationId})]}})})()},[t,n,o,i])}function P(){var e=(0,E.A)().container,t=(0,b.A)(e).url,n=(0,x.Ol)(I.MG),r=(0,I.Ot)();return(0,l.useMemo)(function(){if(t){var e=n(t);return r.find(function(t){return e.installationId===t.installationId})}},[t,r,n])}var O=(0,c.eU)(null,function(e,t,n){var r=e(I.Gn);t(I.pP,n),r.error("Extension System Error: ".concat(n.error.message),{extensionSystem:!0,originalError:n.error.message,friendlyMessage:n.friendlyMessage})}),R=(0,c.eU)(null,function(e,t,n){var r=e(I.iP),i=e(I.Gn),o=r.find(function(e){return e.extensionId===n.extensionId});if(i.error("Extension Error: ".concat(n.extensionError.friendlyMessage),{extension:!0,extensionId:n.extensionId,originalError:n.extensionError.error.message,friendlyMessage:n.extensionError.friendlyMessage}),!o){t(I.of,{extensionId:n.extensionId,installationId:n.installationId,manifest:(0,p.ZV)({name:n.extensionId}),baseUrl:"",enableExperimentalApi:!1,enableInternalApi:!1,logger:i.createLogger({extensionId:n.extensionId,extensionName:n.extensionId,installationId:n.installationId,local:void 0}),isLocal:null}),t(I.HY,{extensionId:n.extensionId,extensionError:n.extensionError});return}t(I.HY,{extensionId:n.extensionId,extensionError:n.extensionError})});function D(){return{throwSystemError:(0,x.Ol)(O),throwExtensionError:(0,x.Ol)(R)}}},77541:(e,t,n)=>{n.d(t,{Dx:()=>l,En:()=>p,NM:()=>h,QY:()=>u,Vj:()=>f,Xc:()=>m,gG:()=>g,u9:()=>c,xS:()=>d});var r=n(83846),i=n(86035),o=n(59270),s=n(49555);n(42793);var a=n(18712);function u(e){var t=e.path;return t?(0,o.Go)(t)?"binary":(0,o.FN)(t)?"media":(0,o.P1)(t)?"draw":"codeEditor":"codeEditor"}function l(e){return"codeEditor"===e||"binary"===e||"media"===e||"draw"===e||"history"===e}function c(e){var t=[],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;l.type===s.pt.File&&t.push({type:u({path:l.path}),data:{path:l.path}})}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}function d(e){return l(e.type)}function f(e){return d(e)?e.data.path:null}function h(e){return!d(e)&&"markdown"!==e.type}function p(e){return"extension"===e.type}a.wp.width("100%"),a.wp.maxWidth(600);var v=new Set(["extensionStore","docs","vnc","automations","runnerOutput","git","envEditor","tutorial","database","neon","replAuth","preferences","deployments","ghostwriterChat","extensionDevtools","objectStorage","workflows","project","config","agentProgress","agentChat","replitAuth","securityScan","developer"]);function g(e){return v.has(e)}var m=(0,r._)({},i.qf8.STACK_BLUEPRINT_AGENT,"automations")},83028:(e,t,n)=>{n.d(t,{AI:()=>v,NC:()=>d,Ou:()=>m,dI:()=>c,h:()=>p,ob:()=>g,tv:()=>l,zv:()=>f});var r=n(34837),i=n(21462),o=n(79203),s=n(26325),a=n(56813),u=(0,i.createContext)(null);function l(e){var t=(0,i.useMemo)(function(){return{store:e.store,yapper:e.yapper}},[e.store,e.yapper]);return(0,r.Y)(u.Provider,{value:t,children:e.children})}function c(){var e=(0,i.useContext)(u);if(!e)throw Error("Expected Yapper in context");return e.yapper}function d(){var e=(0,i.useContext)(u);if(!e)throw Error("Expected Yapper in context");return e.yapper.chatter()}function f(e,t){var n=c(),r=(0,i.useRef)(t);r.current=t,(0,i.useEffect)(function(){return n.hook(e,function(e){return r.current(e)})},[n,e])}function h(){var e=(0,i.useContext)(u);if(!e)throw Error("Expected store in context");return e.store}function p(e){return(0,o.md)(e,{store:h()})}function v(e){return(0,a.k)(e,h())}var g=function(e){return(0,o.Xr)(e,{store:h()})};function m(e){return(0,s.yF)((0,i.useCallback)(function(t){return t(e)},[e]),{store:h()})}},85689:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(12694),i=n(21462),o=n(86103),s=n(37960),a=n(71696),u=n(42008);function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fallbackToReplCo:!0},n=(0,u.A)(e),l=(0,r._)((0,i.useState)(null),2),c=l[0],d=l[1],f=(0,r._)((0,i.useState)(!0),2),h=f[0],p=f[1],v=(0,r._)((0,i.useState)(!0),2),g=v[0],m=v[1],y=(0,o._P)({controlName:"flag-webview-fallback-url"});return(0,i.useEffect)(function(){if(e.getConnectionState()===a.KN.CONNECTED){var n=e.getDotdevUrl();if(n){var r=(0,s.yP)(n),i=(0,s.yP)(null==n?void 0:n.replace(/.replit.dev$/,".repl.co"));if(p(r),m(i),!y||!t.fallbackToReplCo||r)return void d(n);d(n.replace(/.replit.dev$/,".repl.co"))}}},[e,n,y,t]),{url:c,reachability:{dotdev:h,replCo:g}}}},86402:(e,t,n)=>{n.d(t,{wV:()=>ec,KH:()=>tA,j2:()=>y,Ku:()=>eo,r:()=>tX,xH:()=>tW,Yd:()=>tY,Ds:()=>tH,VD:()=>tz,nv:()=>tj,qK:()=>ea,lJ:()=>S,WQ:()=>eu,Jq:()=>tV,Ik:()=>tq.Ik,Ky:()=>tq.Ky,dm:()=>tT,k:()=>tU,K2:()=>tP,so:()=>tO,zv:()=>eh.zv,NC:()=>eh.NC,CG:()=>tq.CG,qE:()=>tq.qE,UK:()=>tm,AK:()=>tq.AK,Wq:()=>tI.Wq,oo:()=>tq.oo,iz:()=>tq.iz,JP:()=>tq.JP,lW:()=>tD,Gk:()=>ty,ZY:()=>tq.ZY,q4:()=>tb,OI:()=>tk,EZ:()=>tq.EZ,dA:()=>tq.dA,fS:()=>tR,X1:()=>tq.X1,RB:()=>tq.RB,Li:()=>tq.Li,hL:()=>tq.hL,rD:()=>tq.rD,xe:()=>tq.xe,hM:()=>tF,MG:()=>tq.MG,C:()=>tq.C,_r:()=>tq._r,xq:()=>tq.xq,rj:()=>tq.rj,jt:()=>tI.jt,mi:()=>tI.mi,dI:()=>eh.dI});var r=n(29935),i=n(82643),o=n(97858),s=n(10752),a=n.n(s),u=n(90629);function l(e,t){return"string"==typeof e&&(e=Error(e)),u.v4(function(n){n.setTag("ai-chat",!0),t&&n.setExtras(t),u.Cp(e)}),e}var c=n(74651);n(87102),c.ZU.Object({replId:c.ZU.Union([c.ZU.String(),c.ZU.Null()]),orgId:c.ZU.Optional(c.ZU.String())}),c.ZU.Object({userId:c.ZU.Number(),orgId:c.ZU.Optional(c.ZU.String()),replId:c.ZU.Optional(c.ZU.String())});var d=c.ZU.Object({token:c.ZU.String()}),f=c.ZU.Object({isAuthorized:c.ZU.Literal(!0),code:c.ZU.Literal("authorized"),message:c.ZU.String()}),h=c.ZU.Object({isAuthorized:c.ZU.Literal(!1),code:c.ZU.Union([c.ZU.Literal("feature_disabled"),c.ZU.Literal("feature_unsupported_for_non_teams"),c.ZU.Literal("feature_unsupported_for_replit_teams"),c.ZU.Literal("feature_unsupported_for_teams_edu"),c.ZU.Literal("feature_unsupported_for_teams_pro"),c.ZU.Literal("feature_unsupported_for_teams_free"),c.ZU.Literal("insufficient_permissions"),c.ZU.Literal("insufficient_quota"),c.ZU.Literal("insufficient_budget"),c.ZU.Literal("requires_payment_method"),c.ZU.Literal("requires_active_subscription")]),message:c.ZU.String()}),p=c.ZU.Union([f,h]);c.ZU.Object({basicModel:p,advancedModel:p,paidAgent:p,freeAgent:p,basicAssistant:p,advancedAssistant:p});var v={minutes:30},g={},m=new(a());function y(e,t,n){return(0,r._)(function(){return(0,i.YH)(this,function(s){return[2,m.acquire(null!=e?e:"non-repl-key",function(){return(0,r._)(function(){var s,a,u;return(0,i.YH)(this,function(c){switch(c.label){case 0:if((s=g[t])&&new Date().getTime()<s.expiration)return[2,s.token];return[4,(0,r._)(function(){var t;return(0,i.YH)(this,function(r){switch(r.label){case 0:return[4,fetch("/ai/auth",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({replId:e,orgId:n})})];case 1:return[4,r.sent().json()];case 2:if(t=r.sent(),!o.J(d,t))throw l("Authentication to chat service failed",{detail:t});return[2,t.token]}})})()];case 1:return a=c.sent(),u=new Date().getTime()+60*v.minutes*1e3,g[t]={token:a,expiration:u},[2,a]}})})()})]})})()}var b=n(12694),E=n(34837),w=n(21462),I=n(47993),x=n(76957),_=n(86035),S=function(){var e=window.location.hostname;return e.includes("replit.com")&&!e.includes("staging.replit.com")},C=n(68248),k=n(17844),A=n(93629),T=n(36312),U={codec:T.MU,heartbeatIntervalMs:2500,heartbeatsUntilDead:40,enableTransparentSessionReconnects:!0,sessionDisconnectGraceMs:15e3,connectionTimeoutMs:1e4,handshakeTimeoutMs:1e4};(0,k._)({},U);var M=(0,A._)((0,k._)({},U),{baseIntervalMs:250,maxJitterMs:500,maxBackoffMs:32e3,attemptBudgetCapacity:5,budgetRestoreIntervalMs:2e3}),N=c.ZU.Object({token:c.ZU.String()}),P=n(42028),O=n(47477),R=new Map,D=new O.eu,q=n(37743),L=n(48122),V=n(32978),F=function(){"use strict";function e(t){var n=this,r=t.connection,i=t.replId;(0,q._)(this,e),this.disposed=!1,this.teardowns=new V.do,this.connected=new V.V_(function(e){var t=null,r=n.teardowns.add(function(){null==t||t.abort(),t=null,e.complete()}),i=n.status.subscribe(function(n){"connected"!==n?(null==t||t.abort(),t=null,"closed"===n?e.complete():"error"===n&&e.error(Error("Connection error"))):(t=new AbortController,e.next(t.signal))});return function(){null==t||t.abort(),t=null,r(),i.unsubscribe()}}),this.closed=new V.V_(function(e){var t=n.teardowns.add(function(){e.next(),e.complete()}),r=n.status.subscribe(function(t){("closed"===t||"error"===t)&&(e.next(),e.complete())});return function(){t(),r.unsubscribe()}}),this.connection=r,this.replId=null!=i?i:null}var t=e.prototype;return t.teardown=function(e){return this.disposed?(e(),function(){}):this.teardowns.add(e)},t.assertReplId=function(){if(!this.replId)throw Error("Client was not initialized with a Repl ID")},t.dispose=function(){this.disposed||(this.disposed=!0,this.teardowns.notify(),this.teardowns.clear())},(0,L._)(e,[{key:"client",get:function(){return this.connection.client}},{key:"status",get:function(){return this.connection.status}}]),e}(),Z=n(46434),Y=function(){"use strict";function e(t){var n=this;(0,q._)(this,e),this.state=new V.V_(function(e){return n.api.connected.lift(e,function(t){return(0,r._)(function(){var n,r,o,s,a,u,l,c;return(0,i.YH)(this,function(i){switch(i.label){case 0:this.api.assertReplId(),n=this.api.client.planner.state.subscribe({replId:this.api.replId},{signal:t}).resReadable,r=!1,o=!1,i.label=1;case 1:i.trys.push([1,6,7,12]),a=(0,Z._)(n),i.label=2;case 2:return[4,a.next()];case 3:if(!(r=!(u=i.sent()).done))return[3,5];if((l=u.value).ok)e.next(l.payload);else{if("UNEXPECTED_DISCONNECT"===l.payload.code||"CANCEL"===l.payload.code)return[2];e.error(l.payload)}i.label=4;case 4:return r=!1,[3,2];case 5:return[3,12];case 6:return c=i.sent(),o=!0,s=c,[3,12];case 7:if(i.trys.push([7,,10,11]),!(r&&null!=a.return))return[3,9];return[4,a.return()];case 8:i.sent(),i.label=9;case 9:return[3,11];case 10:if(o)throw s;return[7];case 11:return[7];case 12:return[2]}})}).call(n)})}),this.api=t}var t=e.prototype;return t.get=function(){return(0,r._)(function(){return(0,i.YH)(this,function(e){return this.api.assertReplId(),[2,this.api.client.planner.getPlan.rpc({replId:this.api.replId})]})}).call(this)},t.create=function(e){return(0,r._)(function(e){var t,n;return(0,i.YH)(this,function(r){switch(r.label){case 0:return t=e.text,n=e.messageEventContents,this.api.assertReplId(),[4,this.api.client.planner.createPlanItem.rpc({replId:this.api.replId,text:t,messageEventContents:n})];case 1:return[2,r.sent()]}})}).apply(this,arguments)},t.update=function(e){return(0,r._)(function(e){var t,n,r,o;return(0,i.YH)(this,function(i){return t=e.id,n=e.text,r=e.messageEventContents,o=e.toIndex,this.api.assertReplId(),[2,this.api.client.planner.updatePlanItem.rpc({replId:this.api.replId,id:t,text:n,messageEventContents:r,toIndex:o})]})}).apply(this,arguments)},t.delete=function(e){return(0,r._)(function(e){var t;return(0,i.YH)(this,function(n){return t=e.id,this.api.assertReplId(),[2,this.api.client.planner.deletePlanItem.rpc({replId:this.api.replId,id:t})]})}).apply(this,arguments)},e}(),H=function(){"use strict";function e(t){var n=this;(0,q._)(this,e),this.state=new V.V_(function(e){return n.api.connected.lift(e,function(t){return(0,r._)(function(){var n,r,o,s,a,u,l,c;return(0,i.YH)(this,function(i){switch(i.label){case 0:n=this.api.client.queue.state.subscribe({},{signal:t}).resReadable,r=!1,o=!1,i.label=1;case 1:i.trys.push([1,6,7,12]),a=(0,Z._)(n),i.label=2;case 2:return[4,a.next()];case 3:if(!(r=!(u=i.sent()).done))return[3,5];if((l=u.value).ok)e.next(l.payload);else{if("UNEXPECTED_DISCONNECT"===l.payload.code||"CANCEL"===l.payload.code)return[2];e.error(l.payload)}i.label=4;case 4:return r=!1,[3,2];case 5:return[3,12];case 6:return c=i.sent(),o=!0,s=c,[3,12];case 7:if(i.trys.push([7,,10,11]),!(r&&null!=a.return))return[3,9];return[4,a.return()];case 8:i.sent(),i.label=9;case 9:return[3,11];case 10:if(o)throw s;return[7];case 11:return[7];case 12:return[2]}})}).call(n)})}),this.api=t}var t=e.prototype;return t.get=function(){return(0,r._)(function(){return(0,i.YH)(this,function(e){switch(e.label){case 0:return[4,this.api.client.queue.get.rpc({})];case 1:return[2,e.sent()]}})}).call(this)},t.enqueue=function(e){return(0,r._)(function(e){var t;return(0,i.YH)(this,function(n){switch(n.label){case 0:return t=e.contents,[4,this.api.client.queue.enqueue.rpc({contents:t})];case 1:return[2,n.sent()]}})}).apply(this,arguments)},t.update=function(e){return(0,r._)(function(e){var t,n;return(0,i.YH)(this,function(r){switch(r.label){case 0:return t=e.id,n=e.contents,[4,this.api.client.queue.update.rpc({id:t,contents:n})];case 1:return[2,r.sent()]}})}).apply(this,arguments)},t.reorder=function(e){return(0,r._)(function(e){var t,n;return(0,i.YH)(this,function(r){switch(r.label){case 0:return t=e.id,n=e.after,[4,this.api.client.queue.reorder.rpc({id:t,after:n})];case 1:return[2,r.sent()]}})}).apply(this,arguments)},t.flush=function(e){return(0,r._)(function(e){var t;return(0,i.YH)(this,function(n){switch(n.label){case 0:return t=e.ids,[4,this.api.client.queue.flush.rpc({ids:t})];case 1:return[2,n.sent()]}})}).apply(this,arguments)},t.delete=function(e){return(0,r._)(function(e){var t;return(0,i.YH)(this,function(n){switch(n.label){case 0:return t=e.ids,[4,this.api.client.queue.delete.rpc({ids:t})];case 1:return[2,n.sent()]}})}).apply(this,arguments)},e}(),j=function(){"use strict";function e(t){(0,q._)(this,e),this.api=new F(t),this.planner=new Y(this.api),this.queue=new H(this.api)}var t=e.prototype;return t.ping=function(){return(0,r._)(function(){return(0,i.YH)(this,function(e){switch(e.label){case 0:return[4,this.api.client.debug.ping.rpc({})];case 1:return[2,e.sent()]}})}).call(this)},t.dispose=function(){this.api.dispose()},(0,L._)(e,[{key:"status",get:function(){return this.api.status}}]),e}(),z=n(67255),X=n(96631),W=function(){"use strict";function e(t){var n=this,o=t.userId,s=t.connectImmediately,a=t.logger,u=t.getEndpoint,l=t.getToken,c=t.overrideWebsocket,d=t.onProtocolError,f=t.onRetriesExceeded;(0,q._)(this,e),this.dispose=null,this.clientId="".concat(o,"-").concat((0,z.A)()),this.serverId="SERVER",this.log=null!=a?a:null,this.status=new V.N("disconnected"),this.transport=new X.I(c?function(){return(0,r._)(function(){return(0,i.YH)(this,function(e){switch(e.label){case 0:return[4,u()];case 1:return[2,c.apply(void 0,[e.sent().toString()])]}})})()}:function(){return(0,r._)(function(){var e;return(0,i.YH)(this,function(t){switch(t.label){case 0:return e=WebSocket.bind,[4,u()];case 1:return[2,new(e.apply(WebSocket,[void 0,t.sent().toString()]))]}})})()},this.clientId,M),a&&this.transport.bindLogger(a,"info"),this.client=(0,C.UU)(this.transport,this.serverId,{eagerlyConnect:!1,connectOnInvoke:!1,handshakeOptions:(0,C.f2)(N,function(){return(0,r._)(function(){return(0,i.YH)(this,function(e){switch(e.label){case 0:return[4,l()];case 1:return[2,e.sent()]}})})()})}),this.transport.addEventListener("sessionTransition",function(e){n.is("closed","error")||("Connected"===e.state?n.status.set("connected"):n.transport.reconnectOnConnectionDrop?n.status.set("connecting"):n.status.set("disconnected"))}),this.transport.addEventListener("sessionStatus",function(e){n.is("closed","error")||"closed"===e.status&&(n.transport.reconnectOnConnectionDrop?n.status.set("connecting"):n.status.set("disconnected"))}),this.transport.addEventListener("protocolError",function(e){var t,r;if(e.type===T.bd.HandshakeFailed){null==(t=n.log)||t.call(n,"river handshake failed",{clientId:n.clientId},"error");return}if(e.type===T.bd.RetriesExceeded){null==(r=n.log)||r.call(n,"river retry limit exceeded",{clientId:n.clientId},"error"),n.close(),null==f||f(e);return}n.error(),null==d||d(e)});var h=function(){return!n.is("closed","error")&&"visible"===document.visibilityState&&window.navigator.onLine},p=function(){var e=n.transport.reconnectOnConnectionDrop,t=h();n.transport.reconnectOnConnectionDrop=t,e&&!t&&n.is("connecting")&&n.status.set("disconnected"),t&&n.is("disconnected")&&n.connect()};this.transport.reconnectOnConnectionDrop=h(),document.addEventListener("visibilitychange",p),window.addEventListener("online",p),window.addEventListener("offline",p),this.dispose=function(){document.removeEventListener("visibilitychange",p),window.removeEventListener("online",p),window.removeEventListener("offline",p)},h()&&!1!==s&&this.connect(),!0===s&&this.connect()}var t=e.prototype;return t.is=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.status.current)},t.connect=function(){if(this.is("closed","error"))throw Error("Cannot connect to a ".concat(this.status.current," ChortRiverConnection"));this.is("connected","connecting")||(this.status.set("connecting"),this.transport.connect(this.serverId))},t.error=function(){if(!this.is("closed","error")){var e;this.status.set("error"),this.transport.close(),null==(e=this.dispose)||e.call(this),this.dispose=null}},t.close=function(){if(!this.is("closed","error")){var e;this.status.set("closed"),this.transport.close(),null==(e=this.dispose)||e.call(this),this.dispose=null}},e}(),B=n(39938),$=n(69071),G=n(95570),K=window.location.search.includes("aiChatDebug=1"),J=function(e,t,n){var r;K&&G[null!=n?n:"info"]("[chort] "+e,t),$.vF[null!=n?n:"info"](e,{river:t,riverTarget:"chort",riverVersion:C.rE}),(null==t||null==(r=t.tags)?void 0:r.includes("invariant-violation"))&&u.v4(function(n){n.setTag("chort",!0),n.setExtras(t),u.Cp(Error(e))})},Q=n(48055),ee=n(89961),et=n(7232),en=n(58631),er=n(64946),ei="ghostwriter-chat-env",eo=er.env.CHAT_SERVICE_OVERRIDE,es=en.A.get(ei,"string"),ea=function(){return eo||es||(S()?et.B.production:et.B.staging)};function eu(e){en.A.set(ei,e)}var el=n(95570),ec="SERVER",ed=window.location.search.includes("aiChatDebug=1"),ef=function(e,t,n){var r;ed&&el[null!=n?n:"info"]("[ai-chat]"+e,t),$.vF[null!=n?n:"info"](e,{river:t,riverTarget:"ai-chat",riverVersion:Q.rE}),(null==t||null==(r=t.tags)?void 0:r.includes("invariant-violation"))&&u.v4(function(n){n.setTag("ai-chat",!0),n.setExtras(t),u.Cp(Error(e))})},eh=n(83028),ep=n(62019),ev=n(1833),eg=n(53847),em=n(86105),ey=n(22531),eb=n(89264),eE=function e(t){"use strict";(0,q._)(this,e),this.ok=!0,this.payload=t},ew=c.ZU.Object({code:c.ZU.String(),message:c.ZU.Optional(c.ZU.String()),extras:c.ZU.Optional(c.ZU.Unknown())}),eI=c.ZU.Object({ok:c.ZU.Literal(!1),payload:ew}),ex=function(e){"use strict";function t(e){(0,q._)(this,t);var n,r,i={code:"UNCAUGHT_ERROR",message:"An unexpected error occurred"};if((0,eg._)(e,V.Rx))i.code="UNEXPECTED_DISCONNECT",i.message="Unexpected disconnect",r=e.stack;else if((0,eg._)(e,Error))i.message=e.message,r=e.stack;else if("UNEXPECTED_DISCONNECT"===e)i.code="UNEXPECTED_DISCONNECT",i.message="Unexpected disconnect";else if("UNCAUGHT_ERROR"===e)i.code="UNCAUGHT_ERROR",i.message="An unexpected error occurred";else if("string"==typeof e)i.message=e;else if(e&&(void 0===e?"undefined":(0,ey._)(e))==="object"){var s=null;o.J(ew,e)?s=e:o.J(eI,e)&&(s=e.payload),s&&(i.code=s.code,i.message=s.message,i.extras=s.extras)}return(n=(0,ep._)(this,t,[i.message])).ok=!1,n.name="ChatError",n.payload=i,n.input=e,r&&(n.stack=r),n}return(0,ev._)(t,e),t}((0,eb._)(Error));function e_(e){return new eE(e)}function eS(e){return(0,eg._)(e,ex)?e:new ex(e)}function eC(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.length?!e.ok&&n.includes(e.payload.code):!e.ok}function ek(e){if("function"==typeof e)try{var t,n=e();if((0,eg._)(n,Promise))return n.then(function(e){return e_(e)}).catch(function(e){return eS(e)});return e_(n)}catch(e){return eS(e)}if((0,eg._)(e,Promise))return e.then(function(e){return e_(e)}).catch(function(e){return eS(e)});if(Array.isArray(e)){if(0===e.length)throw Error("At least one observable is required");return(t=V.cP).combine.apply(t,(0,em._)(e)).once().then(function(e){return e_(e)}).catch(function(e){return eS(e)})}return V.cP.from(e).once().then(function(e){return e_(e)}).catch(function(e){return eS(e)})}var eA=n(35992),eT=n(6132),eU={messageEventContents:{messageContentsUpdate:function(e,t){e.content+=t.content},messageContentsSet:function(e,t){e.content=t.content},addSourcesUpdate:function(e,t){var n;(n=e.sources).push.apply(n,(0,em._)(t.sources))},updateProposedFileChange:function(e,t){if((0,eT.VF)(e.extraActions,"proposedFileChanges")){var n=(0,eT.QN)(e.extraActions).changes,r=t.Update,i=t.Replacement;if(null!=r){var o=r.update,s=o.filePath,a=o.content,u=o.changeSummary,l=o.messageContentsOffset,c=o.state,d=n.find(function(e){return e.filePath===s});null!=d&&(d.content+=a,d.state=c,d.messageContentsOffset=l,u&&(d.changeSummary=u))}else if(null!=i){var f=i.replacement,h=f.filePath,p=f.content,v=f.changeSummary,g=f.state,m=f.messageContentsOffset,y=n.find(function(e){return e.filePath===h});null!=y&&(y.content=p,y.state=g,y.messageContentsOffset=m,v&&(y.changeSummary=v))}}},addProposedFileChange:function(e,t){(0,eT.VF)(e.extraActions,"proposedFileChanges")||(e.extraActions=(0,eT.hT)("proposedFileChanges",{changes:[],commitId:"",summary:""})),e.extraActions.proposedFileChanges.commitId=t.commitId,e.extraActions.proposedFileChanges.changes.push(t.change)},addProposedFileChangesMetadata:function(e,t){(0,eT.VF)(e.extraActions,"proposedFileChanges")&&(e.extraActions.proposedFileChanges.summary=t.summary)},addProposedShellCommand:function(e,t){e.assistantProposedActions.shellCommands.push(t.command)},addProposedPackageInstall:function(e,t){e.assistantProposedActions.packageInstalls.push(t.packageInstalls)},addProposedWorkspaceToolNudge:function(e,t){e.assistantProposedActions.workspaceToolNudges.push(t.nudge)},addProposedActionsMetadata:function(e,t){t.commitId&&(e.assistantProposedActions.commitId=t.commitId),t.summary&&(e.assistantProposedActions.summary=t.summary),void 0!==t.didCreateCheckpoint&&(e.assistantProposedActions.didCreateCheckpoint=t.didCreateCheckpoint),t.didCountEditRequest&&(e.assistantProposedActions.didCountEditRequest=!0),(0,eT.VF)(e.extraActions,"proposedFileChanges")&&(e.extraActions.proposedFileChanges.commitId=t.commitId,e.extraActions.proposedFileChanges.summary=t.summary)},addProposedRunConfiguration:function(e,t){e.assistantProposedActions.runConfigurations.push(t.runConfiguration)},addProposedDeploymentConfiguration:function(e,t){e.assistantProposedActions.deploymentConfigurations.push(t.deploymentConfiguration)},addProposedWorkflowConfiguration:function(e,t){e.assistantProposedActions.workflowConfigurations.push(t.workflowConfiguration)},updateAttachedFormStringFieldAppend:function(e,t){eM(e,t,!0)},updateAttachedFormStringFieldSet:function(e,t){eM(e,t,!1)},addRagContext:function(e,t){e.ragContext=t.newContext}},inlineActionEventContents:{messageContentsUpdate:function(e,t){e.content+=t.content},messageContentsSet:function(e,t){e.content=t.content},addSourcesUpdate:function(e,t){var n;(n=e.sources).push.apply(n,(0,em._)(t.sources))}},localShellExecutionEventContents:{localShellExecutionEventSet:function(e,t){return t.contents}},shellSuggestionEventContents:{shellSuggestionContentsUpdate:function(e,t){e.content+=t.content}},byoPromptEventContents:{byoPromptResultUpdate:function(e,t){e.jsonResult=t.jsonResult}},agentTimelineEventContents:{agentTimelineEventSet:function(e,t){return t.contents},agentTimelineEventCreateFileAddContent:function(e,t){var n;(null==(n=e.toolData)?void 0:n.$kind)==="createFileData"&&(e.toolData.createFileData.content+=t.content)},updateRevertStatus:function(e,t){var n;(null==(n=e.toolData)?void 0:n.$kind)==="revertData"&&(e.toolData.revertData.status=t.newStatus)},appendTimelineMessageContentsUpdate:function(e,t){var n;(null==(n=e.toolData)?void 0:n.$kind)==="messageData"&&(e.toolData.messageData.content+=t.content)},appendThoughtContentsUpdate:function(e,t){var n;(null==(n=e.toolData)?void 0:n.$kind)==="thoughts"&&(e.toolData.thoughts.thoughts+=t.content,e.toolData.thoughts.totalTimeTakenMs=t.totalTimeTakenMs)},newThoughtSummaryUpdate:function(e,t){var n;(null==(n=e.toolData)?void 0:n.$kind)==="thoughts"&&(e.toolData.thoughts.summary=t.summary)},appendRedactedThoughtsMarker:function(e,t){var n;(null==(n=e.toolData)?void 0:n.$kind)==="thoughts"&&e.toolData.thoughts.redactedThoughtsMarkers.push(t.marker)}},hostingDebugSummaryEventContents:{hostingDebugSummaryEventSet:function(e,t){return t.contents}},agentAskUserForActionRequest:{agentAskUserForActionRequestSet:function(e,t){return t.request}},integrationTestEventContents:{integrationTestEventContents:function(e,t){e.expectedResponseString+=t.content}},agentPlanEventContents:{addDesignReferenceFile:function(e,t){e.designReferenceFilePaths.push(t.filePath)},updatePlanContents:function(e,t){e.step=t.step}},subagentRunning:{subagentRunningDataUpdate:function(e,t){if(t.state){e.subagentId=t.state.subagentId,e.childSessionId=t.state.childSessionId,e.contents=t.state.contents;var n,r,i=Math.max(null!=(n=t.totalExecutionTimeSeconds)?n:0,null!=(r=t.state.totalExecutionTimeSeconds)?r:0);i>0&&(e.totalExecutionTimeSeconds=i)}}},uiTestingSubagentExecutionEventContents:{uiTestingSubagentExecutionEventUpdate:function(e,t){e.gcsDownloadUrl=t.state.gcsDownloadUrl,e.mimeType=t.state.mimeType,e.narration=t.state.narration,e.miniNarration=t.state.miniNarration}}};function eM(e,t,n){if((null==(r=e.attachedForm)?void 0:r.formType)&&e.attachedForm.formType!==_.B73.ATTACHED_FORM_TYPE_UNKNOWN){var r,i,o=e.attachedForm.fields.find(function(e){return e.path===t.path});o||(o={path:t.path,formType:{$kind:"string",string:{value:""}}},e.attachedForm.fields.push(o)),(null==(i=o.formType)?void 0:i.$kind)==="string"&&(o.formType.string.value=n?o.formType.string.value+t.value:t.value)}}function eN(e,t){var n=new Set,r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var u,l,c=s.value;if(!(!c.operation||n.has(c.id))){n.add(c.id);var d=null==(l=eU[e.$kind])||null==(u=l[c.operation.$kind])?void 0:u.call(l,(0,eT.QN)(e),(0,eT.QN)(c.operation));d&&(e[e.$kind]=d)}}}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}}function eP(e,t){var n=null;if(t.state!==e.state&&(null!=n||(n=Object.assign({},e)),n.state=t.state),(t.error.type!==e.error.type||t.error.message!==e.error.message)&&(null!=n||(n=Object.assign({},e)),n.error=t.error),!t.typedOperations.length||!e.contents.contents)return null!=n?n:e;var r=(0,eA.mq)(e.contents.contents);eN(r,t.typedOperations);var i=(0,eA.vD)(r);return i!==e.contents.contents&&(null!=n||(n=Object.assign({},e)),n.contents={benchmarkParameters:{datasetId:"",instanceId:"",runId:"",replDescription:"",disableSandbox:!1,commandPrefix:[],overrideShellExecuteTimeoutSeconds:0,overrideMaxSteps:0},contents:i}),null!=n?n:e}var eO=n(47888),eR=(0,eA.CN)(eO.X(_.KG$),!0),eD=n(97598),eq=n(74248),eL=n(90067);function eV(e){return{state:e.runState,reason:e.transitionReason.reasons?(0,eT.q4)(e.transitionReason.reasons):null}}var eF=function(){"use strict";function e(t,n){var o=this;(0,q._)(this,e),this.active=new V.V_(function(e){return o.api.currentAgentSession.select(function(e){return!!e&&e.id===o.session.id}).subscribe(e)}),this.state=new V.V_(function(e){var t=null,n=null,s=!1,a=o.api.state.register({snapshot:function(){return t},rollback:function(e){return t=e},notify:function(){return e.next(t)},update:function(e){var n=!1;if("agent-state-modified"===e.kind&&e.session===o.session.id&&(t=e.state,n=!0),e.optimistic||c(),n)return!0}}),u=function(){return(0,r._)(function(){var r,o,u,l;return(0,i.YH)(this,function(i){switch(i.label){case 0:n=null,s=!0,i.label=1;case 1:return i.trys.push([1,,3,4]),[4,this.api.service.getAgentState.rpc({replId:this.api.replId,sessionId:this.session.id})];case 2:if(eC(r=i.sent(),"UNEXPECTED_DISCONNECT"))return[2];if(!r.ok)return[2,this.api.error(r,e)];return(o=eV(r.payload)).state!==(null==t?void 0:t.state)&&(null==(u=(l=this.api.logger).warn)||u.call(l,"state transition was manually corrected"),t=o,a.commit(),e.next(t)),[3,4];case 3:return s=!1,c(),[7];case 4:return[2]}})}).call(o)},l=function(){null!==n&&(clearTimeout(n),n=null)},c=function(){l(),s||(null==t?void 0:t.state)!==_.g32.AGENT_STATE_RUNNING||(n=setTimeout(u,1e4))},d=o.api.connected.lift(e,function(n){return(0,r._)(function(){var r,o;return(0,i.YH)(this,function(i){switch(i.label){case 0:return[4,ek(this.active)];case 1:if(r=i.sent(),n.aborted||eC(r,"UNEXPECTED_DISCONNECT"))return[2];if(!r.ok)return[2,this.api.error(r,e)];if(!r.payload)return t=null,a.commit(),e.next(t),[2];return[4,this.api.service.getAgentState.rpc({replId:this.api.replId,sessionId:this.session.id})];case 2:if(o=i.sent(),n.aborted||eC(o,"UNEXPECTED_DISCONNECT"))return[2];if(!o.ok)return[2,this.api.error(o,e)];return t=eV(o.payload),a.commit(),e.next(t),c(),[2]}})}).call(o)});return function(){l(),a.unsubscribe(),d.unsubscribe()}}),this.api=t,this.session=n}return e.prototype.update=function(e){return(0,r._)(function(){var t,n,r,o,s,a;return(0,i.YH)(this,function(i){switch(i.label){case 0:return[4,ek(this.state)];case 1:if(!(t=i.sent()).ok)return[2,this.api.error(t)];if(!t.payload)return[2,this.api.error("session is not an agent session")];if(n=(0,eL.vt)(t.payload,function(t){t.state=e}),t.payload===n)return[2,e_(t.payload)];return o=(r=(0,b._)(this.api.state.stage({kind:"agent-state-modified",session:this.session.id,state:{state:e,reason:null}}),2))[0],s=r[1],[4,this.api.service.updateAgentState.rpc({replId:this.api.replId,sessionId:this.session.id,runState:e,transitionReason:{}})];case 2:if(!(a=i.sent()).ok)return s(),[2,this.api.error(a)];if(a.payload.runState!==e)return s(),[2,e_(eV(a.payload))];return this.api.hooks.trigger("client-updated-agent-state",{session:this.session,prev:t.payload,next:n}),o(),[2,e_(n)]}})}).call(this)},e}(),eZ=function(){"use strict";function e(t){if((0,q._)(this,e),this.forward=new Map,this.reverse=new Map,t){var n=!0,r=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=(0,b._)(o.value,2),u=a[0],l=a[1];this.set(u,l)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}}var t=e.prototype;return t.keys=function(){return this.forward.keys()},t.values=function(){return this.reverse.keys()},t.entries=function(){return this.forward.entries()},t.hasKey=function(e){return this.forward.has(e)},t.hasValue=function(e){return this.reverse.has(e)},t.getValue=function(e){var t=this.forward.get(e);if(void 0===t)throw Error("key does not exist");return t},t.getKey=function(e){var t=this.reverse.get(e);if(void 0===t)throw Error("value does not exist");return t},t.set=function(e,t){var n=this.reverse.get(t),r=this.forward.get(e);this.forward.set(e,t),this.reverse.set(t,e),void 0!==n&&n!==e&&this.forward.delete(n),void 0!==r&&r!==t&&this.reverse.delete(r)},t.deleteKey=function(e){var t=this.forward.get(e);void 0!==t&&(this.forward.delete(e),this.reverse.delete(t))},t.deleteValue=function(e){var t=this.reverse.get(e);void 0!==t&&(this.reverse.delete(e),this.forward.delete(t))},t.clear=function(){this.forward.clear(),this.reverse.clear()},t[Symbol.iterator]=function(){return this.forward.entries()},(0,L._)(e,[{key:"size",get:function(){return this.forward.size}}]),e}(),eY=function(){"use strict";function e(t){if((0,q._)(this,e),this.map=new eZ,this.offset=0,this.length=0,t){for(var n=0;n<t.length;n++)this.map.set(n,t[n]);this.length=t.length}}var t=e.prototype;return t.peek=function(e){return -1===e?this.first:this.last},t.has=function(e){return"number"==typeof e?this.map.hasKey(e-this.offset):this.map.hasValue(e)},t.index=function(e){return this.map.getKey(e)-this.offset},t.id=function(e){return this.map.getValue(e+this.offset)},t.dir=function(e,t){var n=this.map.getKey(e),r=this.map.getKey(t);return n<r?1:n>r?-1:0},t.append=function(e){for(var t=0;t<e.length;t++)this.map.set(this.map.size+this.offset,e[t]);this.length=this.map.size},t.prepend=function(e){for(var t=e.length-1;t>=0;t--)this.offset--,this.map.set(0+this.offset,e[t]);this.length=this.map.size},t.pop=function(){if(!this.last)return null;var e=this.last;return this.map.deleteValue(e),this.length=this.map.size,this.offset=this.map.size?this.offset:0,e},t.shift=function(){if(!this.first)return null;var e=this.first;return this.map.deleteValue(e),this.length=this.map.size,this.offset=this.map.size?this.offset+1:0,e},t.parent=function(e){var t=this.map.getKey(e);return t!==0+this.offset?this.map.getValue(t-1):null},t.child=function(e){var t=this.map.getKey(e);return t!==this.map.size-1+this.offset?this.map.getValue(t+1):null},t.adjacent=function(e,t){return -1===t?this.parent(e):this.child(e)},t.slice=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length-1;if(0===this.length)return[];var r=0+this.offset,i=this.map.size-1+this.offset,o="number"==typeof t?Math.min(Math.max(t+this.offset,r),i):this.map.getKey(t),s="number"==typeof n?Math.max(Math.min(n+this.offset,i),r):this.map.getKey(n),a=o>s;a&&(o=(e=[s,o])[0],s=e[1]);for(var u=[],l=o;l<=s;l++)u.push(this.map.getValue(l));return a?u.reverse():u},t.patch=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.first,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.last;if(t&&!e.has(t)||n&&!e.has(n))throw Error("invalid merge");if(!t||!n){if(this.map.size){var r=Array.from(this.map.values());return this.clear(),{removed:r,added:[]}}return null}var i=e.slice(t,n),o=new Set(this.map.values()),s=new Set(o),a=new Set(i),u=!0,l=!1,c=void 0;try{for(var d,f=i[Symbol.iterator]();!(u=(d=f.next()).done);u=!0){var h=d.value;s.delete(h)}}catch(e){l=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(l)throw c}}var p=!0,v=!1,g=void 0;try{for(var m,y=o[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var b=m.value;a.delete(b)}}catch(e){v=!0,g=e}finally{try{p||null==y.return||y.return()}finally{if(v)throw g}}return s.size||a.size?(this.clear(),this.append(i),{removed:Array.from(s),added:Array.from(a)}):null},t.clear=function(){this.map.clear(),this.offset=0,this.length=0},t.clone=function(){var t=new e;return t.map=new eZ(this.map),t.offset=this.offset,t.length=this.length,t},(0,L._)(e,[{key:"first",get:function(){return this.length?this.map.getValue(0+this.offset):null}},{key:"last",get:function(){return this.length?this.map.getValue(this.map.size-1+this.offset):null}}]),e}(),eH=function(){"use strict";function e(t){(0,q._)(this,e),this.ids=new eY,this.events=new Map,this.incomplete=new Set,this.length=0,t&&this.append(t)}var t=e.prototype;return t.set=function(e){this.events.set(e.id,e),e.state!==_.qOk.COMPLETE?this.incomplete.add(e.id):this.incomplete.delete(e.id)},t.delete=function(e){this.events.delete(e),this.incomplete.delete(e)},t.peek=function(e){return -1===e?this.first:this.last},t.index=function(e){return this.ids.index(e)},t.id=function(e){return this.ids.id(e)},t.dir=function(e,t){return this.ids.dir(e,t)},t.has=function(e){return this.ids.has(e)},t.get=function(e){e="number"==typeof e?this.id(e):e;var t=this.events.get(e);if(!t)throw Error("event does not exist");return t},t.append=function(e){this.ids.append(e.map(function(e){return e.id})),this.length=this.ids.length;var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var s=i.value;this.set(s)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}},t.prepend=function(e){this.ids.prepend(e.map(function(e){return e.id})),this.length=this.ids.length;var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var s=i.value;this.set(s)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}},t.pop=function(){var e,t=this.ids.pop(),n=t&&null!=(e=this.events.get(t))?e:null;if(t&&!n)throw Error("Unexpected null for popped event");return t&&n&&(this.delete(t),this.length--),n},t.shift=function(){var e,t=this.ids.shift(),n=t&&null!=(e=this.events.get(t))?e:null;if(t&&!n)throw Error("Unexpected null for shifted event");return t&&n&&(this.delete(t),this.length--),n},t.parent=function(e){var t=this.index(e);return t>0?this.get(t-1):null},t.child=function(e){var t=this.index(e);return t<this.length-1?this.get(t+1):null},t.adjacent=function(e,t){return -1===t?this.parent(e):this.child(e)},t.slice=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length-1;return this.ids.slice(t,n).map(function(t){return e.get(t)})},t.patch=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.ids.first,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ids.last,r=this.ids.patch(e.ids,t,n);this.length=this.ids.length;var i=!this.events.size,o=null,s=null;if(r){null!=o||(o={removed:[],added:[],changed:[]});var a=!0,u=!1,l=void 0;try{for(var c,d=r.removed[Symbol.iterator]();!(a=(c=d.next()).done);a=!0){var f=c.value;o.removed.push(this.get(f)),this.delete(f)}}catch(e){u=!0,l=e}finally{try{a||null==d.return||d.return()}finally{if(u)throw l}}var h=!0,p=!1,v=void 0;try{for(var g,m=r.added[Symbol.iterator]();!(h=(g=m.next()).done);h=!0){var y=g.value,b=e.get(y);o.added.push(b),this.set(b),i||(null!=s||(s=new Set),s.add(y))}}catch(e){p=!0,v=e}finally{try{h||null==m.return||m.return()}finally{if(p)throw v}}}if(i)return o;for(var E=new Set(this.incomplete),w=this.length-1;w>=0;w--){var I=this.ids.id(w);if(E.delete(I),null==s||!s.has(I)){var x=e.events.get(I);if(x&&x!==this.events.get(I)){null!=o||(o={removed:[],added:[],changed:[]}),o.changed.push(x),this.set(x);continue}if(!E.size&&x&&x.state===_.qOk.COMPLETE)break}}return o},t.adopt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.first,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.last;if(!n||!r){if(!this.length)return null;var i=Array.from(this.events.values());return this.clear(),{removed:i,added:[],changed:[],missing:[]}}if(!(null==t?void 0:t.size)&&!this.length)return{removed:[],added:[],changed:[],missing:e.slice(n,r)};for(var o=[],s=[],a=null,u=null,l=e.index(n),c=e.index(r),d=c;d>=l;d--){var f=e.id(d);if(!(null==t?void 0:t.has(f))&&!this.events.has(f)){o.push(f),u&&!a&&(a=e.child(f));continue}if(null!=u||(u=f),a){o.push(f);continue}if((null==t?void 0:t.has(f))&&this.events.has(f)){var h=null==t?void 0:t.get(f);h&&this.events.get(f)!==h&&(s.push(h),this.set(h))}}if(!u&&!a){if(!this.length&&!o.length)return null;var p=Array.from(this.events.values());return this.clear(),{removed:p,added:[],changed:[],missing:o}}a||(a=n),u||(u=r);var v=this.ids.patch(e,a,u);if(this.length=this.ids.length,!v)return o.length||s.length?{removed:[],added:[],changed:s,missing:o}:null;var g=[],m=[],y=!0,b=!1,E=void 0;try{for(var w,I=v.removed[Symbol.iterator]();!(y=(w=I.next()).done);y=!0){var x=w.value;g.push(this.get(x)),this.delete(x)}}catch(e){b=!0,E=e}finally{try{y||null==I.return||I.return()}finally{if(b)throw E}}var _=!0,S=!1,C=void 0;try{for(var k,A=v.added[Symbol.iterator]();!(_=(k=A.next()).done);_=!0){var T=k.value,U=null==t?void 0:t.get(T);if(!U)throw Error("unexpected null");m.push(U),this.set(U)}}catch(e){S=!0,C=e}finally{try{_||null==A.return||A.return()}finally{if(S)throw C}}return{removed:g,added:m,changed:s,missing:o}},t.clear=function(){this.ids.clear(),this.events.clear(),this.incomplete.clear(),this.length=0},t.clone=function(){var t=new e;return t.ids=this.ids.clone(),t.events=new Map(this.events),t.incomplete=new Set(this.incomplete),t},(0,L._)(e,[{key:"first",get:function(){return this.ids.first?this.get(this.ids.first):null}},{key:"last",get:function(){return this.ids.last?this.get(this.ids.last):null}}]),e}(),ej=n(59254),ez=function(){"use strict";function e(t){var n=t.api,r=t.session,i=t.direction,o=t.initial,s=t.transducer;if((0,q._)(this,e),this.api=n,this.session=r,this.direction=i,this.initial=o,this.transducer=s,!(0,eL.a6)(o))throw Error("state must be draftable")}var t=e.prototype;return t.compute=function(e,t,n){var r=(0,b._)((0,eL.vt)([t,void 0]),2),i=r[0],o=r[1];i[1]=this.transducer(e,i[0]);var s=o();return s[0]!==t&&n&&(0,ej.j)(s[0],n)&&(s[0]=n),s},t.step=function(e,t,n){var r=n.id,i=-this.direction,o=e.peek(i);o&&(o=r===o||n===o?o:e.adjacent(r,i)),o&&(o="string"!=typeof o?o.id:o);var s=r===o?this.initial:o&&t.get(o),a=t.get(r);if(!s)throw Error("starting state not found");var u=(0,b._)(this.compute(n,s,a),2),l=u[0],c=u[1],d=l!==s||!a||l!==a;return d&&t.set(r,l),{ret:c,recomputing:d}},t.indexed=function(e,t){for(var n=this,r=Array(t.length),i=0;i<t.length;i++){var o=t[i],s="string"==typeof o?o:o.id;r[i]=e.index(s)}return r.sort(function(e,t){return(e-t)*n.direction}),r},e}(),eX=function(e){return e[e.PEEK=10]="PEEK",e[e.SCAN=150]="SCAN",e[e.TRAVERSE=500]="TRAVERSE",e}(eX||{}),eW=function(e){"use strict";function t(e,n,r){var i,o;return(0,q._)(this,t),(i=(0,ep._)(this,t,[{api:e,session:n,direction:"forward"===r.direction?1:-1,initial:r.state,transducer:r.reducer}])).result=new V.V_(function(e){var t=new eY,n=new Set,r=new Map,o=null,s=null,a=10,u=function(){if(!n.size)return!1;for(var e=i.indexed(t,Array.from(n)),o=e[0],u=!1;o>=0&&o<t.length;){var l=t.id(o),c=o===e[0];if(s&&s!==l&&t.dir(l,s)!==i.direction)break;var d=i.api.materializer.get(l);if(!d){if(n.add(l),u)switch(a){case 10:a=150;break;case 150:a=500}var f=Math.max(o+(a-1)*i.direction,0);c&&e.length>1&&(f=1===i.direction?Math.min(f,e[e.length-1]):Math.max(f,e[e.length-1]));var h=t.slice(o,f);return i.api.materializer.enqueue(i.session.id,h),!1}c&&(e.shift(),n.delete(l));var p=i.step(t,r,d),v=p.ret,g=p.recomputing;if(u||(u=c||g||!1===v),!1===v){s=d.id;break}if(d.id===s&&(s=null),g||e.length){o=g?o+i.direction:e[0];continue}break}return n.size||(a=10),u},l=function(){var n;if(t.length){var a=null!=s?s:t.peek(i.direction);n=a?r.get(a):void 0}else n=i.initial;if(void 0===n)throw Error("unexpected undefined");o!==n&&(o=n,e.next(i.map(n)))},c=i.api.state.register({snapshot:function(){return{ids:t.clone(),pending:new Set(n),states:new Map(r),stop:s,batchSize:a}},rollback:function(e){t=e.ids,n=e.pending,r=e.states,s=e.stop,a=e.batchSize},notify:function(){return l()},update:function(e){if("event-modified"===e.kind&&t.has(e.event.id))return n.add(e.event.id),u()}}),d=i.api.materializer.events.lift(e,function(e){e.filter(function(e){var t=e.id;return n.has(t)}).length&&u()&&l()}),f=i.session.ids.lift(e,function(e){var i=t.patch(e);if(i){var o=!0,a=!1,c=void 0;try{for(var d,f=i.removed[Symbol.iterator]();!(o=(d=f.next()).done);o=!0){var h=d.value;r.delete(h),n.delete(h),h===s&&(s=null)}}catch(e){a=!0,c=e}finally{try{o||null==f.return||f.return()}finally{if(a)throw c}}var p=!0,v=!1,g=void 0;try{for(var m,y=i.added[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var b=m.value;n.add(b)}}catch(e){v=!0,g=e}finally{try{p||null==y.return||y.return()}finally{if(v)throw g}}u()&&l()}});return function(){c.unsubscribe(),d.unsubscribe(),f.unsubscribe()}}),i.subscribe=i.result.subscribe.bind(i.result),i.map=null!=(o=r.map)?o:function(e){return e},i}return(0,ev._)(t,e),t.prototype[Symbol.observable]=function(){return this.result},t}(ez),eB=function(e){"use strict";function t(e,n,r,i){var o,s;return(0,q._)(this,t),(o=(0,ep._)(this,t,[{api:e,session:n,direction:"forward"===r.direction?1:-1,initial:r.state,transducer:r.reducer}])).exhaustive=new V.V_(function(e){return V.cP.combine(o.session.ids.select(function(e){return e.length}),o.window.size).select(function(e){var t=(0,b._)(e,2);return t[0]<=t[1]}).subscribe(e)}),o.result=new V.V_(function(e){var t=new eH,n=null,r=null,i=new Map,s=new Set,a=function(){if(s.size)for(var a=o.indexed(t,Array.from(s)),u=a[0];u>=0&&u<t.length;){var l=t.get(u),c=l.id,d=u===a[0];if(r&&r!==c&&t.dir(c,r)!==o.direction)break;d&&(a.shift(),s.delete(l.id));var f=o.step(t,i,l),h=f.ret,p=f.recomputing;if(!1===h){r=l.id;break}if(c===r&&(r=null),p||a.length){u=p?u+o.direction:a[0];continue}break}if(t.length){var v,g,m=null!=r?r:null==(g=t.peek(o.direction))?void 0:g.id;v=m?i.get(m):void 0}else v=o.initial;if(void 0===v)throw Error("unexpected undefined");n!==v&&(n=v,e.next(o.map(v)))},u=o.window.events.lift(e,function(e){var n=t.patch(e);if(n){var o=!0,u=!1,l=void 0;try{for(var c,d=n.removed[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var f=c.value;i.delete(f.id),s.delete(f.id),f.id===r&&(r=null)}}catch(e){u=!0,l=e}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}var h=!0,p=!1,v=void 0;try{for(var g,m=n.added[Symbol.iterator]();!(h=(g=m.next()).done);h=!0){var y=g.value;s.add(y.id)}}catch(e){p=!0,v=e}finally{try{h||null==m.return||m.return()}finally{if(p)throw v}}var b=!0,E=!1,w=void 0;try{for(var I,x=n.changed[Symbol.iterator]();!(b=(I=x.next()).done);b=!0){var _=I.value;s.add(_.id)}}catch(e){E=!0,w=e}finally{try{b||null==x.return||x.return()}finally{if(E)throw w}}a()}});return function(){u.unsubscribe()}}),o.subscribe=o.result.subscribe.bind(o.result),o.window=o.session.window(i),o.map=null!=(s=r.map)?s:function(e){return e},o}return(0,ev._)(t,e),t.prototype[Symbol.observable]=function(){return this.result},(0,L._)(t,[{key:"size",get:function(){return this.window.size}}]),t}(ez),e$=function(e){"use strict";function t(e,n,r,i){var o;return(0,q._)(this,t),(o=(0,ep._)(this,t,[{api:e,session:n,direction:"forward"===r.direction?1:-1,initial:r.state,transducer:r.transformer}])).exhaustive=new V.V_(function(e){return V.cP.combine(o.session.ids.select(function(e){return e.length}),o.window.size).select(function(e){var t=(0,b._)(e,2);return t[0]<=t[1]}).subscribe(e)}),o.state=new V.V_(function(e){var t=new eH,n=new Map,r=new Map;return o.window.events.lift(e,function(i){var s=t.patch(i);if(s){var a=!1,u=!1;if(!t.length){a||(a=!!(n.size||r.size)),u||(u=a),a&&(n.clear(),r.clear(),e.next({events:t,transformed:r,scaled:a}));return}var l=!0,c=!1,d=void 0;try{for(var f,h=s.removed[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){var p=f.value;a||(a=r.has(p.id)),u||(u=a),n.delete(p.id),r.delete(p.id)}}catch(e){c=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(c)throw d}}if(s.added.length||s.changed.length)for(var v=o.indexed(t,s.added.concat(s.changed)),g=v[0];g>=0&&g<t.length;){var m=g===v[0];m&&v.shift();var y=t.get(g),b=r.get(y.id),E=o.step(t,n,y),w=E.ret,I=E.recomputing;if((I||m)&&(void 0!==w?r.set(y.id,w):void 0!==b&&r.delete(y.id)),a||(a=!!b!=!!w),u||(u=I||m||a),I||v.length){g=I?g+o.direction:v[0];continue}break}(a||u)&&e.next({events:t,transformed:r,scaled:a})}})}),o.tuples=new V.V_(function(e){var t=new Map,n=!0;return o.state.lift(e,function(r){if(r.scaled||n){n=!1;for(var i=[],s=0;s<r.events.length;s++){var a=r.events.get(s);if(a&&r.transformed.has(a.id)){var u,l=null!=(u=t.get(a.id))?u:o.create(a.id);t.set(a.id,l),i.push([a.id,l])}}e.next(i)}})}),o.flat=new V.V_(function(e){return o.state.lift(e,function(t){for(var n=[],r=0;r<t.events.length;r++){var i=t.events.get(r),o=i&&t.transformed.get(i.id);void 0!==o&&n.push(o)}e.next(n)})}),o.mapped=o.tuples.map(function(e){return new Map(e)}),o.subscribe=o.tuples.subscribe.bind(o.tuples),o.window=o.session.window(i),o}(0,ev._)(t,e);var n=t.prototype;return n.create=function(e){var t=this;return new V.V_(function(n){var r=V.NV;return t.state.lift(n,function(t){var i=t.transformed.get(e);if(void 0===i)return n.complete();r!==i&&(r=i,n.next(i))})})},n.map=function(e){var t=this;return new V.V_(function(n){var r=new Map,i=V.NV;return t.state.lift(n,function(o){for(var s=[],a=0;a<o.events.length;a++){var u,l=null==(u=o.events.get(a))?void 0:u.id,c=l&&o.transformed.get(l);if(l&&c){var d=r.get(l);d||(d=t.create(l),r.set(l,d)),s.push({id:l,value:c,observable:d})}}var f=e(s);(0,ej.j)(f,i)||(i=f,n.next(f))})})},n.chunked=function(e){var t=this;return new V.V_(function(n){var r=null;return V.cP.combine(t.mapped,t.state).lift(n,function(t){for(var i=(0,b._)(t,2),o=i[0],s=i[1],a=[],u=function(e){if(e<0||e>=s.events.length)return null;var t=s.events.get(e),n=s.transformed.get(t.id);return o.has(t.id)&&n?{event:t,transformed:n}:null},l=[],c=null,d=0;d<s.events.length;d++){var f=u(d);if(f){for(var h=null,p=d+1;p<s.events.length;p++)if(o.has(s.events.get(p).id)){h=u(p);break}var v=e(f,c,h);switch(c=f,v){case"continue":l.push(f.event.id);break;case"break":l.length&&(a.push(l),l=[]),l.push(f.event.id);break;case"isolate":l.length&&(a.push(l),l=[]),a.push([f.event.id])}}}l.length&&a.push(l),(0,ej.j)(a,r)||(r=a,n.next(a.map(function(e){return e.map(function(e){return[e,o.get(e)]})})))})})},n[Symbol.observable]=function(){return this.tuples},(0,L._)(t,[{key:"size",get:function(){return this.window.size}}]),t}(ez),eG=function(){"use strict";function e(){(0,q._)(this,e),this.nodes=new Set,this.up=new Map,this.down=new Map,this.leafs=new Map}var t=e.prototype;return t.ids=function(){return new Set(this.nodes.keys())},t.has=function(e){return this.nodes.has(e)},t.parent=function(e){var t;return null!=(t=this.up.get(e))?t:null},t.children=function(e){var t;return null!=(t=this.down.get(e))?t:null},t.siblings=function(e){var t=this.parent(e);return t?this.children(t):null},t.hierarchy=function(e){for(var t=[e],n=e;this.up.has(n);)t.unshift(n=this.up.get(n));return t},t.isLeaf=function(e){return this.leafs.has(e)},t.latest=function(){var e=null,t=-1,n=!0,r=!1,i=void 0;try{for(var o,s=this.leafs[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=(0,b._)(o.value,2),u=a[0],l=a[1];l>t&&(e=u,t=l)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return e},t.walk=function(e,t){if(!this.nodes.has(e))throw Error("node not in graph");if(!1!==t(e,this.isLeaf(e))){for(var n=this.children(e);(null==n?void 0:n.size)===1;){if(!1===t(e=n.values().next().value,this.isLeaf(e)))return;n=this.children(e)}if(null==n?void 0:n.size){var r=!0,i=!1,o=void 0;try{for(var s,a=n[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var u=s.value;this.walk(u,t)}}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}}}},t.append=function(e){var t=this.nodes.size,n=new Set,r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var u=s.value;if(!n.has(u.id)&&this.nodes.has(u.id)){var l=this.up.get(u.id);if(l&&l!==u.parent)throw Error("parent mismatch");continue}if(this.nodes.add(u.id),n.add(u.id),this.down.has(u.id)||this.leafs.set(u.id,u.priority),u.parent){this.leafs.delete(u.parent);var c=this.down.get(u.parent);c||(c=new Set,this.down.set(u.parent,c),this.nodes.add(u.parent),n.add(u.parent)),this.up.set(u.id,u.parent),c.add(u.id)}}}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return this.nodes.size!==t},t.clone=function(){var t=new e;t.nodes=new Set(this.nodes),t.up=new Map(this.up),t.leafs=new Map(this.leafs);var n=!0,r=!1,i=void 0;try{for(var o,s=this.down[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=(0,b._)(o.value,2),u=a[0],l=a[1];t.down.set(u,new Set(l))}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t},(0,L._)(e,[{key:"size",get:function(){return this.nodes.size}}]),e}(),eK=function(){"use strict";function e(){(0,q._)(this,e),this.queue=[],this.locked=!1}var t=e.prototype;return t.acquire=function(){var e=this;return this.locked?new Promise(function(t){e.queue.push(t)}):(this.locked=!0,Promise.resolve())},t.release=function(){if(this.queue.length>0){var e=this.queue.shift();null==e||e()}else this.locked=!1},t.run=function(e){return(0,r._)(function(){return(0,i.YH)(this,function(t){switch(t.label){case 0:return[4,this.acquire()];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,,4,5]),[4,e()];case 3:return[2,t.sent()];case 4:return this.release(),[7];case 5:return[2]}})}).call(this)},t.clear=function(){this.queue.length=0,this.locked=!1},e}(),eJ=n(83846),eQ={messageEventContents:{$kind:"messageEventContext",messageEventContext:eO.X(_.cv9)},inlineActionEventContents:{$kind:"inlineActionEventContext",inlineActionEventContext:eO.X(_.MgG)},shellSuggestionEventContents:{$kind:"shellSuggestionEventContext",shellSuggestionEventContext:eO.X(_.z1c)},sessionCreationEventContents:{$kind:"sessionCreationEventContext",sessionCreationEventContext:eO.X(_.ytV)},localShellExecutionEventContents:{$kind:"localShellExecutionEventContext",localShellExecutionEventContext:eO.X(_.uuO)},translateEventContents:{$kind:"translateEventContext",translateEventContext:eO.X(_.FEc)},byoPromptEventContents:{$kind:"byoPromptEventContext",byoPromptEventContext:eO.X(_.RRw)},agentPlanEventContents:{$kind:"agentPlanEventContext",agentPlanEventContext:eO.X(_.pcR)},agentTimelineEventContents:{$kind:"agentTimelineEventContext",agentTimelineEventContext:eO.X(_.p6e)},iterativeAgentEventContents:{$kind:"iterativeAgentEventContext",iterativeAgentEventContext:eO.X(_.$ZM)}},e0=!0,e1=!1,e2=void 0;try{for(var e4,e3=Object.values(eQ)[Symbol.iterator]();!(e0=(e4=e3.next()).done);e0=!0){var e5=e4.value;(0,eA.CN)(e5,!0)}}catch(e){e1=!0,e2=e}finally{try{e0||null==e3.return||e3.return()}finally{if(e1)throw e2}}var e7=(0,eA.CN)(eO.X(_.g$I),!0),e6=function(){"use strict";function e(){var t=this;(0,q._)(this,e),this.stockpile=new Map,this.registry=new FinalizationRegistry(function(e){t.stockpile.delete(e)}),this.listeners=new V.do}var t=e.prototype;return t.has=function(e){var t;return this.stockpile.has(e)&&(null==(t=this.stockpile.get(e))?void 0:t.deref())!==void 0},t.get=function(e){var t,n;return null!=(n=null==(t=this.stockpile.get(e))?void 0:t.deref())?n:null},t.add=function(e){var t,n=null==(t=this.stockpile.get(e.id))?void 0:t.deref();return n===e?n:(n&&this.registry.unregister(n),this.stockpile.set(e.id,new WeakRef(e)),this.registry.register(e,e.id,e),this.listeners.notify(e),e)},t.emplace=function(e){var t,n=null==(t=this.stockpile.get(e.id))?void 0:t.deref();return n||(this.stockpile.set(e.id,new WeakRef(e)),this.registry.register(e,e.id,e),this.listeners.notify(e),e)},t.delete=function(e){var t=this.stockpile.get(e);if(t){this.stockpile.delete(e);var n=t.deref();n&&this.registry.unregister(n)}},t.store=function(e){var t=this;null!=e||(e=[]),"string"==typeof e&&(e=[e]);var n=new Set,r=new Map,o=!0,s=!1,a=void 0;try{for(var u,l=e[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;n.add(c),r.set(c,this.get(c))}}catch(e){s=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw a}}var d=!1,f=this.listeners.add(function(e){n.has(e.id)&&r.set(e.id,e)});return(0,eJ._)({has:function(e){return n.has(e)},get:function(e){var t;return null!=(t=r.get(e))?t:null},track:function(e){if(d)throw Error("Store has been released");e=Array.isArray(e)?e:[e];var i=!0,o=!1,s=void 0;try{for(var a,u=e[Symbol.iterator]();!(i=(a=u.next()).done);i=!0){var l=a.value;n.add(l),r.set(l,t.get(l))}}catch(e){o=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw s}}},untrack:function(e){if(d)throw Error("Store has been released");e=Array.isArray(e)?e:[e];var t=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(t=(s=a.next()).done);t=!0){var u=s.value;u="string"==typeof u?u:u.id,n.delete(u),r.delete(u)}}catch(e){i=!0,o=e}finally{try{t||null==a.return||a.return()}finally{if(i)throw o}}},release:function(){d||(d=!0,f(),n.clear(),r.clear())}},Symbol.iterator,function(){var e,t,o,s,a,u,l,c;return(0,i.YH)(this,function(i){switch(i.label){case 0:e=!0,t=!1,o=void 0,i.label=1;case 1:i.trys.push([1,6,7,8]),s=n[Symbol.iterator](),i.label=2;case 2:if(e=(a=s.next()).done)return[3,5];if(u=a.value,!(l=r.get(u)))return[3,4];return[4,l];case 3:i.sent(),i.label=4;case 4:return e=!0,[3,2];case 5:return[3,8];case 6:return c=i.sent(),t=!0,o=c,[3,8];case 7:try{e||null==s.return||s.return()}finally{if(t)throw o}return[7];case 8:return[2]}})})},t.clear=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.stockpile.keys()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;this.delete(o)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},(0,L._)(e,[{key:"empty",get:function(){return 0===this.stockpile.size}}]),e}(),e8={events:new(function(e){"use strict";function t(){return(0,q._)(this,t),(0,ep._)(this,t,arguments)}(0,ev._)(t,e);var n=t.prototype;return n.invalidate=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.stockpile.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value.deref();o&&o.state!==_.qOk.COMPLETE&&this.delete(o.id)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},n.create=function(e){var t,n,r;return this.add(((n=Object.assign({},e7)).id=e.eventId,n.parentEventId=e.parentEventId,n.sessionId=e.sessionId,n.state=e.state,n.error=e.error,n.sender=e.sender,n.contents=e.contents,n.created=new Date,(r=null==(t=e.contents.contents)?void 0:t.$kind)&&eQ[r]&&(n.context={metadata:eQ[r]}),n))},n.update=function(e){var t=this.get(e.eventId);return t?this.add(eP(t,e)):null},t}(e6)),sessions:new(function(e){"use strict";function t(){return(0,q._)(this,t),(0,ep._)(this,t,arguments)}(0,ev._)(t,e);var n=t.prototype;return n.invalidate=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.stockpile.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value.deref();o&&!o.archived&&this.delete(o.id)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},n.create=function(e){return this.add((0,eq.Ap)(e))},n.update=function(e){var t=this.get(e.sessionId);return t?this.add((0,eq.Jr)(t,e)):null},t}(e6))},e9=n(86619),te=function(){"use strict";function e(t,n,o,s,a){var u=this;(0,q._)(this,e),this.event=new e9.V(function(e){var t=e8.events.store(u.eventId),n=u.api.materializer.get(u.eventId);n&&e.next(n);var o=u.api.state.register({snapshot:function(){return n},rollback:function(e){return n=e},notify:function(){n&&e.next(n)},update:function(e){if("event-modified"===e.kind&&e.event.id===u.eventId)return n=e.event,!0}}),s=u.api.connected.lift(e,function(t){return(0,r._)(function(){var r,s,a;return(0,i.YH)(this,function(i){switch(i.label){case 0:return(r=e8.events.get(this.eventId))&&n!==r&&(n=r,o.commit(),e.next(n)),[4,ek(this.api.materializer.materialize(this.parent.id,[this.eventId]))];case 1:if(s=i.sent(),t.aborted||eC(s,"UNEXPECTED_DISCONNECT"))return[2];if(!s.ok)return[2,this.api.error(s,e)];return a=e8.events.emplace(s.payload[0]),n!==a&&(n=a,o.commit(),e.next(n)),[2]}})}).call(u)});return function(){t.release(),o.unsubscribe(),s.unsubscribe()}}),this.data=this.event.select(function(e){return e.contents.contents.subagentRunning}),this.kind=this.data.filter(function(e){return void 0!==e.contents}).select(function(e){return e.contents.$kind}),this.running=this.event.select(function(e){return e.state!==_.qOk.COMPLETE}),this.totalExecutionTimeSeconds=this.data.select(function(e){return e.totalExecutionTimeSeconds}),this.api=t,this.id=n,this.eventId=o,this.parent=s,this.session=a}var t=e.prototype;return t.contents=function(e){return this.data.filter(function(t){var n;return(null==(n=t.contents)?void 0:n.$kind)===e}).select(function(e){return(0,eT.QN)(e.contents)})},t.abort=function(){return(0,r._)(function(){var e;return(0,i.YH)(this,function(t){switch(t.label){case 0:return[4,this.api.service.abortSubagent.rpc({replId:this.api.replId,sessionId:this.parent.id,subagentId:this.id})];case 1:if(!(e=t.sent()).ok)return[2,this.api.error(e)];return[2,e_(null)]}})}).call(this)},e.create=function(t,n,r,i,o){var s=this.subagents.get(t);s||(s=new Map,this.subagents.set(t,s));var a=s.get(n),u=null==a?void 0:a.deref();if(a&&u||(a=new WeakRef(u=new e(t,n,r,i,o)),s.set(n,a)),u.eventId!==r)throw Error("Subagent event ID mismatch");if(u.parent!==i)throw Error("Subagent parent mismatch");if(u.session!==o)throw Error("Subagent session mismatch");return u},e}();te.subagents=new WeakMap;var tt=function(){"use strict";function e(t,n,r){var i=this;(0,q._)(this,e),this.events=new V.V_(function(e){var t=new eY,n=new eH,r=function(e){var r=(null==e?void 0:e.length)?new Map(e.map(function(e){return[e.id,e]})):null,o=n.adopt(t,r);return!!o&&(o.missing.length&&i.api.materializer.enqueue(i.session.id,o.missing),!0)},o=i.api.state.register({snapshot:function(){return{ids:t.clone(),events:n.clone()}},rollback:function(e){t=e.ids,n=e.events},notify:function(){return e.next(n)},update:function(e){if("event-modified"===e.kind&&t.has(e.event.id))return r([e.event])}}),s=i.api.materializer.events.lift(e,function(i){var o=i.filter(function(e){var n=e.id;return t.has(n)});o.length&&r(o)&&e.next(n)}),a=V.cP.combine(i.session.ids,i.size).lift(e,function(o){var s=(0,b._)(o,2),a=s[0],u=s[1],l=a.length?a.id(Math.max(0,a.length-u)):null,c=t.patch(a,l);c&&r(c.added.map(function(e){return i.api.materializer.get(e)}).filter(function(e){return null!==e}))&&e.next(n)});return function(){o.unsubscribe(),s.unsubscribe(),a.unsubscribe()}}),this.subscribe=this.events.subscribe.bind(this.events),this.api=t,this.session=n,this.size=new V.N(r)}return e.prototype[Symbol.observable]=function(){return this.events},e}(),tn=function(){"use strict";function e(t,n,o){var s=this;(0,q._)(this,e),this.mutex=new eK,this.data=new V.V_(function(e){var t=e8.sessions.get(s.id);t&&e.next(t);var n=s.api.state.register({snapshot:function(){return t},rollback:function(e){return t=e},notify:function(){t&&e.next(t)},update:function(e){if("session-modified"===e.kind&&e.session.id===s.id)return t=e.session,!0}}),o=s.api.connected.lift(e,function(o){return(0,r._)(function(){var r,s,a;return(0,i.YH)(this,function(i){switch(i.label){case 0:return[4,this.api.queryFetchCounter.drained()];case 1:if(i.sent(),r=e8.sessions.get(this.id))return t!==r&&(t=r,n.commit(),e.next(t)),[2];return[4,this.api.service.getSessionEvents.rpc({sessionId:this.id,excludeContents:!0,limit:1})];case 2:if(s=i.sent(),o.aborted||eC(s,"UNEXPECTED_DISCONNECT"))return[2];if(!s.ok)return[2,this.api.error(s,e)];return s.payload.session.events=[],a=e8.sessions.emplace(s.payload.session),t!==a&&(t=a,n.commit(),e.next(t)),[2]}})}).call(s)});return function(){n.unsubscribe(),o.unsubscribe()}}),this.type=this.data.select(function(e){return e.sessionType}),this.ids=new V.V_(function(e){var t=!0,n=!0,o=new eG,a=function(){var t=o.latest();if(!t)return s.api.error("Unexpected empty graph",e);var n=o.hierarchy(t),r=new eY;r.append(n),e.next(r)},u=s.api.state.register({snapshot:function(){return o.clone()},rollback:function(e){return o=e},notify:function(){return a()},update:function(e){if(!n&&"event-modified"===e.kind&&"created"===e.type&&e.event.sessionId===s.id)return o.append([{id:e.event.id,parent:e.event.parentEventId,priority:e.event.created.getTime()}])}}),l=s.api.connected.lift(e,function(l){return(0,r._)(function(){var r,s,c,d,f,h,p,v,g,m,y,b,E,w,I,x,_,S,C;return(0,i.YH)(this,function(i){switch(i.label){case 0:f=Date.now(),u.rollback(),n=!0,null==(r=(s=this.api.logger).info)||r.call(s,"Starting to fetch session graph",{sessionId:this.id}),h=0,p=!1,v=null,g=[],m=200,i.label=1;case 1:if(!(m>0))return[3,4];return h++,[4,this.api.service.getEventList.rpc({sessionId:this.id,limit:500,AncestorsOf:v?{$kind:"ancestorsOf",ancestorsOf:v}:void 0})];case 2:if(y=i.sent(),(l.aborted||!y.ok)&&(null==(b=(E=this.api.logger).info)||b.call(E,"Aborted fetching session graph",{sessionId:this.id,numPagesFetched:h,amountFetched:g.length,duration:Date.now()-f})),l.aborted||eC(y,"UNEXPECTED_DISCONNECT"))return[2];if(!y.ok)return[2,this.api.error(y,e)];w=!0,I=!1,x=void 0;try{for(_=y.payload.shapes[Symbol.iterator]();!(w=(S=_.next()).done);w=!0)C=S.value,g.push({id:C.id,parent:C.parentEventId||null,priority:C.created.getTime()})}catch(e){I=!0,x=e}finally{try{w||null==_.return||_.return()}finally{if(I)throw x}}if(y.payload.shapes.length<500||(v=y.payload.shapes[y.payload.shapes.length-1].id,o.has(v)))return[3,4];i.label=3;case 3:return m--,[3,1];case 4:return g.length&&(p=o.append(g)),n=!1,(p||t)&&(t=!1,u.commit(),a()),null==(c=(d=this.api.logger).info)||c.call(d,"Finished fetching session graph",{sessionId:this.id,numPagesFetched:h,amountFetched:g.length,duration:Date.now()-f}),this.api.hooks.trigger("session-graph-fetched",{session:this,duration:Date.now()-f,size:g.length}),[2]}})}).call(s)});return function(){u.unsubscribe(),l.unsubscribe()}}),this.leaf=this.ids.select(function(e){return e.last}).filter(function(e){return null!==e}),this.api=t,this.agent=new eF(t,this),this.id=n,this.created=o,this.api.teardown(function(){return s.mutex.clear()})}var t=e.prototype;return t.subagent=function(t,n,r,i){return te.create(this.api,t,n,this,e.create(this.api,r,i))},t.window=function(e){return new tt(this.api,this,e)},t.reduce=function(e,t){return"global"===t?new eW(this.api,this,e):new eB(this.api,this,e,t)},t.transform=function(e,t){return new e$(this.api,this,e,t)},t.updateSession=function(e){return(0,r._)(function(){var t,n,r,o,s,a,u,l,c;return(0,i.YH)(this,function(i){switch(i.label){case 0:return[4,ek(this.data)];case 1:if(!(t=i.sent()).ok)return[2,this.api.error(t)];if(n=t.payload,o=(r=(0,eq.l)(n,e)).session,s=r.request,n===o)return[2,e_(n)];return u=(a=(0,b._)(this.api.state.stage({kind:"session-modified",type:"updated",session:o}),2))[0],l=a[1],[4,this.api.service.updateSession.rpc(s)];case 2:if(!(c=i.sent()).ok)return l(),[2,this.api.error(c)];return u(),this.api.hooks.trigger("client-updated-session",{session:this,request:s,prev:n,next:o}),[2,e_(o)]}})}).call(this)},t.updateEvent=function(e){var t=this;return this.mutex.run(function(){return(0,r._)(function(){var t,n,r,o,s,a,u,l,c,d,f,h;return(0,i.YH)(this,function(i){switch(i.label){case 0:return[4,ek(this.ids.map(function(t){return t.has(e.id)}))];case 1:if(!(t=i.sent()).ok)return[2,this.api.error(t)];if(!t.payload)return[2,this.api.error("Event does not exist in the session")];return[4,ek(this.api.materializer.materialize(this.id,[e.id]))];case 2:var p,v,g;if(!(n=i.sent()).ok)return[2,this.api.error(n)];if(r=(0,b._)(n.payload,1)[0],(g=Object.assign({},eR)).eventId=e.id,g.state=null!=(p=e.state)?p:_.qOk.COMPLETE,g.typedOperations=null!=(v=e.typedOperations)?v:[],(s=eP(r,o=g))===r)return[2,e_(s)];return u=(a=(0,b._)(this.api.state.stage({kind:"event-modified",type:"updated",event:s}),2))[0],l=a[1],[4,this.api.service.updateEvent.upload()];case 3:return d=(c=b._.apply(void 0,[i.sent(),2]))[0],f=c[1],d.push(o),d.end(),[4,f];case 4:if(!(h=i.sent()).ok)return l(),[2,this.api.error(h)];return this.api.hooks.trigger("client-updated-event",{session:this,request:o,prev:r,next:s}),u(),[2,e_(s)]}})}).call(t)})},t.appendEvent=function(e,t){var n=this;return this.mutex.run(function(){return(0,r._)(function(){var n,r,o,s,a,u,l,c,d,f,h,p,v;return(0,i.YH)(this,function(i){switch(i.label){case 0:return[4,ek([this.leaf,this.data.select(function(e){return e.sessionType})])];case 1:if(!(n=i.sent()).ok)return[2,this.api.error(n)];if(o=(r=(0,b._)(n.payload,2))[0],s=r[1],void 0!==e.modelType&&s===_.dF3.AGENT_SESSION)return[2,this.api.error("Agent sessions do not support model type configuration")];if(a=_.e3q.BASIC,e.modelType===_.e3q.ADVANCED&&(a=this.api.hasAdvancedModel.current?this.api.overrideModel.current?{type:_.e3q.OVERRIDE,overrideModelName:this.api.overrideModel.current}:_.e3q.ADVANCED:_.e3q.BASIC),e.modelType===_.e3q.OVERRIDE){if(!this.api.overrideModel.current)return[2,this.api.error("No override model set")];a={type:_.e3q.OVERRIDE,overrideModelName:this.api.overrideModel.current}}return l=(u=(0,eD.k)({session:this.id,sender:this.api.user.current,addToChild:!0,parent:o,model:a,data:e,benchmark:t})).event,c=u.request,f=(d=(0,b._)(this.api.state.stage({kind:"event-modified",type:"created",event:l,condition:function(e){return!("event-modified"===e.kind&&"created"===e.type&&(e.event.id===l.id?e.event.parentEventId!==l.parentEventId:e.event.parentEventId===l.parentEventId))}}),2))[0],h=d[1],[4,this.api.service.createEvent.rpc(c)];case 2:if(!(p=i.sent()).ok)return h(),[2,this.api.error(p)];if(p.payload.eventId===l.id&&p.payload.parentEventId===l.parentEventId)return[3,4];return h(),[4,ek(this.api.materializer.materialize(this.id,[p.payload.eventId]))];case 3:if(!(v=i.sent()).ok)return[2,this.api.error(v)];return this.api.hooks.trigger("client-appended-event",{session:this,event:v.payload[0]}),[2,e_(v.payload[0])];case 4:return f(),this.api.hooks.trigger("client-appended-event",{session:this,event:l}),[2,e_(l)]}})}).call(n)})},t.abortLastEvent=function(){var e=this;return this.mutex.run(function(){return(0,r._)(function(){var e,t;return(0,i.YH)(this,function(n){switch(n.label){case 0:return[4,ek(this.leaf)];case 1:if(!(e=n.sent()).ok)return[2,this.api.error(e)];return[4,this.api.service.abortEvent.rpc({eventId:e.payload})];case 2:if(!(t=n.sent()).ok)return[2,this.api.error(t)];return[2,e_(null)]}})}).call(e)})},t.submitUserFeedback=function(e){return(0,r._)(function(){var t,n,r,o,s;return(0,i.YH)(this,function(i){switch(i.label){case 0:return[4,ek([this.data.select(function(e){return e.sessionType}),this.leaf])];case 1:if(!(t=i.sent()).ok)return[2,this.api.error(t)];return r=(n=(0,b._)(t.payload,2))[0],o=n[1],[4,this.api.service.submitAgentUserFeedback.rpc({sessionId:this.id,sessionType:r,feedback:e,sourceEventId:o})];case 2:if(!(s=i.sent()).ok)return[2,this.api.error(s)];return[2,e_(null)]}})}).call(this)},e.create=function(t,n,r){var i=this.sessions.get(t);i||(i=new Map,this.sessions.set(t,i));var o=i.get(n),s=null==o?void 0:o.deref();return o&&s||(o=new WeakRef(s=new e(t,n,r)),i.set(n,o)),s},e}();tn.sessions=new WeakMap;var tr=function(){"use strict";function e(t){var n,o,s,a,u=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,q._)(this,e),this.map=new V.V_(function(e){var t=!1,n=e8.sessions.store(),o=new Map,s=u.api.state.register({snapshot:function(){return new Map(o)},rollback:function(e){o=new Map(e);var t=n;n=e8.sessions.store(Array.from(o.keys())),t.release()},notify:function(){return e.next(new Map(o))},update:function(e){if(t&&"session-modified"===e.kind){var n=e.session,r=u.types.includes(n.sessionType)&&(null===u.archived||n.archived===u.archived)&&(null===u.readonly||n.readOnly===u.readonly);if(!o.has(n.id)&&r)return o.set(n.id,tn.create(u.api,n.id,n.created)),!0;if(o.has(n.id)&&!r)return o.delete(n.id),!0}}}),a=u.api.connected.lift(e,function(a){u.api.queryFetchCounter.scope(function(){return(0,r._)(function(){var r,u,l,c,d,f,h,p,v,g,m,y,b,E,w,I,x;return(0,i.YH)(this,function(i){switch(i.label){case 0:return[4,this.api.service.getReplSessions.rpc({beforeTimestamp:new Date("2099-01-01"),limit:this.limit,includeFirstSessionEvents:!1,firstSessionEventsLimit:1,replId:this.api.replId,sessionTypes:this.types,archived:null!=(r=this.archived)?r:void 0})];case 1:if(u=i.sent(),a.aborted||eC(u,"UNEXPECTED_DISCONNECT"))return[2];if(!u.ok)return[2,this.api.error(u,e)];s.rollback(),l=new Set(o.keys()),c=!1,d=!0,f=!1,h=void 0;try{for(p=u.payload.sessions[Symbol.iterator]();!(d=(v=p.next()).done);d=!0)(g=v.value).events=[],e8.sessions.emplace(g),(null===this.readonly||g.readOnly===this.readonly)&&(l.delete(g.id),o.has(g.id)||(m=tn.create(this.api,g.id,g.created),n.track(g.id),o.set(g.id,m),c=!0))}catch(e){f=!0,h=e}finally{try{d||null==p.return||p.return()}finally{if(f)throw h}}y=!0,b=!1,E=void 0;try{for(w=l[Symbol.iterator]();!(y=(I=w.next()).done);y=!0)x=I.value,n.untrack(x),o.delete(x),c=!0}catch(e){b=!0,E=e}finally{try{y||null==w.return||w.return()}finally{if(b)throw E}}return(c||!t)&&(t=!0,s.commit(),e.next(new Map(o))),[2]}})}).call(u)})});return function(){n.release(),s.unsubscribe(),a.unsubscribe()}}),this.list=this.map.select(function(e){return Array.from(e.values()).sort(function(e,t){return t.created.getTime()-e.created.getTime()})},function(e,t){return e.length===t.length&&e.every(function(e,n){return e===t[n]})}),this.latest=this.map.select(function(e){var t=null,n=!0,r=!1,i=void 0;try{for(var o,s=e.values()[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value;(!t||a.created>t.created)&&(t=a)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}),this.subscribe=this.map.subscribe.bind(this.map),this.api=t,this.archived=null!=(n=l.archived)?n:null,this.readonly=null!=(o=l.readonly)?o:null,this.limit=null!=(s=l.limit)?s:1e3,this.types=null!=(a=l.types)?a:[_.dF3.CHAT,_.dF3.AGENT_SESSION]}return e.prototype[Symbol.observable]=function(){return this.map},e}(),ti=function(){"use strict";function e(t,n){var r=this;(0,q._)(this,e),this.api=t,this.chort=n,this.sessions={query:function(e){return new tr(r.api,e)},create:function(e){return r.api.createSession(e)},rollback:function(e){return r.api.revertToCommit(e)},get:function(e){return r.api.getSessionObservableById(e)},chat:{all:new tr(t,{types:[_.dF3.CHAT]}),open:new tr(t,{types:[_.dF3.CHAT],archived:!1}),archived:new tr(t,{types:[_.dF3.CHAT],archived:!0})},agent:{all:new tr(t,{types:[_.dF3.AGENT_SESSION]}),current:this.api.currentAgentSession,readonly:new tr(t,{types:[_.dF3.AGENT_SESSION],readonly:!0})},lobby:this.api.currentLobbySession}}return e.prototype.hook=function(e,t){return this.api.hooks.add(e,t)},(0,L._)(e,[{key:"planner",get:function(){if(!this.chort)throw Error("Chort client not available");return this.chort.planner}},{key:"queue",get:function(){if(!this.chort)throw Error("Chort client not available");return this.chort.queue}}]),e}(),to=function(){"use strict";function e(t){(0,q._)(this,e),this.hooks={},this.listeners=new V.do,this.api=t}var t=e.prototype;return t.has=function(e){return void 0!==this.hooks[e]},t.add=function(e,t){var n=this,r=this.hooks[e];r||(r=new Map,this.hooks[e]=r);var i=function(){r&&r.has(i)&&(r.delete(i),0===r.size&&(delete n.hooks[e],r=void 0),n.listeners.notify({kind:"hook-unregistered",type:e}))};return r.set(i,t),this.listeners.notify({kind:"hook-registered",type:e}),i},t.trigger=function(e,t){var n=this.hooks[e];if(n){var r=!0,i=!1,o=void 0;try{for(var s,a=(0,em._)(n.values())[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var u=s.value;try{u(t)}catch(e){this.api.error(e)}}}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}}},t.subscribe=function(e){return this.listeners.add(e)},t.dispose=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=Object.values(this.hooks)[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,s=!0,a=!1,u=void 0;try{for(var l,c=o.keys()[Symbol.iterator]();!(s=(l=c.next()).done);s=!0)(0,l.value)()}catch(e){a=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(a)throw u}}}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},e}(),ts=n(64643),ta=function(){"use strict";function e(t){var n,o,s=this,a=t.connection,u=t.user,l=t.hasAdvancedModel,c=t.overrideModel,d=t.logger,f=t.onError;(0,q._)(this,e),this.disposed=!1,this.teardowns=new V.do,this.connected=new V.V_(function(e){var t=null,n=s.teardowns.add(function(){null==t||t.abort(),t=null,e.complete()}),r=s.status.subscribe(function(n){"connected"!==n?(null==t||t.abort(),t=null,"closed"===n?e.complete():"error"===n&&e.error(Error("Connection error"))):(t=new AbortController,e.next(t.signal))});return function(){null==t||t.abort(),t=null,n(),r.unsubscribe()}}),this.closed=new V.V_(function(e){var t=s.teardowns.add(function(){e.next(),e.complete()}),n=s.status.subscribe(function(t){("closed"===t||"error"===t)&&(e.next(),e.complete())});return function(){t(),n.unsubscribe()}}),this.models=new V.V_(function(e){var t=0;return V.cP.combine(s.connected,s.overrideModel).filter(function(e){return!(0,b._)(e,1)[0].aborted}).lift(e,function(n){var o=(0,b._)(n,2),a=o[0],u=o[1];return(0,r._)(function(){var n,r,o,s,l;return(0,i.YH)(this,function(i){switch(i.label){case 0:return n=++t,[4,this.service.getAvailableModels.rpc({overrideModel:null!=u?u:""})];case 1:if(r=i.sent(),t!==n||a.aborted||eC(r,"UNEXPECTED_DISCONNECT"))return[2];if(!r.ok)return[2,this.error(r,e)];return o=r.payload.basicModel.map(function(e){return new ts.i({type:_.e3q.BASIC,readable:e.readable,qualified:e.qualified})}),s=r.payload.advancedModel.map(function(e){return new ts.i({type:_.e3q.ADVANCED,readable:e.readable,qualified:e.qualified})}),l=null,u&&r.payload.overrideModel&&r.payload.overrideModel.qualified===u&&(l=new ts.i({type:_.e3q.OVERRIDE,readable:r.payload.overrideModel.readable,qualified:r.payload.overrideModel.qualified})),e.next({basic:o,advanced:s,override:l}),[2]}})}).call(s)})}),this.connection=a,this.user=new V.N(u),this.hasAdvancedModel=new V.N(l),this.overrideModel=new V.N(null!=c?c:null),this.logger=function(e){var t={},n="chatter: ";if(e.debug){var r=e.debug;t.debug=function(e,t){r(n+e,t)}}if(e.info){var i=e.info;t.info=function(e,t){i(n+e,t)}}if(e.warn){var o=e.warn;t.warn=function(e,t){o(n+e,t)}}if(e.error){var s=e.error;t.error=function(e,t){s(n+e,t)}}return t}(null!=d?d:{}),this.onError=f,this.hooks=new to(this),this.teardown(function(){return s.hooks.dispose()});var h=this.connection.status.subscribe(function(e){var t,n;null==(t=(n=s.logger).info)||t.call(n,"connection status changed",{connectionStatus:e}),("closed"===e||"error"===e)&&s.dispose()});this.teardown(function(){return h.unsubscribe()}),null==(n=(o=this.logger).info)||n.call(o,"API initialized")}var t=e.prototype;return t.error=function(e,t){var n=eS(e);if(!eC(n,"UNEXPECTED_DISCONNECT")&&!n.reported)if(n.reported=!0,this.onError){var r=null;(void 0===e?"undefined":(0,ey._)(e))==="object"&&"payload"in e&&(r=n.payload),this.onError(n,r)}else setTimeout(function(){throw n},0);return t&&t.error(n),eC(n,"UNEXPECTED_DISCONNECT")?this.hooks.trigger("unexpected-disconnect",{error:n}):this.hooks.trigger("unhandled-exception",{error:n}),n},t.teardown=function(e){return this.disposed?(e(),function(){}):this.teardowns.add(e)},t.ping=function(){return(0,r._)(function(){var e;return(0,i.YH)(this,function(t){switch(t.label){case 0:return[4,this.service.pingPong.rpc({})];case 1:if(eC(e=t.sent(),"UNEXPECTED_DISCONNECT"))return[2,e_(!1)];if(!e.ok)return[2,this.error(e)];return[2,e_(!0)]}})}).call(this)},t.dispose=function(){if(!this.disposed){var e,t;this.disposed=!0,this.teardowns.notify(),this.teardowns.clear(),null==(t=this.logger)||null==(e=t.info)||e.call(t,"API disposed")}},t.enhancePrompt=function(e,t){return(0,r._)(function(e){var t,n,r,o,s=arguments;return(0,i.YH)(this,function(i){switch(i.label){case 0:return t=s.length>1&&void 0!==s[1]?s[1]:[],n=s.length>2&&void 0!==s[2]?s[2]:[],r=s.length>3?s[3]:void 0,[4,this.service.enhanceAgentPrompt.rpc({userPrompt:e,uploadedFiles:t,attachedUrls:n,selectedTheme:r||""})];case 1:if(!(o=i.sent()).ok)return[2,this.error(o)];return[2,e_(o.payload.enhancedPrompt)]}})}).apply(this,arguments)},t.generateReplName=function(e,t){return(0,r._)(function(){var n;return(0,i.YH)(this,function(r){switch(r.label){case 0:return[4,this.service.generateReplName.rpc({replId:e,prompt:t})];case 1:if(!(n=r.sent()).ok)return[2,this.error(n)];return[2,e_(n.payload.replName)]}})}).call(this)},t.getUrlScrapedContent=function(e){return(0,r._)(function(){var t;return(0,i.YH)(this,function(n){switch(n.label){case 0:return[4,this.service.getUrlScrapedContent.rpc({url:e})];case 1:if(!(t=n.sent()).ok)return[2,this.error(t)];return[2,e_(t.payload.content)]}})}).call(this)},t.getUrlScreenshot=function(e){return(0,r._)(function(){var t;return(0,i.YH)(this,function(n){switch(n.label){case 0:return[4,this.service.getUrlScreenshot.rpc({url:e})];case 1:if(!(t=n.sent()).ok)return[2,this.error(t)];return[2,e_(t.payload.imageDownloadUrl)]}})}).call(this)},t.generateReplIcon=function(e,t){return(0,r._)(function(){var n;return(0,i.YH)(this,function(r){switch(r.label){case 0:return[4,this.service.generateIcon.rpc({replId:e,prompt:t})];case 1:if(!(n=r.sent()).ok)return[2,this.error(n)];return[2,e_(n.payload.imageUrl)]}})}).call(this)},t.getResourceUploadUrl=function(e){return(0,r._)(function(){var t;return(0,i.YH)(this,function(n){switch(n.label){case 0:return[4,this.service.getResourceUploadUrl.rpc({mimeType:e})];case 1:if(!(t=n.sent()).ok)return[2,this.error(t)];return[2,e_(t.payload)]}})}).call(this)},(0,L._)(e,[{key:"service",get:function(){return this.connection.service}},{key:"status",get:function(){return this.connection.status}}]),e}(),tu=function(){"use strict";function e(){(0,q._)(this,e),this.current=0,this.resolves=[]}var t=e.prototype;return t.increment=function(){this.current++},t.decrement=function(){if(this.current--,this.current<0)throw this.current=0,Error("Reference count cannot be negative");for(;0===this.current&&this.resolves.length>0;){var e=this.resolves.shift();null==e||e()}},t.drained=function(){return(0,r._)(function(){var e;return(0,i.YH)(this,function(t){switch(t.label){case 0:if(e=this,0!==this.current)return[3,2];return[4,Promise.resolve()];case 1:if(t.sent(),0===this.current)return[2];t.label=2;case 2:return[2,new Promise(function(t){e.resolves.push(t)})]}})}).call(this)},t.scope=function(e){return(0,r._)(function(){return(0,i.YH)(this,function(t){switch(t.label){case 0:this.increment(),t.label=1;case 1:return t.trys.push([1,,3,4]),[4,e()];case 2:return[2,t.sent()];case 3:return this.decrement(),[7];case 4:return[2]}})}).call(this)},(0,L._)(e,[{key:"count",get:function(){return this.current}}]),e}(),tl=function(){"use strict";function e(t){var n=this;(0,q._)(this,e),this.queue=new Map,this.store=e8.events.store(),this.enqueued=null,this.events=new V.jA(function(e){var t=!1,o=n.api.closed.subscribe(function(){e.complete()});return n.enqueued=function(){t||(t=!0,(0,r._)(function(){var n,r,o,s,a,u,l,c,d,f,h,p,v,g,m,y,E,w,I,x,_,S,C,k,A,T,U,M,N,P,O,R,D,q,L,V,F,Z,Y,H,j,z,X,W,B,$,G,K,J,Q,ee,et,en,er,ei,eo;return(0,i.YH)(this,function(i){switch(i.label){case 0:if(!this.queue.size)return[3,9];n=!0,r=!1,o=void 0,i.label=1;case 1:i.trys.push([1,6,7,8]),s=this.queue[Symbol.iterator](),i.label=2;case 2:if(n=(a=s.next()).done)return[3,5];if(l=(u=(0,b._)(a.value,2))[0],c=u[1],this.api.state.optimistic){h=[],p=!0,v=!1,g=void 0;try{for(m=c[Symbol.iterator]();!(p=(y=m.next()).done);p=!0)E=y.value,(w=this.api.state.isOptimisticEvent(E))&&(_=this.api.state.getOptimisticEvent(E),h.push(_),c.delete(E),null==(I=(x=this.api.logger).warn)||I.call(x,"materialized optimistic event",{sessionId:l,eventId:E,eventOptimisticType:w}))}catch(e){v=!0,g=e}finally{try{p||null==m.return||m.return()}finally{if(v)throw g}}if(h.length&&(this.store.untrack(h),e.next(h)),!c.size)return this.queue.delete(l),[3,4]}if(!e8.events.empty){S=[],C=!0,k=!1,A=void 0;try{for(T=c[Symbol.iterator]();!(C=(U=T.next()).done);C=!0)M=U.value,(N=e8.events.get(M))&&(S.push(N),c.delete(M))}catch(e){k=!0,A=e}finally{try{C||null==T.return||T.return()}finally{if(k)throw A}}S.length&&(this.store.untrack(S),e.next(S))}if(!c.size)return this.queue.delete(l),[3,4];return P=Date.now(),O=Array.from(c).slice(0,500),[4,this.api.service.batchGetEvents.rpc({sessionId:l,eventIds:O})];case 3:if(R=i.sent(),!t)return[2];if(eC(R,"UNEXPECTED_DISCONNECT"))return[3,4];if(R.ok&&!R.payload.events.length){L=!0,V=!1,F=void 0;try{for(Z=O[Symbol.iterator]();!(L=(Y=Z.next()).done);L=!0)H=Y.value,c.delete(H)}catch(e){V=!0,F=e}finally{try{L||null==Z.return||Z.return()}finally{if(V)throw F}}return c.size||this.queue.delete(l),this.store.untrack(O),null==(D=(q=this.api.logger).warn)||D.call(q,"detected infinite materialization loop",{sessionId:l,eventIds:O}),[3,4]}if(!R.ok){j=!0,z=!1,X=void 0;try{for(W=O[Symbol.iterator]();!(j=(B=W.next()).done);j=!0)$=B.value,c.delete($)}catch(e){z=!0,X=e}finally{try{j||null==W.return||W.return()}finally{if(z)throw X}}return c.size||this.queue.delete(l),this.store.untrack(O),[2,this.api.error(R,e)]}G=R.payload.events,null==(f=this.api.logger)||null==(d=f.info)||d.call(f,"materialized events",{sessionId:l,duration:Date.now()-P,count:G.length}),this.api.hooks.trigger("events-materialized",{sessionId:l,duration:Date.now()-P,count:G.length}),K=[],J=!0,Q=!1,ee=void 0;try{for(et=G[Symbol.iterator]();!(J=(en=et.next()).done);J=!0){if(er=en.value,ei=e8.events.get(er.id))er=ei;else{var es;(es=er).contents.contents&&es.typedUpdateEventOperations.length&&(eN(es.contents.contents,es.typedUpdateEventOperations),es.typedUpdateEventOperations=[]),e8.events.add(er)}c.has(er.id)&&(K.push(er),c.delete(er.id))}}catch(e){Q=!0,ee=e}finally{try{J||null==et.return||et.return()}finally{if(Q)throw ee}}c.size||this.queue.delete(l),K.length&&(this.store.untrack(K),e.next(K)),i.label=4;case 4:return n=!0,[3,2];case 5:return[3,8];case 6:return eo=i.sent(),r=!0,o=eo,[3,8];case 7:try{n||null==s.return||s.return()}finally{if(r)throw o}return[7];case 8:return[3,0];case 9:return t=!1,[2]}})}).call(n).catch(function(t){return e.error(t)}))},n.queue.size&&n.enqueued(),function(){t=!1,n.enqueued=null,o.unsubscribe()}}),this.api=t}var t=e.prototype;return t.enqueue=function(e,t){if(t.length){var n=this.queue.get(e);n||(n=new Set,this.queue.set(e,n));var r=!0,i=!1,o=void 0;try{for(var s,a,u=t[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var l=a.value;n.add(l)}}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}this.store.track(t),null==(s=this.enqueued)||s.call(this)}},t.materialize=function(e,t){return(0,r._)(function(){var n,r,o,s,a,u,l,c,d,f,h,p,v,g,m,y,b;return(0,i.YH)(this,function(i){switch(i.label){case 0:n=this,r=new Set(t),o=e8.events.store(t),s=!0,a=!1,u=void 0;try{for(l=o[Symbol.iterator]();!(s=(c=l.next()).done);s=!0)d=c.value,r.delete(d.id)}catch(e){a=!0,u=e}finally{try{s||null==l.return||l.return()}finally{if(a)throw u}}if(!r.size)return[3,2];return this.enqueue(e,Array.from(r)),[4,new Promise(function(e,t){var i=n.events.subscribe({next:function(t){var n=!0,o=!1,s=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done);n=!0){var l=a.value;r.has(l.id)&&r.delete(l.id)}}catch(e){o=!0,s=e}finally{try{n||null==u.return||u.return()}finally{if(o)throw s}}r.size||(i.unsubscribe(),e())},error:function(e){o.release(),t(e)},complete:function(){o.release(),t(new V.Rx)}})})];case 1:i.sent(),i.label=2;case 2:f=[],h=!0,p=!1,v=void 0;try{for(g=t[Symbol.iterator]();!(h=(m=g.next()).done);h=!0){if(y=m.value,!(b=this.get(y)))throw o.release(),this.api.error("Unexpected missing event");f.push(b)}}catch(e){p=!0,v=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw v}}return o.release(),[2,f]}})}).call(this)},t.get=function(e){return this.api.state.isOptimisticEvent(e)?this.api.state.getOptimisticEvent(e):e8.events.get(e)},e}(),tc=n(17459),td=function(){"use strict";function e(t){var n=this;(0,q._)(this,e),this.handles=new Map,this.onUpdateHandlers=null,this.refs=new Set,this.buffer=[],this.conditions=new Set,this.listeners=new V.do,this.optimistic=!1,this.emitter=new V.cP(function(e){return n.api.connected.lift(e,function(t){return(0,r._)(function(){var n,r,o,s,a,u,l,c,d,f,h,p,v,g,m,y,E,w,I,x,S,C,k,A,T;return(0,i.YH)(this,function(i){switch(i.label){case 0:return n=e8.events.store(),r=e8.sessions.store(),[4,this.api.service.subscribeToReplEvents.subscribe({replId:this.api.replId})];case 1:if(s=(o=b._.apply(void 0,[i.sent(),2]))[0],a=o[1],u=function(){a(),n.release(),r.release()},t.aborted)return[2,u()];t.addEventListener("abort",a),l=!1,c=!1,i.label=2;case 2:i.trys.push([2,7,8,13]),f=(0,Z._)(s),i.label=3;case 3:return[4,f.next()];case 4:if(!(l=!(h=i.sent()).done)||(p=h.value,t.aborted||eC(p,"UNEXPECTED_DISCONNECT")))return[3,6];if(!p.ok)return this.api.error(p,e),[3,6];if(!p.payload.message)return[3,5];switch(v=void 0,(g=(0,eT.q4)(p.payload.message)).$kind){case"subscriptionStatusMessage":case"abortEventMessage":return[3,5];case"createEventMessage":(m=e8.events.create(g)).state===_.qOk.COMPLETE?this.api.hooks.trigger("received-completed-event",{event:m}):this.api.hooks.has("received-completed-event")&&n.track(m.id),void 0===m.contents.contents&&this.api.hooks.has("received-event")?r.track(m.id):this.api.hooks.trigger("received-event",{event:m}),v={kind:"event-modified",optimistic:!1,type:"created",event:m};break;case"updateEventMessage":if(!(y=e8.events.update(g)))return[3,5];n.has(y.id)&&y.state===_.qOk.COMPLETE&&(n.untrack(y.id),this.api.hooks.trigger("received-completed-event",{event:y})),r.has(y.id)&&void 0!==y.contents.contents&&(r.untrack(y.id),this.api.hooks.trigger("received-event",{event:y})),v={kind:"event-modified",optimistic:!1,type:"updated",event:y};break;case"createSessionMessage":v={kind:"session-modified",optimistic:!1,type:"created",session:e8.sessions.create(g)};break;case"updateSessionMessage":if(!(E=e8.sessions.update(g)))return[3,5];v={kind:"session-modified",optimistic:!1,type:"updated",session:E};break;case"updateAgentStateMessage":w=eV(g),this.api.hooks.trigger("agent-state-changed",{sessionId:g.sessionId,state:w}),v={kind:"agent-state-modified",optimistic:!1,session:g.sessionId,state:w}}I=!0,x=!1,S=void 0;try{for(C=this.conditions[Symbol.iterator]();!(I=(k=C.next()).done);I=!0)if(A=k.value,!1===A(v)){this.rollback();break}}catch(e){x=!0,S=e}finally{try{I||null==C.return||C.return()}finally{if(x)throw S}}e.next(v),i.label=5;case 5:return l=!1,[3,3];case 6:return[3,13];case 7:return T=i.sent(),c=!0,d=T,[3,13];case 8:if(i.trys.push([8,,11,12]),!(l&&null!=f.return))return[3,10];return[4,f.return()];case 9:i.sent(),i.label=10;case 10:return[3,12];case 11:if(c)throw d;return[7];case 12:return[7];case 13:return t.removeEventListener("abort",u),u(),[2]}})}).call(n)})}),this.updates=new V.jA(function(e){var t=n.listeners.add(function(t){e.next(t)}),r=n.emitter.subscribe(e);return function(){t(),r.unsubscribe()}}),this.api=t;var o=this.api.status.subscribe(function(e){"connected"!==e&&(e8.events.invalidate(),e8.sessions.invalidate(),n.optimistic&&n.rollback())}),s=null,a=this.api.hooks.subscribe(function(e){if("agent-state-changed"===e.type||"received-completed-event"===e.type||"received-event"===e.type){var t=n.api.hooks.has("agent-state-changed")||n.api.hooks.has("received-completed-event")||n.api.hooks.has("received-event");t&&!s?s=n.updates.subscribe(function(){}):!t&&s&&(s.unsubscribe(),s=null)}});this.api.teardown(function(){o.unsubscribe(),a(),null==s||s.unsubscribe()})}var t=e.prototype;return t.isOptimisticEvent=function(e){var t=this.buffer.filter(function(e){return"event-modified"===e.kind}).find(function(t){return t.event.id===e});return!!t&&t.type},t.getOptimisticEvent=function(e){var t=this.buffer.filter(function(e){return"event-modified"===e.kind}).find(function(t){return t.event.id===e});if(!t)throw Error("Event not found in optimistic state");return t.event},t.apply=function(e){var t=new Set,n=!0,r=!1,i=void 0;try{for(var o,s=this.handles[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a,u=(0,b._)(o.value,2),l=u[0],c=u[1];if(e.optimistic&&c!==V.NV){(null==(d=l.update)?void 0:d.call(l,e))&&t.add(l);continue}if(e.optimistic&&c===V.NV){var d,f,h=l.snapshot();(null==(f=l.update)?void 0:f.call(l,e))&&(this.handles.set(l,h),t.add(l));continue}if(!e.optimistic&&c!==V.NV){l.rollback(c),(null==(y=l.update)?void 0:y.call(l,e))&&t.add(l);var p=l.snapshot(),v=!0,g=!1,m=void 0;try{for(var y,E,w=this.buffer[Symbol.iterator]();!(v=(E=w.next()).done);v=!0){var I,x=E.value;(null==(I=l.update)?void 0:I.call(l,x))&&(this.handles.set(l,p),t.add(l))}}catch(e){g=!0,m=e}finally{try{v||null==w.return||w.return()}finally{if(g)throw m}}continue}!e.optimistic&&c===V.NV&&(null==(a=l.update)?void 0:a.call(l,e))&&t.add(l)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}var _=!0,S=!1,C=void 0;try{for(var k,A=t[Symbol.iterator]();!(_=(k=A.next()).done);_=!0){var T,U=k.value;null==(T=U.notify)||T.call(U)}}catch(e){S=!0,C=e}finally{try{_||null==A.return||A.return()}finally{if(S)throw C}}},t.rollback=function(){if(!this.optimistic)throw Error("Cannot rollback while not optimistic");this.optimistic=!1,this.buffer.length=0,this.refs.clear(),this.conditions.clear();var e=new Set,t=!0,n=!1,r=void 0;try{for(var i,o=this.handles[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var s=(0,b._)(i.value,2),a=s[0],u=s[1];u!==V.NV&&(a.rollback(u),this.handles.set(a,V.NV),e.add(a))}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}var l=!0,c=!1,d=void 0;try{for(var f,h=e[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){var p,v=f.value;null==(p=v.notify)||p.call(v)}}catch(e){c=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(c)throw d}}},t.commit=function(){if(!this.optimistic)throw Error("Cannot commit while not optimistic");var e=!0,t=!1,n=void 0;try{for(var r,i=this.buffer[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;switch(o.kind){case"event-modified":e8.events.emplace(o.event);break;case"session-modified":e8.sessions.emplace(o.session)}}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.optimistic=!1,this.buffer.length=0,this.refs.clear(),this.conditions.clear();var s=!0,a=!1,u=void 0;try{for(var l,c=this.handles.keys()[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var d=l.value;this.handles.set(d,V.NV)}}catch(e){a=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(a)throw u}}},t.stage=function(e){var t=this;if("connected"!==this.api.status.current)throw Error("Cannot notify while not connected");var n=e.condition,r=(0,tc._)(e,["condition"]),i=(0,A._)((0,k._)({},r),{optimistic:!0});this.buffer.push(i),n&&this.conditions.add(n);var o=function(e){t.refs.has(o)&&(t.refs.delete(o),e?0===t.refs.size&&t.commit():(t.rollback(),t.api.hooks.trigger("client-state-rollback",{failed:i})),n&&t.conditions.delete(n))};return this.refs.add(o),this.optimistic=!0,this.listeners.notify(i),[function(){return o(!0)},function(){return o(!1)}]},t.register=function(e){var t=this;return null!=this.onUpdateHandlers||(this.onUpdateHandlers=this.updates.subscribe(function(e){t.apply(e)})),this.handles.set(e,V.NV),this.optimistic&&e.update&&Promise.resolve().then(function(){if(t.handles.has(e)&&t.optimistic){var n,r=e.snapshot(),i=!1,o=!0,s=!1,a=void 0;try{for(var u,l=t.buffer[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c,d=u.value;(null==(c=e.update)?void 0:c.call(e,d))&&(i=!0)}}catch(e){s=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw a}}i&&(t.handles.set(e,r),null==(n=e.notify)||n.call(e))}}),{get optimistic(){return t.handles.get(e)!==V.NV},rollback:function(){var n=t.handles.get(e);n!==V.NV&&(e.rollback(n),t.handles.set(e,V.NV))},commit:function(){t.handles.set(e,V.NV)},unsubscribe:function(){if(t.handles.delete(e),0===t.handles.size){var n;null==(n=t.onUpdateHandlers)||n.unsubscribe(),t.onUpdateHandlers=null}}}},e}(),tf=function(e){"use strict";function t(e){var n;if((0,q._)(this,t),!e.replId)throw Error("Chatter API is disabled");return(n=(0,ep._)(this,t,[e])).sessionObservables=new Map,n.currentLobbySession=new V.V_(function(e){return n.connected.lift(e,function(t){return(0,r._)(function(){var r,o;return(0,i.YH)(this,function(i){switch(i.label){case 0:return[4,n.service.getReplSessions.rpc({beforeTimestamp:new Date("2099-01-01"),limit:1,includeFirstSessionEvents:!1,firstSessionEventsLimit:1,replId:n.replId,sessionTypes:[_.dF3.REPL_CREATION_V3],archived:void 0})];case 1:if(r=i.sent(),t.aborted||eC(r,"UNEXPECTED_DISCONNECT"))return[2];if(!r.ok)return[2,n.error(r,e)];if(0===r.payload.sessions.length)return[2,e.next(null)];return r.payload.sessions[0].events=[],o=e8.sessions.emplace(r.payload.sessions[0]),e.next(tn.create(n,o.id,o.created)),[2]}})})()})}),n.currentAgentSession=new V.V_(function(e){var t=!1,o="",s=null,a=function(t){return(0,r._)(function(){var r,o,a,u;return(0,i.YH)(this,function(i){switch(i.label){case 0:if(null==s||s.abort(),!t)return[2,e.next(null)];if(r=e8.sessions.get(t))return e.next(tn.create(n,t,r.created)),s=null,[2];return o=(s=new AbortController).signal,[4,n.service.getSessionEvents.rpc({excludeContents:!0,sessionId:t,limit:1})];case 1:if(a=i.sent(),o.aborted||eC(a,"UNEXPECTED_DISCONNECT"))return[2];if(!a.ok)return[2,n.error(a,e)];return a.payload.session.events=[],s=null,u=e8.sessions.emplace(a.payload.session),e.next(tn.create(n,t,u.created)),[2]}})})()},u=n.state.updates.filter(function(e){return"agent-state-modified"===e.kind}).select(function(e){return e.session}).lift(e,function(e){o!==e&&(o=e,a(e))}),l=n.connected.lift(e,function(s){return(0,r._)(function(){var r,u,l,c,d,f,h,p,v,g;return(0,i.YH)(this,function(i){switch(i.label){case 0:return[4,n.service.getReplSessions.rpc({beforeTimestamp:new Date("2099-01-01"),limit:5,includeFirstSessionEvents:!1,firstSessionEventsLimit:1,replId:n.replId,sessionTypes:[_.dF3.AGENT_SESSION],archived:void 0})];case 1:if(r=i.sent(),s.aborted||eC(r,"UNEXPECTED_DISCONNECT"))return[2];if(!r.ok)return[2,n.error(r,e)];u=!0,l=!1,c=void 0;try{for(d=r.payload.sessions[Symbol.iterator]();!(u=(f=d.next()).done);u=!0)(h=f.value).events=[],e8.sessions.emplace(h)}catch(e){l=!0,c=e}finally{try{u||null==d.return||d.return()}finally{if(l)throw c}}return p=r.payload.replAgentState.activeAgentSessionId,v=r.payload.sessions.filter(function(e){return!e.readOnly}).sort(function(e,t){return t.created.getTime()-e.created.getTime()})[0],g=p||(null==v?void 0:v.id)||"",o===g&&t||(t=!0,o=g,a(g)),[2]}})})()});return function(){null==s||s.abort(),u.unsubscribe(),l.unsubscribe()}}),n.replId=e.replId,n.materializer=new tl(n),n.state=new td(n),n.queryFetchCounter=new tu,n}(0,ev._)(t,e);var n=t.prototype;return n.getSessionObservableById=function(e){var t=this,n=this.sessionObservables.get(e);return n||(n=new V.V_(function(n){var o=null,s=e8.sessions.get(e);s?n.next(tn.create(t,e,s.created)):o=t.connected.lift(n,function(s){return(0,r._)(function(){var t,r;return(0,i.YH)(this,function(i){switch(i.label){case 0:return[4,this.service.getSessionEvents.rpc({excludeContents:!0,sessionId:e,limit:1})];case 1:if(t=i.sent(),s.aborted||eC(t,"UNEXPECTED_DISCONNECT"))return[2];if(!t.ok)return[2,this.error(t,n)];return t.payload.session.events=[],r=e8.sessions.emplace(t.payload.session),n.next(tn.create(this,e,r.created)),null==o||o.unsubscribe(),o=null,[2]}})}).call(t)});var a=t.teardown(function(){n.complete()});return function(){null==o||o.unsubscribe(),a()}}),this.sessionObservables.set(e,n)),n},n.createSession=function(e){return(0,r._)(function(){var t,n,r;return(0,i.YH)(this,function(i){switch(i.label){case 0:return t=(0,eq.uc)((0,A._)((0,k._)({},e),{replId:this.replId})),[4,this.service.createSession.rpc(t)];case 1:if(!(n=i.sent()).ok)return[2,this.error(n)];return r=tn.create(this,n.payload.sessionId,new Date),this.hooks.trigger("client-created-session",{session:r,request:t}),[2,e_(r)]}})}).call(this)},n.revertToCommit=function(e){return(0,r._)(function(){var t,n,r,o,s,a,u,l,c,d;return(0,i.YH)(this,function(i){switch(i.label){case 0:return r=(0,k._)({replId:this.replId,databaseRollbackTimestamp:null!=(t=e.databaseRollbackTimestamp)?t:"",deploymentBuildId:null!=(n=e.deploymentBuildId)?n:""},e),[4,this.service.revertToCommit.rpc(r)];case 1:if(!(o=i.sent()).ok)return[2,this.error(o)];if(s=o.payload.revertedSessionId,a=e8.sessions.get(s))return u=tn.create(this,s,a.created),this.hooks.trigger("client-reverted-session",{session:u,request:r}),[2,e_(u)];return[4,this.service.getSessionEvents.rpc({excludeContents:!0,sessionId:s,limit:1})];case 2:if(!(l=i.sent()).ok)return[2,this.error(l)];return l.payload.session.events=[],c=e8.sessions.emplace(l.payload.session),d=tn.create(this,s,c.created),this.hooks.trigger("client-reverted-session",{session:d,request:r}),[2,e_(d)]}})}).call(this)},t}(ta),th=function(){"use strict";function e(t){(0,q._)(this,e),this.chort=t.chortConnection?new j({connection:t.chortConnection,replId:t.replId}):null,t.replId?(this.api=new tf(t),this._chatter=new ti(this.api,this.chort)):(this.api=new ta(t),this._chatter=null)}var t=e.prototype;return t.chatter=function(){if(!this._chatter)throw Error("Chatter API is disabled");return this._chatter},t.hook=function(e,t){return this.api.hooks.add(e,t)},t.enhancePrompt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0;return this.api.enhancePrompt(e,t,n,r)},t.getUrlScrapedContent=function(e){return this.api.getUrlScrapedContent(e)},t.getUrlScreenshot=function(e){return this.api.getUrlScreenshot(e)},t.generateReplName=function(e,t){return this.api.generateReplName(e,t)},t.generateReplIcon=function(e,t){return this.api.generateReplIcon(e,t)},t.getResourceUploadUrl=function(e){return this.api.getResourceUploadUrl(e)},t.pingChort=function(){return(0,r._)(function(){return(0,i.YH)(this,function(e){switch(e.label){case 0:if(!this.chort)throw Error("Chort API is not available");return[4,this.chort.ping()];case 1:return[2,e.sent()]}})}).call(this)},t.dispose=function(){this.api.dispose()},(0,L._)(e,[{key:"status",get:function(){return this.api.status}},{key:"user",get:function(){return this.api.user}},{key:"hasAdvancedModel",get:function(){return this.api.hasAdvancedModel}},{key:"overrideModel",get:function(){return this.api.overrideModel}},{key:"models",get:function(){return this.api.models}}]),e}(),tp=n(69737),tv=n(69832),tg=(0,x.eU)({hasAccessToAdvancedModel:!1,defaultAssistantChatMode:"basic",defaultAssistantInlineMode:"basic"});function tm(){return(0,eh.h)(tg)}function ty(){var e=(0,eh.dI)();return(0,tv.Rj)(function(){return e.status.map(function(e){return"connected"===e})},[e],{default:!1})}function tb(){var e=(0,eh.dI)();return(0,tv.Rj)(function(){return e.status.map(function(e){return"error"===e})},[e],{default:!1})}var tE=(0,tp.t_)(function(e){return e(tg).defaultAssistantChatMode}),tw=(0,tp.t_)(function(e){return e(tg).defaultAssistantInlineMode}),tI=n(24160),tx=n(26737),t_=n(86103),tS=n(95570),tC=(0,x.eU)(!1);function tk(){return(0,eh.h)(tC)}function tA(e){var t,n,o,s,a,c,d,f,h,p,v,g,m,C,k,A,T,U,M,O,q,L,V,F,Z,Y,H,j,z,X,G,K,Q,et,en,er,ei,eo,es,eu,el,ed,ep,ev,eg,em,ey,eb,eE,ew,eI,ex,e_=e.replId,eS=e.currentUser,eC=e.hasAccessToAdvancedModel,ek=e.children,eA=e.mockStore,eT=e.mockYapper,eU=e.agentChatEnabled,eM=e.orgId,eN=e.renderEmptyState,eP=(n=(t={replId:e_,currentUser:eS,hasAccessToAdvancedModel:eC,mockStore:eA,mockYapper:eT,agentChatEnabled:eU,orgId:eM}).replId,o=t.currentUser,s=t.orgId,a=t.hasAccessToAdvancedModel,c=t.agentChatEnabled,d=t.mockStore,f=t.mockYapper,h=(0,tx.g)("assistantAdvancedModelOverride").preferences.assistantAdvancedModelOverride,p=(0,t_._P)({controlName:"flag-agent-everywhere"}),g=(v={replId:n,currentUserId:o.id,orgId:s,onProtocolError:function(e){l(e.message,{code:e.type})},onRetriesExceeded:function(e){(0,I.flushSync)(function(){return en.set(tC,!0)}),u.Cp("Chat service connection retries exhausted in AiProvider"),l(e.message,{code:e.type})}}).endpoint,m=v.replId,C=v.currentUserId,k=v.orgId,A=v.onRetriesExceeded,T=v.onProtocolError,M=(U=(0,b._)((0,w.useState)(null),2))[0],O=U[1],q=(0,B.A)(A),L=(0,B.A)(T),(0,w.useEffect)(function(){var e=(0,ee.hV)({currentUserId:C}),t=new ee.Zn({clientId:e,serverId:ec,logger:ef,getEndpoint:function(){return(0,r._)(function(){var t,n;return(0,i.YH)(this,function(r){switch(r.label){case 0:if(g)return[2,g];return[4,y(m,e,k)];case 1:return t=r.sent(),(n=new URL(ea())).searchParams.set("auth_token",t),[2,n]}})})()},onProtocolError:function(e){var t;null==(t=L.current)||t.call(L,e)},onRetriesExceeded:function(e){var t;null==(t=q.current)||t.call(q,e)}});return O(t),function(){O(null),Promise.resolve().then(function(){return t.close()})}},[g,m,C,k,q,L]),V=M,Z=(F={replId:n,userId:o.id,onProtocolError:function(e){l(e.message,{code:e.type})},onRetriesExceeded:function(e){l(e.message,{code:e.type})}}).replId,Y=F.userId,H=F.onRetriesExceeded,j=F.onProtocolError,X=(z=(0,b._)((0,w.useState)(null),2))[0],G=z[1],K=(0,B.A)(H),Q=(0,B.A)(j),(0,w.useEffect)(function(){var e=new W({userId:Y,logger:J,getEndpoint:function(){return(0,r._)(function(){var e;return(0,i.YH)(this,function(t){return e="production",S()||(e="staging"),[2,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8100;switch(e){case"production":return"wss://production-chort.replit.com/api/river";case"staging":return"wss://staging-chort.replit.com/api/river";case"development":return"ws://127.0.0.1:".concat(t,"/api/river")}}(e)]})})()},getToken:function(){return(0,r._)(function(){return(0,i.YH)(this,function(e){return[2,function(e,t){return(0,r._)(function(e,t){var n,o,s,a,u,l=arguments;return(0,i.YH)(this,function(c){switch(c.label){case 0:return s=void 0===(o=(n=l.length>2&&void 0!==l[2]?l[2]:{}).path)?"/ai/chort/auth":o,u=void 0===(a=n.cache)||a,[4,D.runExclusive(function(){return(0,r._)(function(){var n,r,o,a,l,c;return(0,i.YH)(this,function(i){switch(i.label){case 0:if(n="".concat(e,"-").concat(null!=t?t:"none","-").concat(s),u&&(r=R.get(n))&&r.expiration>Date.now())return[2,r.token];return[4,fetch(s,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t?{repl:{id:t}}:{})})];case 1:if(!(o=i.sent()).ok)throw Error("Failed to fetch Chort auth token: ".concat(o.status));return[4,o.json()];case 2:return a=i.sent(),l=P.T(N,a),u&&(c=Date.now()+18e5,R.set(n,{token:l,expiration:c})),[2,l]}})})()})];case 1:return[2,c.sent()]}})}).apply(this,arguments)}(Y,Z)]})})()},onProtocolError:function(e){var t;null==(t=Q.current)||t.call(Q,e)},onRetriesExceeded:function(e){var t;null==(t=K.current)||t.call(K,e)}});return G(e),function(){G(null),Promise.resolve().then(function(){return e.close()})}},[Z,Y,K,Q]),et=X,en=(0,b._)((0,w.useState)(function(){d&&tS.error("mockStore in only meant for tests or development, not production");var e=null!=d?d:(0,x.y$)();return(!0===c||p)&&e.set(tI.Zl,!0),e}),1)[0],er=o.id,ei=o.timeCreated,(0,w.useEffect)(function(){en.set(tg,{hasAccessToAdvancedModel:a,defaultAssistantChatMode:a?"advanced":"basic",defaultAssistantInlineMode:a?"advanced":"basic"})},[en,a,h]),es=(eo={connection:V,chortConnection:et,replId:n,user:(0,w.useMemo)(function(){return{id:er.toString(),type:_.utd.USER,isTeam:!1,roles:[],membership:a?_.VMq.CORE:_.VMq.FREE,orgId:"",username:"",timeCreated:new Date(ei),flaggingContext:""}},[er,a,ei]),hasAdvancedModel:a,overrideModel:h||null,onError:function(e,t){setTimeout(function(){l(e,null!=t?t:void 0)})}}).connection,eu=eo.chortConnection,el=eo.replId,ed=eo.user,ep=eo.hasAdvancedModel,eg=void 0===(ev=eo.overrideModel)?null:ev,em=eo.onError,eb=(ey=(0,b._)((0,w.useState)(null),2))[0],eE=ey[1],ew=(0,B.A)(em),eI=!!em,(0,w.useEffect)(function(){if(es&&eu){var e=new th({connection:es,chortConnection:eu,replId:el,user:ed,hasAdvancedModel:ep,overrideModel:eg,logger:$.vF,onError:eI?function(e,t){var n;return null==(n=ew.current)?void 0:n.call(ew,e,t)}:void 0});return eE(e),function(){eE(null),Promise.resolve().then(function(){return e.dispose()})}}},[es,eu,el,eI]),(0,w.useEffect)(function(){eb&&(eb.user.current!==ed&&eb.user.set(ed),eb.hasAdvancedModel.current!==ep&&eb.hasAdvancedModel.set(ep),eb.overrideModel.current!==eg&&eb.overrideModel.set(null!=eg?eg:null))},[eb,ed,ep,eg]),ex=eb,{store:en,yapper:null!=f?f:ex}),eO=eP.store,eR=eP.yapper;return eR?(0,E.Y)(eh.tv,{store:eO,yapper:eR,children:ek}):(0,E.Y)(void 0===eN?function(){return null}:eN,{})}function tT(){var e=(0,eh.h)(tE),t=(0,eh.ob)(tE),n=(0,eh.Ou)(tE),r=(0,w.useCallback)(function(){return"basic"===n()?_.qRv.NONE:_.qRv.ITERATIVE_AGENT},[n]),i=(0,w.useCallback)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n();return e.isAuthorized?"advanced"===t?_.e3q.ADVANCED:_.e3q.BASIC:_.e3q.MODEL_TYPE_UNKNOWN},[n]);return{assistantMode:e,setAssistantMode:t,getAssistantMode:n,getAssistantMessageIntent:r,getAssistantMessageModel:i}}function tU(){return{assistantInlineMode:(0,eh.h)(tw)}}var tM=n(33747),tN=n(86199);function tP(){var e=tT().assistantMode,t=tO(),n=t.basicModel,r=t.advancedModel,i=t.overrideModel;return null!=i?i:"advanced"===e?r:n}function tO(){var e=(0,eh.dI)(),t=(0,tv.J2)(e.models),n=tR();return(0,w.useMemo)(function(){var e,r,i=(0,b._)(null!=(e=null==t?void 0:t.basic)?e:[],1)[0],o=null!=(r=null==t?void 0:t.advanced)?r:[],s=null==t?void 0:t.override,a=o.find(function(e){return e.name.readable===(null==n?void 0:n.readable)}),u=(0,b._)(o.filter(function(e){return e.name.readable!==(null==n?void 0:n.readable)}),1)[0],l=(0,tN.FC)(null==u?void 0:u.name)?u:tM.Bx.advanced,c=(0,tN.FC)(null==s?void 0:s.name)?s:void 0;return{basicModel:(0,tN.FC)(null==i?void 0:i.name)?i:tM.Bx.basic,advancedModel:(0,tN.FC)(null==a?void 0:a.name)?a:l,overrideModel:c}},[t,n])}function tR(){var e=(0,t_._P)({controlName:"flag-assistant-advanced-model",type:"string",default:tM.xI.name.qualified});return(0,w.useMemo)(function(){return(0,tN.P6)(e)},[e])}function tD(){var e=(0,eh.dI)(),t=(0,tv.J2)(e.models);return(0,w.useMemo)(function(){var e,n,r=(0,b._)(null!=(e=null==t?void 0:t.basic)?e:[],1)[0],i=(null!=(n=null==t?void 0:t.advanced)?n:[]).filter(function(e){return e.name.qualified!==tM.xI.name.qualified})[0];return{basicModel:(0,tN.FC)(null==r?void 0:r.name)?r:tM.FT.basic,advancedModel:(0,tN.FC)(null==i?void 0:i.name)?i:tM.FT.advanced,overrideModel:void 0}},[t])}var tq=n(43743),tL=(0,x.eU)(!1);function tV(){return(0,eh.h)(tL)}function tF(){var e=(0,eh.ob)(tL);return(0,w.useCallback)(function(t){return e(t)},[e])}var tZ=n(50455);function tY(e,t){var n,r,i=(n=ea(),r=window.location.host.startsWith("staging")||n===et.B.development||n===et.B.staging,t===_.dF3.AGENT_SESSION?r?"2a95b8aa-201c-481e-8ee3-858a19efdc53":"430ef9d3-abfe-4318-8a6d-4cadfe35d0ce":r?"c50da37d-4044-4795-b28e-8e1d21473f96":"cf9ea4d0-b92a-4076-b8f9-44441d907f6a"),o="".concat("https://smith.langchain.com","/o/").concat("ed54f928-4630-409b-b66a-947e0fbac288","/projects/p/").concat(i),s=encodeURIComponent('{"duration":"7d"}'),a=(0,tZ.stringify)({timeModel:s,searchModel:'{"filter":"and(eq(is_root, true), and(eq(metadata_key, \\"session_id\\"), eq(metadata_value, \\"'.concat(e,'\\")))"}')});return"".concat(o,"?").concat(a)}function tH(e){var t,n=ea(),r="https://cloud.temporal.io";switch(n){case et.B.development:r="http://localhost:8233",t="default";break;case et.B.staging:t="staging.ndbzr";break;case et.B.production:default:t="production.ndbzr"}var i="".concat(r,"/namespaces/").concat(t,"/workflows"),o=(0,tZ.stringify)({query:'session_id = "'.concat(e,'"')});return"".concat(i,"?").concat(o)}function tj(e,t){var n=ea(),r="prod";switch(n){case et.B.development:case et.B.staging:r="staging"}var i=(0,tZ.stringify)({replid:e,sessionid:t,project:r});return"".concat("https://traceforge.replit.app","?").concat(i)}function tz(e){switch(ea()){case et.B.development:t="a34e4310-8985-413b-9bb8-0818195db7a0";break;case et.B.staging:t="32f6ce1e-278b-4781-8251-14f6b813c86c";break;case et.B.production:default:t="production"}var t,n=encodeURIComponent(btoa(JSON.stringify([{field:"metadata.session_id",operator:"=",value:e}])));return"".concat("https://traceforgev2.replit.app","/projects/").concat(t,"?filters=").concat(n)}function tX(e){switch(ea()){case et.B.development:t="development";break;case et.B.staging:t="staging";break;case et.B.production:default:t="production"}var t,n="agent-".concat(t),r=JSON.stringify({filter:[{text:'metadata.session_id MATCH "'.concat(e,'"'),label:"metadata.session_id matches ".concat(e),originType:"form"}]}),i=(0,tZ.stringify)({search:r});return"".concat("https://www.braintrust.dev/app/gcp-dataplane","/p/").concat(n,"/logs?").concat(i)}function tW(e){return"https://us5.datadoghq.com/logs?query=%40replid%3A".concat(e)}},89961:(e,t,n)=>{n.d(t,{Zn:()=>x,hV:()=>_});var r=n(29935),i=n(37743),o=n(41292),s=n(88967),a=n(58075),u=n(48122),l=n(17844),c=n(93629),d=n(82643),f=n(48686),h=n(32978),p=n(6751),v=n(36641),g=n(37591),m=n(85001);function y(e){throw Error("Unhandled discriminated union member: ".concat(JSON.stringify(e)))}var b={codec:v.M,heartbeatIntervalMs:2500,heartbeatsUntilDead:40,enableTransparentSessionReconnects:!1,connectionTimeoutMs:1e4,handshakeTimeoutMs:15e3,sessionDisconnectGraceMs:15e3},E=(0,c._)((0,l._)({},b),{baseIntervalMs:250,maxJitterMs:500,maxBackoffMs:32e3,attemptBudgetCapacity:5,budgetRestoreIntervalMs:2e3}),w=new WeakMap,I=new WeakMap,x=function(){"use strict";function e(t){var n=this,u=t.clientId,f=t.serverId,v=t.connectImmediately,b=t.logger,x=t.getEndpoint,_=t.overrideWebsocket,S=t.onProtocolError,C=t.onRetriesExceeded;(0,i._)(this,e),(0,s._)(this,w,{writable:!0,value:void 0}),(0,s._)(this,I,{writable:!0,value:void 0}),this.dispose=null,this.clientId=u,this.serverId=f,this.log=null!=b?b:null;var k={};this.transport=new m.I(function(){return(0,r._)(function(){var e,t,n,r,i,o;return(0,d.YH)(this,function(s){switch(s.label){case 0:if(n=Date.now(),!_)return[3,2];return[4,x()];case 1:return i=_.apply(void 0,[s.sent().toString()]),[3,4];case 2:return o=WebSocket.bind,[4,x()];case 3:i=new(o.apply(WebSocket,[void 0,s.sent().toString()])),s.label=4;case 4:return r=i,null==(e=(t=this).log)||e.call(t,"ai-chat: ws open",{extras:{duration:Date.now()-n}}),[2,r]}})}).call(n)},this.clientId,E),b&&this.transport.bindLogger(b,"info"),this.session=new h.N(null),(0,a._)(this,w,new h.N("disconnected")),(0,a._)(this,I,(0,p.UU)(this.transport,f,{eagerlyConnect:!1,connectOnInvoke:!1})),this.transport.addEventListener("sessionTransition",function(e){var t,r,i,s,a;"BackingOff"===e.state||("Connecting"===e.state?(k.connectionStart=Date.now(),null==(t=n.log)||t.call(n,"ai-chat: connecting",{clientId:n.clientId})):"Handshaking"===e.state?(k.handshakeStart=Date.now(),null==(r=n.log)||r.call(n,"ai-chat: handshaking",{clientId:n.clientId})):"Connected"===e.state?(k.connectionStart&&k.handshakeStart&&(null==(i=n.log)||i.call(n,"ai-chat: connected",{clientId:n.clientId,extras:(0,c._)((0,l._)({},k),{connectionDuration:k.handshakeStart-k.connectionStart,handshakeDuration:Date.now()-k.handshakeStart,totalDuration:Date.now()-k.connectionStart})})),k.connectionStart=void 0,k.handshakeStart=void 0):"NoConnection"===e.state?(null==(s=n.log)||s.call(n,"ai-chat: no connection",{clientId:n.clientId}),k.connectionStart=void 0,k.handshakeStart=void 0):y(e)),n.is("closed","error")||("Connected"===e.state?(n.session.set(null!=(a=n.transport.sessions.values().next().value)?a:null),(0,o._)(n,w).set("connected")):(n.session.set(null),n.transport.reconnectOnConnectionDrop?(0,o._)(n,w).set("connecting"):(0,o._)(n,w).set("disconnected")))}),this.transport.addEventListener("sessionStatus",function(e){var t,r;"connect"===e.status?(k.sessionStart=Date.now(),null==(t=n.log)||t.call(n,"ai-chat: session started",{sessionId:e.session.id,clientId:n.clientId})):"disconnect"===e.status?k.sessionStart&&(null==(r=n.log)||r.call(n,"ai-chat: session ended",{sessionId:e.session.id,clientId:n.clientId,extras:{sessionDuration:Date.now()-k.sessionStart}})):y(e.status),n.is("closed","error")||"disconnect"===e.status&&(n.session.set(null),n.transport.reconnectOnConnectionDrop?n.status.set("connecting"):n.status.set("disconnected"))}),this.transport.addEventListener("protocolError",function(e){var t,r;e.type===g.bd.HandshakeFailed&&(null==(t=n.log)||t.call(n,"river handshake failed",{clientId:u},"error")),e.type===g.bd.RetriesExceeded?(null==(r=n.log)||r.call(n,"ai-chat: retry budget exhausted",{clientId:u},"error"),n.close(),null==C||C(e)):(n.error(),null==S||S(e))});var A=function(){return!n.is("closed","error")&&"visible"===document.visibilityState&&window.navigator.onLine},T=function(){var e=n.transport.reconnectOnConnectionDrop,t=A();n.transport.reconnectOnConnectionDrop=t,e&&!t&&!n.session.current&&n.is("connecting")&&(0,o._)(n,w).set("disconnected"),t&&n.is("disconnected")&&n.connect()};this.transport.reconnectOnConnectionDrop=A(),document.addEventListener("visibilitychange",T),window.addEventListener("online",T),window.addEventListener("offline",T),this.dispose=function(){document.removeEventListener("visibilitychange",T),window.removeEventListener("online",T),window.removeEventListener("offline",T)},A()&&!1!==v&&this.connect(),!0===v&&this.connect()}var t=e.prototype;return t.is=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes((0,o._)(this,w).current)},t.connect=function(){if(this.is("closed","error"))throw Error("Cannot connect to a ".concat((0,o._)(this,w).current," ChatConnection"));this.is("connected","connecting")||((0,o._)(this,w).set("connecting"),this.transport.connect(this.serverId))},t.error=function(){if(!this.is("closed","error")){var e;(0,o._)(this,w).set("error"),this.transport.close(),null==(e=this.dispose)||e.call(this),this.dispose=null}},t.close=function(){if(!this.is("closed","error")){var e;(0,o._)(this,w).set("closed"),this.transport.close(),null==(e=this.dispose)||e.call(this),this.dispose=null}},(0,u._)(e,[{key:"status",get:function(){return(0,o._)(this,w)}},{key:"service",get:function(){return(0,o._)(this,I).chatService}}]),e}();function _(e){var t=e.currentUserId;return"chat-client-".concat(t,"-").concat((0,f.Ak)())}},92896:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(17844),i=n(93629),o=n(34837),s=n(72272);function a(e){return(0,o.Y)(s.A,(0,i._)((0,r._)({},e),{children:(0,o.Y)("path",{fill:"#967D00",d:"M4.271 2A2.271 2.271 0 0 0 2 4.271V19.73A2.271 2.271 0 0 0 4.271 22H19.73A2.272 2.272 0 0 0 22 19.729V4.27A2.271 2.271 0 0 0 19.729 2H4.27Zm8.167 17.109c-.294.599-.857.992-1.51 1.182-1.001.23-1.96.1-2.672-.329-.478-.293-.85-.743-1.103-1.262.508-.31 1.014-.622 1.521-.932.014.006.053.078.107.171.194.326.361.556.69.717.324.11 1.032.18 1.306-.388.168-.289.114-1.237.114-2.266 0-1.616.008-3.205.008-4.841h1.87c0 1.718.01 3.44 0 5.155.004 1.052.096 2.008-.33 2.793Zm7.761-.529c-.65 2.225-4.276 2.297-5.724.827-.306-.345-.498-.526-.68-.926.77-.443.77-.443 1.518-.876.408.626.784.97 1.46 1.11.92.112 1.843-.203 1.636-1.178-.213-.797-1.88-.99-3.015-1.843-1.152-.774-1.422-2.654-.475-3.728.315-.397.853-.694 1.418-.836.195-.025.393-.052.589-.076 1.131-.024 1.838.275 2.357.855.145.147.262.304.483.647-.602.384-.6.38-1.464.94a1.392 1.392 0 0 0-.813-.755c-.502-.152-1.135.013-1.266.543-.046.164-.036.316.036.586.204.464.886.665 1.498.946 1.763.715 2.358 1.481 2.504 2.394.14.785-.034 1.294-.06 1.37h-.002Z"})}))}},95513:(e,t,n)=>{n.d(t,{$:()=>c,s:()=>function e(t,n){var s=function(e){var o,s,c,d,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{logLevel:"debug"},h=null!=(o=(s={},(0,r._)(s,"debug",u.vF.debug),(0,r._)(s,"warn",u.vF.warn),(0,r._)(s,"info",u.vF.info),(0,r._)(s,"error",u.vF.error),s)[f.logLevel])?o:u.vF.debug;(null!=(c=(d={},(0,r._)(d,"debug",l.debug),(0,r._)(d,"warn",l.warn),(0,r._)(d,"info",l.info),(0,r._)(d,"error",l.error),d)[f.logLevel])?c:l.debug)(e,f),h(e,a()((0,i._)({},f,t),["replId","logLevel"])),n.onLog((0,i._)({message:e},f,t))};return{context:t,info:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s(e,(0,o._)((0,i._)({},t),{logLevel:"info"}))},warn:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s(e,(0,o._)((0,i._)({},t),{logLevel:"warn"}))},error:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s(e,(0,o._)((0,i._)({},t),{logLevel:"error"}))},createLogger:function(r){return e((0,i._)({},t,r),n)}}}});var r=n(83846),i=n(17844),o=n(93629),s=n(25547),a=n.n(s),u=n(69071),l=n(95570),c=function(e){return e.debug="debug",e.info="info",e.warn="warn",e.error="error",e}({})},97598:(e,t,n)=>{n.d(t,{k:()=>M});var r=n(47888),i=n(35992),o=n(86035),s=n(17844),a=n(6132),u=n(22531),l=n(67201);function c(e){return(void 0===e?"undefined":(0,u._)(e))==="object"?e:"string"==typeof e?{type:o.e3q.OVERRIDE,overrideModelName:e}:{type:e,overrideModelName:""}}var d=(0,i.CN)(r.X(o.g$I),!0);function f(e){var t=e.session,n=e.parent,r=e.sender,i=e.contents,s=e.context,a=e.benchmark,u=(0,l.A)(),c=new Date,f="localShellExecutionEventContents"===i.$kind?o.qOk.IN_PROGRESS:o.qOk.COMPLETE,h={type:o.fqQ.EVENT_ERROR_TYPE_UNKNOWN,message:""},p=Object.assign({},d);return p.id=u,p.parentEventId=n,p.sessionId=t,p.created=c,p.updated=c,p.state=f,p.error=h,p.sender=r,p.contents={benchmarkParameters:null!=a?a:{datasetId:"",instanceId:"",runId:"",replDescription:"",disableSandbox:!1,commandPrefix:[],overrideShellExecuteTimeoutSeconds:0,overrideMaxSteps:0},contents:i},p.context={metadata:s||void 0},p}var h={contents:(0,i.CN)(r.X(o.XfY),!0)},p={contents:(0,i.CN)(r.X(o.NQI),!0)},v={contents:(0,i.CN)(r.X(o.mB3),!0),context:(0,i.CN)(r.X(o.pcR),!0)},g={contents:(0,i.CN)(r.X(o.Q4p),!0),context:(0,i.CN)(r.X(o.G2f),!0)},m={contents:(0,i.CN)(r.X(o.ico),!0),context:(0,i.CN)(r.X(o.RRw),!0)},y={contents:(0,i.CN)(r.X(o.LUb),!0),context:(0,i.CN)(r.X(o.MgG),!0),reference:(0,i.CN)(r.X(o.wKO),!0)},b=n(93629),E=n(17459),w={applied:(0,i.CN)(r.X(o.UuK),!0),reverted:(0,i.CN)(r.X(o.cAv),!0),contents:(0,i.CN)(r.X(o.ezK),!0),context:(0,i.CN)(r.X(o.$ZM),!0)},I={contents:(0,i.CN)(r.X(o.h4R),!0),context:(0,i.CN)(r.X(o.uuO),!0)},x={contents:(0,i.CN)(r.X(o.ZCJ),!0),context:(0,i.CN)(r.X(o.cv9),!0),reference:(0,i.CN)(r.X(o.wKO),!0),proposedFileChanges:(0,i.CN)((0,a.hT)("proposedFileChanges",{changes:[],commitId:"",summary:""}),!0)},_={contents:(0,i.CN)(r.X(o.EBZ),!0),context:(0,i.CN)(r.X(o.hRt),!0)},S={contents:(0,i.CN)(r.X(o.ADy),!0)},C={contents:(0,i.CN)(r.X(o.Krs),!0),context:(0,i.CN)(r.X(o.z1c),!0)},k={contents:(0,i.CN)(r.X(o.MqL),!0)},A={contents:(0,i.CN)(r.X(o.kAe),!0),context:(0,i.CN)(r.X(o.FEc),!0)},T={contents:(0,i.CN)(r.X(o.KPX),!0)},U=(0,i.CN)(r.X(o.X0t),!0);function M(e){var t=function(e){var t,n,r,i,u,l,d,U,M,N,P,O,R,D,q,L,V,F,Z,Y,H,j,z,X,W,B,$,G,K,J,Q,ee,et,en,er,ei,eo,es,ea,eu,el,ec,ed,ef,eh,ep,ev,eg,em,ey,eb,eE,ew,eI,ex,e_,eS,eC,ek,eA,eT,eU,eM,eN,eP,eO,eR,eD,eq=e.session,eL=e.parent,eV=e.sender,eF=e.model,eZ=e.data,eY=e.benchmark;"type"in eV||(eV={id:eV.id.toString(),type:o.utd.USER,isTeam:!1,roles:[],membership:eV.membership,orgId:"",username:"",timeCreated:eV.timeCreated,flaggingContext:""});var eH=(0,s._)({session:eq,parent:eL,sender:eV,model:eF,benchmark:eY},eZ);switch(eH.kind){case"agentPlan":return(t=Object.assign({},v.contents)).planId=eH.planId,t.objective=eH.objective,t.step=eH.step,t.stackBlueprint=eH.stackBlueprint,t.requiresApproval=eH.requiresApproval,t.Approver=eH.approved?(0,a.hT)("approver",eH.sender):void 0,eH.approvedDesignReferenceFilePath&&(t.approvedDesignReferenceFilePath=eH.approvedDesignReferenceFilePath),eH.agentStackTriggerType&&(t.agentStackTriggerType=eH.agentStackTriggerType),f({session:eH.session,parent:eH.parent,sender:eH.sender,contents:(0,a.hT)("agentPlanEventContents",t),context:(0,a.hT)("agentPlanEventContext",v.context)});case"approvePlan":return(n=Object.assign({},g.contents)).planEventId=eH.planEventId,n.approver=eH.approver,n.initialBuildMode=eH.initialBuildMode,n.userSecretsResponse=eH.userSecretsResponse,f({session:eH.session,parent:eH.parent,sender:eH.sender,contents:(0,a.hT)("approvePlanEventContents",n),context:(0,a.hT)("userSecretsResponseEventContext",g.context)});case"byoPrompt":return r=Object.assign({},m.contents),i=Object.assign({},m.context),u=c(eH.model),r.messages=eH.messages,r.parameters=eH.parameters,r.forceJson=!1,i.modelSelector=u,f({session:eH.session,parent:eH.parent,sender:eH.sender,contents:(0,a.hT)("byoPromptEventContents",r),context:(0,a.hT)("byoPromptEventContext",i)});case"inlineAction":return N=Object.assign({},y.contents),P=Object.assign({},y.context),O=c(eH.model),N.content=eH.message,N.messageType=eH.messageType,N.codeReference=null!=(l=eH.codeReference)?l:y.reference,N.usedModelSelector=O,P.mostRecentFile=null!=(d=eH.mostRecentFile)?d:"",P.fileContext=null!=(U=eH.fileContext)?U:[],P.modelSelector=O,P.useRag=null!=(M=eH.useRag)&&M,f({session:eH.session,parent:eH.parent,sender:eH.sender,contents:(0,a.hT)("inlineActionEventContents",N),context:(0,a.hT)("inlineActionEventContext",P)});case"iterativeAgent":return function(e){var t=Object.assign({},w.contents);if("appliedChanges"in e.action){var n=Object.assign({},w.applied);n.eventWhichProposedChanges=e.action.eventIdWhichProposedChanges,n.appliedChanges=e.action.appliedChanges,n.commitHash=e.action.commitHash,t.contents=(0,a.hT)("appliedFileChanges",n)}else if("revertedChanges"in e.action){var r=Object.assign({},w.reverted);r.eventWhichProposedChanges=e.action.eventIdWhichProposedChanges,r.eventWhichAppliedChanges=e.action.eventIdWhichAppliedChanges,r.revertedChanges=e.action.revertedChanges,t.contents=(0,a.hT)("revertedFileChanges",r)}else if("eventIdWhichProposedPackageInstall"in e.action)if("installationOutput"in e.action){var i=e.action,o=i.eventIdWhichProposedPackageInstall,u=(0,E._)(i,["eventIdWhichProposedPackageInstall"]);t.contents=(0,a.hT)("installedPackages",(0,b._)((0,s._)({},u),{eventWhichProposedPackageInstall:o}))}else{var l=e.action,c=l.eventIdWhichProposedPackageInstall,d=(0,E._)(l,["eventIdWhichProposedPackageInstall"]);t.contents=(0,a.hT)("installingPackages",(0,b._)((0,s._)({},d),{eventWhichProposedPackageInstall:c}))}else if("eventIdWhichProposedShellExecution"in e.action)if("commandOutput"in e.action){var h=e.action,p=h.eventIdWhichProposedShellExecution,v=(0,E._)(h,["eventIdWhichProposedShellExecution"]);t.contents=(0,a.hT)("finishedShellExecution",(0,b._)((0,s._)({},v),{eventWhichProposedShellExecution:p}))}else{var g=e.action,m=g.eventIdWhichProposedShellExecution,y=(0,E._)(g,["eventIdWhichProposedShellExecution"]);t.contents=(0,a.hT)("startedShellExecution",(0,b._)((0,s._)({},y),{eventWhichProposedShellExecution:m}))}else if("eventIdWhichProposedRunConfiguration"in e.action){var I=e.action,x=I.eventIdWhichProposedRunConfiguration,_=(0,E._)(I,["eventIdWhichProposedRunConfiguration"]);t.contents=(0,a.hT)("appliedRunConfiguration",(0,b._)((0,s._)({},_),{eventWhichProposedRunConfiguration:x}))}else if("eventIdWhichProposedDeploymentConfiguration"in e.action){var S=e.action,C=S.eventIdWhichProposedDeploymentConfiguration,k=(0,E._)(S,["eventIdWhichProposedDeploymentConfiguration"]);t.contents=(0,a.hT)("appliedDeploymentConfiguration",(0,b._)((0,s._)({},k),{eventWhichProposedDeploymentConfiguration:C}))}else if("eventIdWhichProposedWorkflowConfiguration"in e.action){var A=e.action,T=A.eventIdWhichProposedWorkflowConfiguration,U=(0,E._)(A,["eventIdWhichProposedWorkflowConfiguration"]);t.contents=(0,a.hT)("appliedWorkflowConfiguration",(0,b._)((0,s._)({},U),{eventWhichProposedWorkflowConfiguration:T}))}return f({session:e.session,parent:e.parent,sender:e.sender,contents:(0,a.hT)("iterativeAgentEventContents",t),context:(0,a.hT)("iterativeAgentEventContext",w.context)})}(eH);case"localShellExecution":return(R=Object.assign({},I.contents)).command=eH.command,R.channelName=eH.channelName,R.eventId=eH.event,R.index=0,R.result="",R.exitCode=0,R.executed=!1,f({session:eH.session,parent:eH.parent,sender:eH.sender,contents:(0,a.hT)("localShellExecutionEventContents",R),context:(0,a.hT)("localShellExecutionEventContext",I.context)});case"message":return eI=Object.assign({},x.contents),ex=Object.assign({},x.context),e_=c(eH.model),eI.content=eH.message,eI.intent=eH.intent,eI.media=null!=(z=eH.media)?z:[],eI.codeReference=null!=(X=eH.codeReference)?X:x.reference,eI.usedModelSelector=e_,eI.sources=null!=(W=eH.sources)?W:[],eI.extraActions=null!=(B=eH.extraActions)?B:x.proposedFileChanges,eI.agentAction=null!=($=eH.agentAction)?$:{},eI.uploadedFiles=null!=(G=eH.uploadedFiles)?G:[],eI.attachedUrls=null!=(K=eH.attachedUrls)?K:[],eH.requestedStackBlueprint&&(eI.requestedStackBlueprint=eH.requestedStackBlueprint),eH.agentStackTriggerType&&(eI.agentStackTriggerType=eH.agentStackTriggerType),eI.customStackReplId=null!=(J=eH.customStackReplId)?J:"",eI.themeConfig=null!=(Q=eH.themeConfig)?Q:"",eI.attachedForm=null!=(ee=eH.attachedForm)?ee:{formType:o.B73.ATTACHED_FORM_TYPE_UNKNOWN,fields:[]},eI.enableDeepThinking=null!=(et=eH.enableDeepThinking)&&et,ex.intent=eH.intent,ex.mostRecentFile=null!=(en=eH.mostRecentFile)?en:"",ex.fileContext=null!=(er=eH.fileContext)?er:[],ex.modelSelector=e_,ex.useRag=null!=(ei=eH.useRag)&&ei,ex.extraResources=null!=(eo=eH.extraResources)?eo:[],ex.agentConfig={maxSteps:0,modelProfile:null!=(es=null==(D=eH.agentConfig)?void 0:D.modelProfile)?es:o.Fje.MODEL_PROFILE_STANDARD,thinkingEnabled:null==(q=eH.agentConfig)?void 0:q.thinkingEnabled,enableAutomatedTesting:null==(L=eH.agentConfig)?void 0:L.enableAutomatedTesting,samplingRate:null!=(ea=null==(V=eH.agentConfig)?void 0:V.samplingRate)?ea:0,webSearchEnabled:null!=(eu=null==(F=eH.agentConfig)?void 0:F.webSearchEnabled)&&eu,imageGenerationEnabled:null!=(el=null==(Z=eH.agentConfig)?void 0:Z.imageGenerationEnabled)&&el,agentMode:null!=(ec=null==(Y=eH.agentConfig)?void 0:Y.chatMode)?ec:o.xyI.AGENT_MODE_UNSPECIFIED,initialBuildMode:null!=(ed=null==(H=eH.agentConfig)?void 0:H.initialBuildMode)?ed:o.jV8.AGENT_INITIAL_BUILD_MODE_UNSPECIFIED,maxAutonomyEnabled:null!=(ef=null==(j=eH.agentConfig)?void 0:j.maxAutonomyEnabled)&&ef},eH.webviewTargetedElement&&(eI.targetedElement=eH.webviewTargetedElement),void 0!==eH.quickEdit&&(eI.quickEdit=eH.quickEdit),eH.agentConfig&&(eI.agentConfig={maxSteps:0,modelProfile:null!=(ev=eH.agentConfig.modelProfile)?ev:o.Fje.MODEL_PROFILE_STANDARD,thinkingEnabled:eH.agentConfig.thinkingEnabled,enableAutomatedTesting:eH.agentConfig.enableAutomatedTesting,samplingRate:null!=(eg=eH.agentConfig.samplingRate)?eg:0,webSearchEnabled:null!=(em=null==(eh=eH.agentConfig)?void 0:eh.webSearchEnabled)&&em,imageGenerationEnabled:null!=(ey=null==(ep=eH.agentConfig)?void 0:ep.imageGenerationEnabled)&&ey,agentMode:null!=(eb=eH.agentConfig.chatMode)?eb:o.xyI.AGENT_MODE_UNSPECIFIED,initialBuildMode:null!=(eE=eH.agentConfig.initialBuildMode)?eE:o.jV8.AGENT_INITIAL_BUILD_MODE_UNSPECIFIED,maxAutonomyEnabled:null!=(ew=eH.agentConfig.maxAutonomyEnabled)&&ew}),f({session:eH.session,parent:eH.parent,sender:eH.sender,contents:(0,a.hT)("messageEventContents",eI),context:(0,a.hT)("messageEventContext",ex)});case"revert":return(eS=Object.assign({},_.contents)).eventIdBeforeRevert=eH.eventIdBeforeRevert,eS.commitId=eH.commitHash,eS.message=eH.commitMessage,f({session:eH.session,parent:eH.parent,sender:eH.sender,contents:(0,a.hT)("revertEventContents",eS),context:(0,a.hT)("revertEventContext",_.context)});case"shellSuggestion":return eC=Object.assign({},C.contents),ek=Object.assign({},C.context),eA=c(eH.model),eC.content=eH.message,ek.modelSelector=eA,f({session:eH.session,parent:eH.parent,sender:eH.sender,contents:(0,a.hT)("shellSuggestionEventContents",eC),context:(0,a.hT)("shellSuggestionEventContext",ek)});case"translate":return(eT=Object.assign({},A.contents)).content=eH.content,eT.inputTarget=eH.inputTarget,eT.outputTarget=eH.outputTarget,f({session:eH.session,parent:eH.parent,sender:eH.sender,contents:(0,a.hT)("translateEventContents",eT),context:(0,a.hT)("translateEventContext",A.context)});case"stepTooComplex":return(eU=Object.assign({},k.contents)).state=eH.state,eU.stepId=eH.stepId,f({session:eH.session,parent:eH.parent,sender:eH.sender,contents:(0,a.hT)("stepTooComplexEventContents",eU),context:null});case"agentAskUserForActionResponse":return(eM=Object.assign({},p.contents)).response=eH.response,eM.requestEventId=eH.requestEventId,f({session:eH.session,parent:eH.parent,sender:eH.sender,contents:(0,a.hT)("agentAskUserForActionResponse",eM),context:null});case"agentAskUserForActionRequest":return(eN=Object.assign({},h.contents)).request=eH.request,f({session:eH.session,parent:eH.parent,sender:eH.sender,contents:(0,a.hT)("agentAskUserForActionRequest",eN),context:null});case"requestFeatureAdd":return f({session:eH.session,parent:eH.parent,sender:eH.sender,contents:{$kind:"requestFeatureAddData",requestFeatureAddData:{type:eH.feature}},context:null});case"triggerCheckpoint":return(eR=Object.assign({},T.contents)).description=eH.description,eR.onlyIfDiff=null!=(eP=eH.onlyIfDiff)&&eP,eR.author=null!=(eO=eH.author)?eO:o.rEN.COMMIT_AUTHOR_AGENT,f({session:eH.session,parent:eH.parent,sender:eH.sender,contents:(0,a.hT)("triggerCheckpointEventContents",eR),context:null});case"setupImportedProject":return(eD=Object.assign({},S.contents)).importSource=eH.importSource,f({session:eH.session,parent:eH.parent,sender:eH.sender,contents:(0,a.hT)("setupImportedProjectEventContents",eD),context:null})}}(e),n=Object.assign({},U);return n.addToChild=e.addToChild,n.state=t.state,n.sessionId=t.sessionId,n.parentEventId=t.parentEventId,n.eventId=t.id,n.context=t.context,n.contents=t.contents,{event:t,request:n}}},99211:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(17844),i=n(93629),o=n(34837),s=n(72272);function a(e){return(0,o.Y)(s.A,(0,i._)((0,r._)({},e),{children:(0,o.Y)("path",{fill:"#AD5700",d:"M3 2 4.64 20.4l7.35 2.045 7.371-2.047L21 2H3Zm3.404 4.367L6.35 5.76h5.643v2.256h-3.18l.205 2.312h2.974v2.256H6.959l-.554-6.219Zm10.772 4.568-.53 5.942-.034.38-4.623 1.284-4.616-1.283-.316-3.544H9.32l.16 1.8 2.512.678 2.513-.68.261-2.926h-2.767v-2.257h5.23l-.055.606h.003Zm.408-4.568L17.48 7.51l-.045.507H12V5.762h5.638l-.054.605Z"})}))}}}]);
//# sourceMappingURL=5168-4864837a70839db0.js.map